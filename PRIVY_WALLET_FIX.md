# Исправление проблемы с созданием внутреннего кошелька Privy

## Проблема
Не работало автоматическое создание внутреннего (embedded) кошелька Privy при входе пользователя, хотя ранее это работало корректно.

## Найденные проблемы

### 1. Несоответствие App ID
В коде использовались два разных App ID:
- В переменной `appId`: `cme84q0og02aalc0bh9blzwa9`
- В `privyConfig`: `cm25q62mj00nks8j5lxk4qyly`

При этом в `PrivyProvider` передавался первый ID, а не тот, что был в конфигурации.

### 2. Неправильная структура конфигурации
В `PrivyProvider` передавался весь объект `privyConfig`, который содержал поле `config`, вместо передачи только содержимого `config`.

## Внесенные исправления

### 1. Унификация App ID
```javascript
// Теперь используется один App ID с поддержкой переменной окружения
const appId = import.meta.env.VITE_PRIVY_APP_ID || 'cme84q0og02aalc0bh9blzwa9';
```

### 2. Исправление передачи конфигурации
```javascript
<PrivyProvider
  appId={appId}
  config={privyConfig.config}  // Передаем только содержимое config
>
```

### 3. Оптимизация конфигурации embedded wallets
```javascript
embeddedWallets: {
  createOnLogin: 'all-users',           // Автоматическое создание для всех
  requireUserPasswordOnCreate: false,    // Без пароля для удобства
  noPromptOnSignature: true,            // Без промптов при подписи
},
```

### 4. Добавлен компонент отладки
Создан `PrivyDebugger` компонент для мониторинга состояния Privy и ручного создания кошелька при необходимости.

## Переменные окружения

Убедитесь, что в Vercel настроены следующие переменные:

```env
VITE_PRIVY_APP_ID=cme84q0og02aalc0bh9blzwa9
NEXT_PUBLIC_PROJECT_ID=your_walletconnect_project_id
FAUCET_OWNER_PRIVATE_KEY=your_faucet_private_key
```

## Проверка работоспособности

1. При входе пользователя через email/social должен автоматически создаваться embedded wallet
2. В консоли браузера должно появиться сообщение с правильным App ID
3. В компоненте `PrivyDebugger` должен отображаться созданный кошелек типа "privy"

## Дополнительные настройки

Если автоматическое создание не работает, можно использовать кнопку "Create Embedded Wallet Manually" в отладочном компоненте.

## Примечания

- Embedded wallets создаются только для новых пользователей или при первом входе
- Для существующих пользователей с уже созданными кошельками все работает без изменений
- Конфигурация оптимизирована для минимального трения при входе в игру