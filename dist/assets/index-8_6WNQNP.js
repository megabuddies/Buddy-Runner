const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ccip-B_fqKDXk.js","assets/privy-DLQ81g5T.js","assets/vendor-C7A1SLig.js"])))=>i.map(i=>d[i]);
var Js=Object.defineProperty;var Ys=(e,t,n)=>t in e?Js(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ie=(e,t,n)=>Ys(e,typeof t!="symbol"?t+"":t,n);import{_ as Vs,m as nt,o as Ht,j as l,i as dn,a as Xs,b as Zs,X as Qs}from"./privy-DLQ81g5T.js";import{b as ea,r as M,R as ta}from"./vendor-C7A1SLig.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();var Dn={},Rr=ea;Dn.createRoot=Rr.createRoot,Dn.hydrateRoot=Rr.hydrateRoot;function na(e,t){const n=e.exec(t);return n==null?void 0:n.groups}const $r=/^tuple(?<array>(\[(\d*)\])*)$/;function Ln(e){let t=e.type;if($r.test(e.type)&&"components"in e){t="(";const n=e.components.length;for(let s=0;s<n;s++){const a=e.components[s];t+=Ln(a),s<n-1&&(t+=", ")}const r=na($r,e.type);return t+=`)${(r==null?void 0:r.array)??""}`,Ln({...e,type:t})}return"indexed"in e&&e.indexed&&(t=`${t} indexed`),e.name?`${t} ${e.name}`:t}function xt(e){let t="";const n=e.length;for(let r=0;r<n;r++){const s=e[r];t+=Ln(s),r!==n-1&&(t+=", ")}return t}function ra(e){return e.type==="function"?`function ${e.name}(${xt(e.inputs)})${e.stateMutability&&e.stateMutability!=="nonpayable"?` ${e.stateMutability}`:""}${e.outputs.length?` returns (${xt(e.outputs)})`:""}`:e.type==="event"?`event ${e.name}(${xt(e.inputs)})`:e.type==="error"?`error ${e.name}(${xt(e.inputs)})`:e.type==="constructor"?`constructor(${xt(e.inputs)})${e.stateMutability==="payable"?" payable":""}`:e.type==="fallback"?"fallback()":"receive() external payable"}function J(e,t,n){return r=>{var s;return((s=e[t.name||n])==null?void 0:s.call(e,r))??t(e,r)}}function De(e,{includeName:t=!1}={}){if(e.type!=="function"&&e.type!=="event"&&e.type!=="error")throw new xa(e.type);return`${e.name}(${fn(e.inputs,{includeName:t})})`}function fn(e,{includeName:t=!1}={}){return e?e.map(n=>sa(n,{includeName:t})).join(t?", ":","):""}function sa(e,{includeName:t}){return e.type.startsWith("tuple")?`(${fn(e.components,{includeName:t})})${e.type.slice(5)}`:e.type+(t&&e.name?` ${e.name}`:"")}function Oe(e,{strict:t=!0}={}){return!e||typeof e!="string"?!1:t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")}function fe(e){return Oe(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}const aa="1.21.3",oa=e=>e,hn=e=>e,ia=()=>`viem@${aa}`;class I extends Error{constructor(t,n={}){var a;super(),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ViemError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:ia()});const r=n.cause instanceof I?n.cause.details:(a=n.cause)!=null&&a.message?n.cause.message:n.details,s=n.cause instanceof I&&n.cause.docsPath||n.docsPath;this.message=[t||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: https://viem.sh${s}.html${n.docsSlug?`#${n.docsSlug}`:""}`]:[],...r?[`Details: ${r}`]:[],`Version: ${this.version}`].join(`
`),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=t}walk(t){return Jr(this,t)}}function Jr(e,t){return t!=null&&t(e)?e:e&&typeof e=="object"&&"cause"in e?Jr(e.cause,t):t?null:e}class ca extends I{constructor({docsPath:t}){super(["A constructor was not found on the ABI.","Make sure you are using the correct ABI and that the constructor exists on it."].join(`
`),{docsPath:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiConstructorNotFoundError"})}}class Ir extends I{constructor({docsPath:t}){super(["Constructor arguments were provided (`args`), but a constructor parameters (`inputs`) were not found on the ABI.","Make sure you are using the correct ABI, and that the `inputs` attribute on the constructor exists."].join(`
`),{docsPath:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiConstructorParamsNotFoundError"})}}class or extends I{constructor({data:t,params:n,size:r}){super([`Data size of ${r} bytes is too small for given parameters.`].join(`
`),{metaMessages:[`Params: (${fn(n,{includeName:!0})})`,`Data:   ${t} (${r} bytes)`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t,this.params=n,this.size=r}}class mn extends I{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.'),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiDecodingZeroDataError"})}}class la extends I{constructor({expectedLength:t,givenLength:n,type:r}){super([`ABI encoding array length mismatch for type ${r}.`,`Expected length: ${t}`,`Given length: ${n}`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiEncodingArrayLengthMismatchError"})}}class ua extends I{constructor({expectedSize:t,value:n}){super(`Size of bytes "${n}" (bytes${fe(n)}) does not match expected size (bytes${t}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiEncodingBytesSizeMismatchError"})}}class da extends I{constructor({expectedLength:t,givenLength:n}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${t}`,`Given length (values): ${n}`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiEncodingLengthMismatchError"})}}class Yr extends I{constructor(t,{docsPath:n}){super([`Encoded error signature "${t}" not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${t}.`].join(`
`),{docsPath:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiErrorSignatureNotFoundError"}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.signature=t}}class fa extends I{constructor({docsPath:t}){super("Cannot extract event signature from empty topics.",{docsPath:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiEventSignatureEmptyTopicsError"})}}class ha extends I{constructor(t,{docsPath:n}){super([`Encoded event signature "${t}" not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${t}.`].join(`
`),{docsPath:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiEventSignatureNotFoundError"})}}class Or extends I{constructor(t,{docsPath:n}={}){super([`Event ${t?`"${t}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it."].join(`
`),{docsPath:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiEventNotFoundError"})}}class on extends I{constructor(t,{docsPath:n}={}){super([`Function ${t?`"${t}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiFunctionNotFoundError"})}}class ma extends I{constructor(t,{docsPath:n}){super([`Function "${t}" does not contain any \`outputs\` on ABI.`,"Cannot decode function result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiFunctionOutputsNotFoundError"})}}class ga extends I{constructor(t,n){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${t.type}\` in \`${De(t.abiItem)}\`, and`,`\`${n.type}\` in \`${De(n.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiItemAmbiguityError"})}}class pa extends I{constructor({expectedSize:t,givenSize:n}){super(`Expected bytes${t}, got bytes${n}.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BytesSizeMismatchError"})}}class et extends I{constructor({abiItem:t,data:n,params:r,size:s}){super([`Data size of ${s} bytes is too small for non-indexed event parameters.`].join(`
`),{metaMessages:[`Params: (${fn(r,{includeName:!0})})`,`Data:   ${n} (${s} bytes)`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"DecodeLogDataMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=t,this.data=n,this.params=r,this.size=s}}class dt extends I{constructor({abiItem:t,param:n}){super([`Expected a topic for indexed event parameter${n.name?` "${n.name}"`:""} on event "${De(t,{includeName:!0})}".`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"DecodeLogTopicsMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=t}}class ba extends I{constructor(t,{docsPath:n}){super([`Type "${t}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiEncodingType"})}}class ya extends I{constructor(t,{docsPath:n}){super([`Type "${t}" is not a valid decoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiDecodingType"})}}class wa extends I{constructor(t){super([`Value "${t}" is not a valid array.`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidArrayError"})}}class xa extends I{constructor(t){super([`"${t}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidDefinitionTypeError"})}}class va extends I{constructor(t){super(`Filter type "${t}" is not supported.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"FilterTypeNotSupportedError"})}}class Vr extends I{constructor({offset:t,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset "${t}" is out-of-bounds (size: ${r}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SliceOffsetOutOfBoundsError"})}}class Xr extends I{constructor({size:t,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${t}) exceeds padding size (${n}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SizeExceedsPaddingSizeError"})}}function ft(e,{dir:t,size:n=32}={}){return typeof e=="string"?He(e,{dir:t,size:n}):Ta(e,{dir:t,size:n})}function He(e,{dir:t,size:n=32}={}){if(n===null)return e;const r=e.replace("0x","");if(r.length>n*2)throw new Xr({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[t==="right"?"padEnd":"padStart"](n*2,"0")}`}function Ta(e,{dir:t,size:n=32}={}){if(n===null)return e;if(e.length>n)throw new Xr({size:e.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const a=t==="right";r[a?s:n-s-1]=e[a?s:e.length-s-1]}return r}class Ea extends I{constructor({max:t,min:n,signed:r,size:s,value:a}){super(`Number "${a}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${t?`(${n} to ${t})`:`(above ${n})`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"IntegerOutOfRangeError"})}}class Pa extends I{constructor(t){super(`Hex value "${t}" is not a valid boolean. The hex value must be "0x0" (false) or "0x1" (true).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidHexBooleanError"})}}class Na extends I{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${t} bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SizeOverflowError"})}}function it(e,{dir:t="left"}={}){let n=typeof e=="string"?e.replace("0x",""):e,r=0;for(let s=0;s<n.length-1&&n[t==="left"?s:n.length-s-1].toString()==="0";s++)r++;return n=t==="left"?n.slice(r):n.slice(0,n.length-r),typeof e=="string"?(n.length===1&&t==="right"&&(n=`${n}0`),`0x${n.length%2===1?`0${n}`:n}`):n}function Je(e,{size:t}){if(fe(e)>t)throw new Na({givenSize:fe(e),maxSize:t})}function gn(e,t={}){const{signed:n}=t;t.size&&Je(e,{size:t.size});const r=BigInt(e);if(!n)return r;const s=(e.length-2)/2,a=(1n<<BigInt(s)*8n-1n)-1n;return r<=a?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function Ca(e,t={}){let n=e;if(t.size&&(Je(n,{size:t.size}),n=it(n)),it(n)==="0x00")return!1;if(it(n)==="0x01")return!0;throw new Pa(n)}function be(e,t={}){return Number(gn(e,t))}function ja(e,t={}){let n=cr(e);return t.size&&(Je(n,{size:t.size}),n=it(n,{dir:"right"})),new TextDecoder().decode(n)}const Sa=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Ge(e,t={}){return typeof e=="number"||typeof e=="bigint"?X(e,t):typeof e=="string"?ir(e,t):typeof e=="boolean"?Zr(e,t):Pt(e,t)}function Zr(e,t={}){const n=`0x${Number(e)}`;return typeof t.size=="number"?(Je(n,{size:t.size}),ft(n,{size:t.size})):n}function Pt(e,t={}){let n="";for(let s=0;s<e.length;s++)n+=Sa[e[s]];const r=`0x${n}`;return typeof t.size=="number"?(Je(r,{size:t.size}),ft(r,{dir:"right",size:t.size})):r}function X(e,t={}){const{signed:n,size:r}=t,s=BigInt(e);let a;r?n?a=(1n<<BigInt(r)*8n-1n)-1n:a=2n**(BigInt(r)*8n)-1n:typeof e=="number"&&(a=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof a=="bigint"&&n?-a-1n:0;if(a&&s>a||s<o){const u=typeof e=="bigint"?"n":"";throw new Ea({max:a?`${a}${u}`:void 0,min:`${o}${u}`,signed:n,size:r,value:`${e}${u}`})}const c=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?ft(c,{size:r}):c}const Aa=new TextEncoder;function ir(e,t={}){const n=Aa.encode(e);return Pt(n,t)}const Ra=new TextEncoder;function We(e,t={}){return typeof e=="number"||typeof e=="bigint"?Ia(e,t):typeof e=="boolean"?$a(e,t):Oe(e)?cr(e,t):Be(e,t)}function $a(e,t={}){const n=new Uint8Array(1);return n[0]=Number(e),typeof t.size=="number"?(Je(n,{size:t.size}),ft(n,{size:t.size})):n}const Fe={zero:48,nine:57,A:65,F:70,a:97,f:102};function Mr(e){if(e>=Fe.zero&&e<=Fe.nine)return e-Fe.zero;if(e>=Fe.A&&e<=Fe.F)return e-(Fe.A-10);if(e>=Fe.a&&e<=Fe.f)return e-(Fe.a-10)}function cr(e,t={}){let n=e;t.size&&(Je(n,{size:t.size}),n=ft(n,{dir:"right",size:t.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,a=new Uint8Array(s);for(let o=0,c=0;o<s;o++){const u=Mr(r.charCodeAt(c++)),h=Mr(r.charCodeAt(c++));if(u===void 0||h===void 0)throw new I(`Invalid byte sequence ("${r[c-2]}${r[c-1]}" in "${r}").`);a[o]=u*16+h}return a}function Ia(e,t){const n=X(e,t);return cr(n)}function Be(e,t={}){const n=Ra.encode(e);return typeof t.size=="number"?(Je(n,{size:t.size}),ft(n,{dir:"right",size:t.size})):n}function Oa(e){let t=!0,n="",r=0,s="",a=!1;for(let o=0;o<e.length;o++){const c=e[o];if(["(",")",","].includes(c)&&(t=!0),c==="("&&r++,c===")"&&r--,!!t){if(r===0){if(c===" "&&["event","function",""].includes(s))s="";else if(s+=c,c===")"){a=!0;break}continue}if(c===" "){e[o-1]!==","&&n!==","&&n!==",("&&(n="",t=!1);continue}s+=c,n+=c}}if(!a)throw new I("Unable to normalize signature.");return s}const Qr=e=>{const t=typeof e=="string"?e:ra(e);return Oa(t)},Ma=e=>Qr(e);function Fr(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function es(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function kr(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Fa(e,t){es(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const nn=BigInt(2**32-1),Br=BigInt(32);function ka(e,t=!1){return t?{h:Number(e&nn),l:Number(e>>Br&nn)}:{h:Number(e>>Br&nn)|0,l:Number(e&nn)|0}}function Ba(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:a,l:o}=ka(e[s],t);[n[s],r[s]]=[a,o]}return[n,r]}const Da=(e,t,n)=>e<<n|t>>>32-n,La=(e,t,n)=>t<<n|e>>>32-n,Ga=(e,t,n)=>t<<n-32|e>>>64-n,Ua=(e,t,n)=>e<<n-32|t>>>64-n;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const za=e=>e instanceof Uint8Array,Ha=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Wa=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Wa)throw new Error("Non little-endian hardware is not supported");function _a(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function ts(e){if(typeof e=="string"&&(e=_a(e)),!za(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}class qa{clone(){return this._cloneInto()}}function Ka(e){const t=r=>e().update(ts(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}const[ns,rs,ss]=[[],[],[]],Ja=BigInt(0),vt=BigInt(1),Ya=BigInt(2),Va=BigInt(7),Xa=BigInt(256),Za=BigInt(113);for(let e=0,t=vt,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],ns.push(2*(5*r+n)),rs.push((e+1)*(e+2)/2%64);let s=Ja;for(let a=0;a<7;a++)t=(t<<vt^(t>>Va)*Za)%Xa,t&Ya&&(s^=vt<<(vt<<BigInt(a))-vt);ss.push(s)}const[Qa,eo]=Ba(ss,!0),Dr=(e,t,n)=>n>32?Ga(e,t,n):Da(e,t,n),Lr=(e,t,n)=>n>32?Ua(e,t,n):La(e,t,n);function to(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let o=0;o<10;o++)n[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const c=(o+8)%10,u=(o+2)%10,h=n[u],m=n[u+1],y=Dr(h,m,1)^n[c],w=Lr(h,m,1)^n[c+1];for(let N=0;N<50;N+=10)e[o+N]^=y,e[o+N+1]^=w}let s=e[2],a=e[3];for(let o=0;o<24;o++){const c=rs[o],u=Dr(s,a,c),h=Lr(s,a,c),m=ns[o];s=e[m],a=e[m+1],e[m]=u,e[m+1]=h}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)n[c]=e[o+c];for(let c=0;c<10;c++)e[o+c]^=~n[(c+2)%10]&n[(c+4)%10]}e[0]^=Qa[r],e[1]^=eo[r]}n.fill(0)}class lr extends qa{constructor(t,n,r,s=!1,a=24){if(super(),this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=a,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Fr(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Ha(this.state)}keccak(){to(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){kr(this);const{blockLen:n,state:r}=this;t=ts(t);const s=t.length;for(let a=0;a<s;){const o=Math.min(n-this.pos,s-a);for(let c=0;c<o;c++)r[this.pos++]^=t[a++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:s}=this;t[r]^=n,n&128&&r===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){kr(this,!1),es(t),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,a=t.length;s<a;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,a-s);t.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Fr(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Fa(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:s,rounds:a,enableXOF:o}=this;return t||(t=new lr(n,r,s,o,a)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=a,t.suffix=r,t.outputLen=s,t.enableXOF=o,t.destroyed=this.destroyed,t}}const no=(e,t,n)=>Ka(()=>new lr(t,e,n)),ro=no(1,136,256/8);function xe(e,t){const n=t||"hex",r=ro(Oe(e,{strict:!1})?We(e):e);return n==="bytes"?r:Ge(r)}const so=e=>xe(We(e)),ur=e=>so(Ma(e));class Nt extends I{constructor({address:t}){super(`Address "${t}" is invalid.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAddressError"})}}const ao=/^0x[a-fA-F0-9]{40}$/;function _e(e){return ao.test(e)}function Le(e){return typeof e[0]=="string"?dr(e):oo(e)}function oo(e){let t=0;for(const s of e)t+=s.length;const n=new Uint8Array(t);let r=0;for(const s of e)n.set(s,r),r+=s.length;return n}function dr(e){return`0x${e.reduce((t,n)=>t+n.replace("0x",""),"")}`}function ce(e,t,n,{strict:r}={}){return Oe(e,{strict:!1})?co(e,t,n,{strict:r}):io(e,t,n,{strict:r})}function as(e,t){if(typeof t=="number"&&t>0&&t>fe(e)-1)throw new Vr({offset:t,position:"start",size:fe(e)})}function os(e,t,n){if(typeof t=="number"&&typeof n=="number"&&fe(e)!==n-t)throw new Vr({offset:n,position:"end",size:fe(e)})}function io(e,t,n,{strict:r}={}){as(e,t);const s=e.slice(t,n);return r&&os(s,t,n),s}function co(e,t,n,{strict:r}={}){as(e,t);const s=`0x${e.replace("0x","").slice((t??0)*2,(n??e.length)*2)}`;return r&&os(s,t,n),s}function Wt(e,t){if(e.length!==t.length)throw new da({expectedLength:e.length,givenLength:t.length});const n=lo({params:e,values:t}),r=hr(n);return r.length===0?"0x":r}function lo({params:e,values:t}){const n=[];for(let r=0;r<e.length;r++)n.push(fr({param:e[r],value:t[r]}));return n}function fr({param:e,value:t}){const n=pn(e.type);if(n){const[r,s]=n;return fo(t,{length:r,param:{...e,type:s}})}if(e.type==="tuple")return bo(t,{param:e});if(e.type==="address")return uo(t);if(e.type==="bool")return mo(t);if(e.type.startsWith("uint")||e.type.startsWith("int")){const r=e.type.startsWith("int");return go(t,{signed:r})}if(e.type.startsWith("bytes"))return ho(t,{param:e});if(e.type==="string")return po(t);throw new ba(e.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function hr(e){let t=0;for(let a=0;a<e.length;a++){const{dynamic:o,encoded:c}=e[a];o?t+=32:t+=fe(c)}const n=[],r=[];let s=0;for(let a=0;a<e.length;a++){const{dynamic:o,encoded:c}=e[a];o?(n.push(X(t+s,{size:32})),r.push(c),s+=fe(c)):n.push(c)}return Le([...n,...r])}function uo(e){if(!_e(e))throw new Nt({address:e});return{dynamic:!1,encoded:He(e.toLowerCase())}}function fo(e,{length:t,param:n}){const r=t===null;if(!Array.isArray(e))throw new wa(e);if(!r&&e.length!==t)throw new la({expectedLength:t,givenLength:e.length,type:`${n.type}[${t}]`});let s=!1;const a=[];for(let o=0;o<e.length;o++){const c=fr({param:n,value:e[o]});c.dynamic&&(s=!0),a.push(c)}if(r||s){const o=hr(a);if(r){const c=X(a.length,{size:32});return{dynamic:!0,encoded:a.length>0?Le([c,o]):c}}if(s)return{dynamic:!0,encoded:o}}return{dynamic:!1,encoded:Le(a.map(({encoded:o})=>o))}}function ho(e,{param:t}){const[,n]=t.type.split("bytes"),r=fe(e);if(!n){let s=e;return r%32!==0&&(s=He(s,{dir:"right",size:Math.ceil((e.length-2)/2/32)*32})),{dynamic:!0,encoded:Le([He(X(r,{size:32})),s])}}if(r!==parseInt(n))throw new ua({expectedSize:parseInt(n),value:e});return{dynamic:!1,encoded:He(e,{dir:"right"})}}function mo(e){return{dynamic:!1,encoded:He(Zr(e))}}function go(e,{signed:t}){return{dynamic:!1,encoded:X(e,{size:32,signed:t})}}function po(e){const t=ir(e),n=Math.ceil(fe(t)/32),r=[];for(let s=0;s<n;s++)r.push(He(ce(t,s*32,(s+1)*32),{dir:"right"}));return{dynamic:!0,encoded:Le([He(X(fe(t),{size:32})),...r])}}function bo(e,{param:t}){let n=!1;const r=[];for(let s=0;s<t.components.length;s++){const a=t.components[s],o=Array.isArray(e)?s:a.name,c=fr({param:a,value:e[o]});r.push(c),c.dynamic&&(n=!0)}return{dynamic:n,encoded:n?hr(r):Le(r.map(({encoded:s})=>s))}}function pn(e){const t=e.match(/^(.*)\[(\d+)?\]$/);return t?[t[2]?Number(t[2]):null,t[1]]:void 0}const yo=e=>xe(We(e)),mr=e=>ce(yo(Qr(e)),0,4);function _t({abi:e,args:t=[],name:n}){const r=Oe(n,{strict:!1}),s=e.filter(o=>r?o.type==="function"?mr(o)===n:o.type==="event"?ur(o)===n:!1:"name"in o&&o.name===n);if(s.length===0)return;if(s.length===1)return s[0];let a;for(const o of s){if(!("inputs"in o))continue;if(!t||t.length===0){if(!o.inputs||o.inputs.length===0)return o;continue}if(!o.inputs||o.inputs.length===0||o.inputs.length!==t.length)continue;if(t.every((u,h)=>{const m="inputs"in o&&o.inputs[h];return m?Gn(u,m):!1})){if(a&&"inputs"in a&&a.inputs){const u=is(o.inputs,a.inputs,t);if(u)throw new ga({abiItem:o,type:u[0]},{abiItem:a,type:u[1]})}a=o}}return a||s[0]}function Gn(e,t){const n=typeof e,r=t.type;switch(r){case"address":return _e(e);case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return r==="tuple"&&"components"in t?Object.values(t.components).every((s,a)=>Gn(Object.values(e)[a],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(r)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(r)?n==="string"||e instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(r)?Array.isArray(e)&&e.every(s=>Gn(s,{...t,type:r.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function is(e,t,n){for(const r in e){const s=e[r],a=t[r];if(s.type==="tuple"&&a.type==="tuple"&&"components"in s&&"components"in a)return is(s.components,a.components,n[r]);const o=[s.type,a.type];if(o.includes("address")&&o.includes("bytes20")?!0:o.includes("address")&&o.includes("string")||o.includes("address")&&o.includes("bytes")?_e(n[r]):!1)return o}}function qt({abi:e,eventName:t,args:n}){var c;let r=e[0];if(t&&(r=_t({abi:e,args:n,name:t}),!r))throw new Or(t,{docsPath:"/docs/contract/encodeEventTopics"});if(r.type!=="event")throw new Or(void 0,{docsPath:"/docs/contract/encodeEventTopics"});const s=De(r),a=ur(s);let o=[];if(n&&"inputs"in r){const u=(c=r.inputs)==null?void 0:c.filter(m=>"indexed"in m&&m.indexed),h=Array.isArray(n)?n:Object.values(n).length>0?(u==null?void 0:u.map(m=>n[m.name]))??[]:[];h.length>0&&(o=(u==null?void 0:u.map((m,y)=>Array.isArray(h[y])?h[y].map((w,N)=>Gr({param:m,value:h[y][N]})):h[y]?Gr({param:m,value:h[y]}):null))??[])}return[a,...o]}function Gr({param:e,value:t}){if(e.type==="string"||e.type==="bytes")return xe(We(t));if(e.type==="tuple"||e.type.match(/^(.*)\[(\d+)?\]$/))throw new va(e.type);return Wt([e],[t])}function bn(e,{method:t}){var r,s;const n={};return e.transport.type==="fallback"&&((s=(r=e.transport).onResponse)==null||s.call(r,({method:a,response:o,status:c,transport:u})=>{c==="success"&&t===a&&(n[o]=u.request)})),a=>n[a]||e.request}async function cs(e,{address:t,abi:n,args:r,eventName:s,fromBlock:a,strict:o,toBlock:c}){const u=bn(e,{method:"eth_newFilter"}),h=s?qt({abi:n,args:r,eventName:s}):void 0,m=await e.request({method:"eth_newFilter",params:[{address:t,fromBlock:typeof a=="bigint"?X(a):a,toBlock:typeof c=="bigint"?X(c):c,topics:h}]});return{abi:n,args:r,eventName:s,id:m,request:u(m),strict:o,type:"event"}}function Ce(e){return typeof e=="string"?{address:e,type:"json-rpc"}:e}function Ye({abi:e,args:t,functionName:n}){let r=e[0];if(n&&(r=_t({abi:e,args:t,name:n}),!r))throw new on(n,{docsPath:"/docs/contract/encodeFunctionData"});if(r.type!=="function")throw new on(void 0,{docsPath:"/docs/contract/encodeFunctionData"});const s=De(r),a=mr(s),o="inputs"in r&&r.inputs?Wt(r.inputs,t??[]):void 0;return dr([a,o??"0x"])}const ls={1:"An `assert` condition failed.",17:"Arithmic operation resulted in underflow or overflow.",18:"Division or modulo by zero (e.g. `5 / 0` or `23 % 0`).",33:"Attempted to convert to an invalid type.",34:"Attempted to access a storage byte array that is incorrectly encoded.",49:"Performed `.pop()` on an empty array",50:"Array index is out of bounds.",65:"Allocated too much memory or created an array which is too large.",81:"Attempted to call a zero-initialized variable of internal function type."},wo={inputs:[{name:"message",type:"string"}],name:"Error",type:"error"},xo={inputs:[{name:"reason",type:"uint256"}],name:"Panic",type:"error"};function gr(e,t){const n=e.substring(2).toLowerCase(),r=xe(Be(n),"bytes"),s=n.split("");for(let a=0;a<40;a+=2)r[a>>1]>>4>=8&&s[a]&&(s[a]=s[a].toUpperCase()),(r[a>>1]&15)>=8&&s[a+1]&&(s[a+1]=s[a+1].toUpperCase());return`0x${s.join("")}`}function vo(e,t){if(!_e(e))throw new Nt({address:e});return gr(e)}function yn(e,t){if(t==="0x"&&e.length>0)throw new mn;if(fe(t)&&fe(t)<32)throw new or({data:t,params:e,size:fe(t)});return To({data:t,params:e})}function To({data:e,params:t}){const n=[];let r=0;for(let s=0;s<t.length;s++){if(r>=fe(e))throw new or({data:e,params:t,size:fe(e)});const a=t[s],{consumed:o,value:c}=ct({data:e,param:a,position:r});n.push(c),r+=o}return n}function ct({data:e,param:t,position:n}){const r=pn(t.type);if(r){const[a,o]=r;return Po(e,{length:a,param:{...t,type:o},position:n})}if(t.type==="tuple")return Ao(e,{param:t,position:n});if(t.type==="string")return So(e,{position:n});if(t.type.startsWith("bytes"))return Co(e,{param:t,position:n});const s=ce(e,n,n+32,{strict:!0});if(t.type.startsWith("uint")||t.type.startsWith("int"))return jo(s,{param:t});if(t.type==="address")return Eo(s);if(t.type==="bool")return No(s);throw new ya(t.type,{docsPath:"/docs/contract/decodeAbiParameters"})}function Eo(e){return{consumed:32,value:gr(ce(e,-20))}}function Po(e,{param:t,length:n,position:r}){if(!n){const o=be(ce(e,r,r+32,{strict:!0})),c=be(ce(e,o,o+32,{strict:!0}));let u=0;const h=[];for(let m=0;m<c;++m){const y=ct({data:ce(e,o+32),param:t,position:u});u+=y.consumed,h.push(y.value)}return{value:h,consumed:32}}if(cn(t)){const o=pn(t.type),c=!(o!=null&&o[0]);let u=0;const h=[];for(let m=0;m<n;++m){const y=be(ce(e,r,r+32,{strict:!0})),w=ct({data:ce(e,y),param:t,position:c?u:m*32});u+=w.consumed,h.push(w.value)}return{value:h,consumed:32}}let s=0;const a=[];for(let o=0;o<n;++o){const c=ct({data:e,param:t,position:r+s});s+=c.consumed,a.push(c.value)}return{value:a,consumed:s}}function No(e){return{consumed:32,value:Ca(e)}}function Co(e,{param:t,position:n}){const[r,s]=t.type.split("bytes");if(!s){const o=be(ce(e,n,n+32,{strict:!0})),c=be(ce(e,o,o+32,{strict:!0}));return c===0?{consumed:32,value:"0x"}:{consumed:32,value:ce(e,o+32,o+32+c,{strict:!0})}}return{consumed:32,value:ce(e,n,n+parseInt(s),{strict:!0})}}function jo(e,{param:t}){const n=t.type.startsWith("int");return{consumed:32,value:parseInt(t.type.split("int")[1]||"256")>48?gn(e,{signed:n}):be(e,{signed:n})}}function So(e,{position:t}){const n=be(ce(e,t,t+32,{strict:!0})),r=be(ce(e,n,n+32,{strict:!0}));return r===0?{consumed:32,value:""}:{consumed:32,value:ja(it(ce(e,n+32,n+32+r,{strict:!0})))}}function Ao(e,{param:t,position:n}){const r=t.components.length===0||t.components.some(({name:o})=>!o),s=r?[]:{};let a=0;if(cn(t)){const o=be(ce(e,n,n+32,{strict:!0}));for(let c=0;c<t.components.length;++c){const u=t.components[c],h=ct({data:ce(e,o),param:u,position:a});a+=h.consumed,s[r?c:u==null?void 0:u.name]=h.value}return{consumed:32,value:s}}for(let o=0;o<t.components.length;++o){const c=t.components[o],u=ct({data:e,param:c,position:n+a});a+=u.consumed,s[r?o:c==null?void 0:c.name]=u.value}return{consumed:a,value:s}}function cn(e){var r;const{type:t}=e;if(t==="string"||t==="bytes"||t.endsWith("[]"))return!0;if(t==="tuple")return(r=e.components)==null?void 0:r.some(cn);const n=pn(e.type);return!!(n&&cn({...e,type:n[1]}))}function Ro({abi:e,data:t}){const n=ce(t,0,4);if(n==="0x")throw new mn;const s=[...e||[],wo,xo].find(a=>a.type==="error"&&n===mr(De(a)));if(!s)throw new Yr(n,{docsPath:"/docs/contract/decodeErrorResult"});return{abiItem:s,args:"inputs"in s&&s.inputs&&s.inputs.length>0?yn(s.inputs,ce(t,4)):void 0,errorName:s.name}}const ve=(e,t,n)=>JSON.stringify(e,(r,s)=>{const a=typeof s=="bigint"?s.toString():s;return typeof t=="function"?t(r,a):a},n);function us({abiItem:e,args:t,includeFunctionName:n=!0,includeName:r=!1}){if("name"in e&&"inputs"in e&&e.inputs)return`${n?e.name:""}(${e.inputs.map((s,a)=>`${r&&s.name?`${s.name}: `:""}${typeof t[a]=="object"?ve(t[a]):t[a]}`).join(", ")})`}const $o={gwei:9,wei:18},ds={ether:-9,wei:9};function fs(e,t){let n=e.toString();const r=n.startsWith("-");r&&(n=n.slice(1)),n=n.padStart(t,"0");let[s,a]=[n.slice(0,n.length-t),n.slice(n.length-t)];return a=a.replace(/(0+)$/,""),`${r?"-":""}${s||"0"}${a?`.${a}`:""}`}function pr(e,t="wei"){return fs(e,$o[t])}function Ee(e,t="wei"){return fs(e,ds[t])}function Kt(e){const t=Object.entries(e).map(([r,s])=>s===void 0||s===!1?null:[r,s]).filter(Boolean),n=t.reduce((r,[s])=>Math.max(r,s.length),0);return t.map(([r,s])=>`  ${`${r}:`.padEnd(n+1)}  ${s}`).join(`
`)}class Io extends I{constructor(){super(["Cannot specify both a `gasPrice` and a `maxFeePerGas`/`maxPriorityFeePerGas`.","Use `maxFeePerGas`/`maxPriorityFeePerGas` for EIP-1559 compatible networks, and `gasPrice` for others."].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"FeeConflictError"})}}class Oo extends I{constructor({transaction:t}){super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",Kt(t),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- a Legacy Transaction with `gasPrice`"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidSerializableTransactionError"})}}class Mo extends I{constructor(t,{account:n,docsPath:r,chain:s,data:a,gas:o,gasPrice:c,maxFeePerGas:u,maxPriorityFeePerGas:h,nonce:m,to:y,value:w}){var b;const N=Kt({chain:s&&`${s==null?void 0:s.name} (id: ${s==null?void 0:s.id})`,from:n==null?void 0:n.address,to:y,value:typeof w<"u"&&`${pr(w)} ${((b=s==null?void 0:s.nativeCurrency)==null?void 0:b.symbol)||"ETH"}`,data:a,gas:o,gasPrice:typeof c<"u"&&`${Ee(c)} gwei`,maxFeePerGas:typeof u<"u"&&`${Ee(u)} gwei`,maxPriorityFeePerGas:typeof h<"u"&&`${Ee(h)} gwei`,nonce:m});super(t.shortMessage,{cause:t,docsPath:r,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Request Arguments:",N].filter(Boolean)}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TransactionExecutionError"}),this.cause=t}}class hs extends I{constructor({blockHash:t,blockNumber:n,blockTag:r,hash:s,index:a}){let o="Transaction";r&&a!==void 0&&(o=`Transaction at block time "${r}" at index "${a}"`),t&&a!==void 0&&(o=`Transaction at block hash "${t}" at index "${a}"`),n&&a!==void 0&&(o=`Transaction at block number "${n}" at index "${a}"`),s&&(o=`Transaction with hash "${s}"`),super(`${o} could not be found.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TransactionNotFoundError"})}}class ms extends I{constructor({hash:t}){super(`Transaction receipt with hash "${t}" could not be found. The Transaction may not be processed on a block yet.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TransactionReceiptNotFoundError"})}}class Fo extends I{constructor({hash:t}){super(`Timed out while waiting for transaction with hash "${t}" to be confirmed.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WaitForTransactionReceiptTimeoutError"})}}class gs extends I{constructor(t,{account:n,docsPath:r,chain:s,data:a,gas:o,gasPrice:c,maxFeePerGas:u,maxPriorityFeePerGas:h,nonce:m,to:y,value:w}){var T;const N=n?Ce(n):void 0,b=Kt({from:N==null?void 0:N.address,to:y,value:typeof w<"u"&&`${pr(w)} ${((T=s==null?void 0:s.nativeCurrency)==null?void 0:T.symbol)||"ETH"}`,data:a,gas:o,gasPrice:typeof c<"u"&&`${Ee(c)} gwei`,maxFeePerGas:typeof u<"u"&&`${Ee(u)} gwei`,maxPriorityFeePerGas:typeof h<"u"&&`${Ee(h)} gwei`,nonce:m});super(t.shortMessage,{cause:t,docsPath:r,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Raw Call Arguments:",b].filter(Boolean)}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"CallExecutionError"}),this.cause=t}}class ko extends I{constructor(t,{abi:n,args:r,contractAddress:s,docsPath:a,functionName:o,sender:c}){const u=_t({abi:n,args:r,name:o}),h=u?us({abiItem:u,args:r,includeFunctionName:!1,includeName:!1}):void 0,m=u?De(u,{includeName:!0}):void 0,y=Kt({address:s&&oa(s),function:m,args:h&&h!=="()"&&`${[...Array((o==null?void 0:o.length)??0).keys()].map(()=>" ").join("")}${h}`,sender:c});super(t.shortMessage||`An unknown error occurred while executing the contract function "${o}".`,{cause:t,docsPath:a,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Contract Call:",y].filter(Boolean)}),Object.defineProperty(this,"abi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"contractAddress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"formattedArgs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"functionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sender",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ContractFunctionExecutionError"}),this.abi=n,this.args=r,this.cause=t,this.contractAddress=s,this.functionName=o,this.sender=c}}class Un extends I{constructor({abi:t,data:n,functionName:r,message:s}){let a,o,c,u;if(n&&n!=="0x")try{o=Ro({abi:t,data:n});const{abiItem:m,errorName:y,args:w}=o;if(y==="Error")u=w[0];else if(y==="Panic"){const[N]=w;u=ls[N]}else{const N=m?De(m,{includeName:!0}):void 0,b=m&&w?us({abiItem:m,args:w,includeFunctionName:!1,includeName:!1}):void 0;c=[N?`Error: ${N}`:"",b&&b!=="()"?`       ${[...Array((y==null?void 0:y.length)??0).keys()].map(()=>" ").join("")}${b}`:""]}}catch(m){a=m}else s&&(u=s);let h;a instanceof Yr&&(h=a.signature,c=[`Unable to decode signature "${h}" as it was not found on the provided ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${h}.`]),super(u&&u!=="execution reverted"||h?[`The contract function "${r}" reverted with the following ${h?"signature":"reason"}:`,u||h].join(`
`):`The contract function "${r}" reverted.`,{cause:a,metaMessages:c}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ContractFunctionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reason",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=o,this.reason=u,this.signature=h}}class Bo extends I{constructor({functionName:t}){super(`The contract function "${t}" returned no data ("0x").`,{metaMessages:["This could be due to any of the following:",`  - The contract does not have the function "${t}",`,"  - The parameters passed to the contract function may be invalid, or","  - The address is not a contract."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ContractFunctionZeroDataError"})}}class br extends I{constructor({data:t,message:n}){super(n||""),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RawContractError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t}}class Et extends I{constructor({body:t,details:n,headers:r,status:s,url:a}){super("HTTP request failed.",{details:n,metaMessages:[s&&`Status: ${s}`,`URL: ${hn(a)}`,t&&`Request body: ${ve(t)}`].filter(Boolean)}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=t,this.headers=r,this.status=s,this.url=a}}class Do extends I{constructor({body:t,details:n,url:r}){super("WebSocket request failed.",{details:n,metaMessages:[`URL: ${hn(r)}`,`Request body: ${ve(t)}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WebSocketRequestError"})}}class ps extends I{constructor({body:t,error:n,url:r}){super("RPC Request failed.",{cause:n,details:n.message,metaMessages:[`URL: ${hn(r)}`,`Request body: ${ve(t)}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=n.code}}class zn extends I{constructor({body:t,url:n}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${hn(n)}`,`Request body: ${ve(t)}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TimeoutError"})}}const Lo=-1;class Pe extends I{constructor(t,{code:n,docsPath:r,metaMessages:s,shortMessage:a}){super(a,{cause:t,docsPath:r,metaMessages:s||(t==null?void 0:t.metaMessages)}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=t.name,this.code=t instanceof ps?t.code:n??Lo}}class ht extends Pe{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderRpcError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n.data}}class Ct extends Pe{constructor(t){super(t,{code:Ct.code,shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ParseRpcError"})}}Object.defineProperty(Ct,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class jt extends Pe{constructor(t){super(t,{code:jt.code,shortMessage:"JSON is not a valid request object."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidRequestRpcError"})}}Object.defineProperty(jt,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class St extends Pe{constructor(t){super(t,{code:St.code,shortMessage:"The method does not exist / is not available."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"MethodNotFoundRpcError"})}}Object.defineProperty(St,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class At extends Pe{constructor(t){super(t,{code:At.code,shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParamsRpcError"})}}Object.defineProperty(At,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class ut extends Pe{constructor(t){super(t,{code:ut.code,shortMessage:"An internal error was received."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InternalRpcError"})}}Object.defineProperty(ut,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class tt extends Pe{constructor(t){super(t,{code:tt.code,shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidInputRpcError"})}}Object.defineProperty(tt,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class Rt extends Pe{constructor(t){super(t,{code:Rt.code,shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(Rt,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class $t extends Pe{constructor(t){super(t,{code:$t.code,shortMessage:"Requested resource not available."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceUnavailableRpcError"})}}Object.defineProperty($t,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class It extends Pe{constructor(t){super(t,{code:It.code,shortMessage:"Transaction creation failed."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TransactionRejectedRpcError"})}}Object.defineProperty(It,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class Ot extends Pe{constructor(t){super(t,{code:Ot.code,shortMessage:"Method is not implemented."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"MethodNotSupportedRpcError"})}}Object.defineProperty(Ot,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class Mt extends Pe{constructor(t){super(t,{code:Mt.code,shortMessage:"Request exceeds defined limit."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"LimitExceededRpcError"})}}Object.defineProperty(Mt,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Ft extends Pe{constructor(t){super(t,{code:Ft.code,shortMessage:"Version of JSON-RPC protocol is not supported."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"JsonRpcVersionUnsupportedError"})}}Object.defineProperty(Ft,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class lt extends ht{constructor(t){super(t,{code:lt.code,shortMessage:"User rejected the request."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UserRejectedRequestError"})}}Object.defineProperty(lt,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class kt extends ht{constructor(t){super(t,{code:kt.code,shortMessage:"The requested method and/or account has not been authorized by the user."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnauthorizedProviderError"})}}Object.defineProperty(kt,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class Bt extends ht{constructor(t){super(t,{code:Bt.code,shortMessage:"The Provider does not support the requested method."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnsupportedProviderMethodError"})}}Object.defineProperty(Bt,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class Dt extends ht{constructor(t){super(t,{code:Dt.code,shortMessage:"The Provider is disconnected from all chains."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderDisconnectedError"})}}Object.defineProperty(Dt,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class Lt extends ht{constructor(t){super(t,{code:Lt.code,shortMessage:"The Provider is not connected to the requested chain."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainDisconnectedError"})}}Object.defineProperty(Lt,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class Gt extends ht{constructor(t){super(t,{code:Gt.code,shortMessage:"An error occurred when attempting to switch chain."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SwitchChainError"})}}Object.defineProperty(Gt,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class Go extends Pe{constructor(t){super(t,{shortMessage:"An unknown RPC error occurred."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownRpcError"})}}const Uo=3;function Ut(e,{abi:t,address:n,args:r,docsPath:s,functionName:a,sender:o}){const{code:c,data:u,message:h,shortMessage:m}=e instanceof br?e:e instanceof I?e.walk(w=>"data"in w)||e.walk():{},y=e instanceof mn?new Bo({functionName:a}):[Uo,ut.code].includes(c)&&(u||h||m)?new Un({abi:t,data:typeof u=="object"?u.data:u,functionName:a,message:m??h}):e;return new ko(y,{abi:t,args:r,contractAddress:n,docsPath:s,functionName:a,sender:o})}class mt extends I{constructor({docsPath:t}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the WalletClient."].join(`
`),{docsPath:t,docsSlug:"account"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AccountNotFoundError"})}}class zo extends I{constructor(t,{account:n,docsPath:r,chain:s,data:a,gas:o,gasPrice:c,maxFeePerGas:u,maxPriorityFeePerGas:h,nonce:m,to:y,value:w}){var b;const N=Kt({from:n==null?void 0:n.address,to:y,value:typeof w<"u"&&`${pr(w)} ${((b=s==null?void 0:s.nativeCurrency)==null?void 0:b.symbol)||"ETH"}`,data:a,gas:o,gasPrice:typeof c<"u"&&`${Ee(c)} gwei`,maxFeePerGas:typeof u<"u"&&`${Ee(u)} gwei`,maxPriorityFeePerGas:typeof h<"u"&&`${Ee(h)} gwei`,nonce:m});super(t.shortMessage,{cause:t,docsPath:r,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Estimate Gas Arguments:",N].filter(Boolean)}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"EstimateGasExecutionError"}),this.cause=t}}class ot extends I{constructor({cause:t,message:n}={}){var s;const r=(s=n==null?void 0:n.replace("execution reverted: ",""))==null?void 0:s.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ExecutionRevertedError"})}}Object.defineProperty(ot,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(ot,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class ln extends I{constructor({cause:t,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${Ee(n)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"FeeCapTooHigh"})}}Object.defineProperty(ln,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class Hn extends I{constructor({cause:t,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${Ee(n)}`:""} gwei) cannot be lower than the block base fee.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"FeeCapTooLow"})}}Object.defineProperty(Hn,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class Wn extends I{constructor({cause:t,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}is higher than the next one expected.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"NonceTooHighError"})}}Object.defineProperty(Wn,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class _n extends I{constructor({cause:t,nonce:n}={}){super([`Nonce provided for the transaction ${n?`(${n}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"NonceTooLowError"})}}Object.defineProperty(_n,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class qn extends I{constructor({cause:t,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}exceeds the maximum allowed nonce.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"NonceMaxValueError"})}}Object.defineProperty(qn,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class Kn extends I{constructor({cause:t}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:t,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InsufficientFundsError"})}}Object.defineProperty(Kn,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds/});class Jn extends I{constructor({cause:t,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"IntrinsicGasTooHighError"})}}Object.defineProperty(Jn,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class Yn extends I{constructor({cause:t,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction is too low.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"IntrinsicGasTooLowError"})}}Object.defineProperty(Yn,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class Vn extends I{constructor({cause:t}){super("The transaction type is not supported for this chain.",{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TransactionTypeNotSupportedError"})}}Object.defineProperty(Vn,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class un extends I{constructor({cause:t,maxPriorityFeePerGas:n,maxFeePerGas:r}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${n?` = ${Ee(n)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${Ee(r)} gwei`:""}).`].join(`
`),{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TipAboveFeeCapError"})}}Object.defineProperty(un,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class wn extends I{constructor({cause:t}){super(`An error occurred while executing: ${t==null?void 0:t.shortMessage}`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownNodeError"})}}function yr(e,t){const n=(e.details||"").toLowerCase(),r=e.walk(s=>s.code===ot.code);return r instanceof I?new ot({cause:e,message:r.details}):ot.nodeMessage.test(n)?new ot({cause:e,message:e.details}):ln.nodeMessage.test(n)?new ln({cause:e,maxFeePerGas:t==null?void 0:t.maxFeePerGas}):Hn.nodeMessage.test(n)?new Hn({cause:e,maxFeePerGas:t==null?void 0:t.maxFeePerGas}):Wn.nodeMessage.test(n)?new Wn({cause:e,nonce:t==null?void 0:t.nonce}):_n.nodeMessage.test(n)?new _n({cause:e,nonce:t==null?void 0:t.nonce}):qn.nodeMessage.test(n)?new qn({cause:e,nonce:t==null?void 0:t.nonce}):Kn.nodeMessage.test(n)?new Kn({cause:e}):Jn.nodeMessage.test(n)?new Jn({cause:e,gas:t==null?void 0:t.gas}):Yn.nodeMessage.test(n)?new Yn({cause:e,gas:t==null?void 0:t.gas}):Vn.nodeMessage.test(n)?new Vn({cause:e}):un.nodeMessage.test(n)?new un({cause:e,maxFeePerGas:t==null?void 0:t.maxFeePerGas,maxPriorityFeePerGas:t==null?void 0:t.maxPriorityFeePerGas}):new wn({cause:e})}function Ho(e,{docsPath:t,...n}){const r=(()=>{const s=yr(e,n);return s instanceof wn?e:s})();return new zo(r,{docsPath:t,...n})}function wr(e,{format:t}){if(!t)return{};const n={};function r(a){const o=Object.keys(a);for(const c of o)c in e&&(n[c]=e[c]),a[c]&&typeof a[c]=="object"&&!Array.isArray(a[c])&&r(a[c])}const s=t(e||{});return r(s),n}const Wo={legacy:"0x0",eip2930:"0x1",eip1559:"0x2"};function xn(e){return{...e,gas:typeof e.gas<"u"?X(e.gas):void 0,gasPrice:typeof e.gasPrice<"u"?X(e.gasPrice):void 0,maxFeePerGas:typeof e.maxFeePerGas<"u"?X(e.maxFeePerGas):void 0,maxPriorityFeePerGas:typeof e.maxPriorityFeePerGas<"u"?X(e.maxPriorityFeePerGas):void 0,nonce:typeof e.nonce<"u"?X(e.nonce):void 0,type:typeof e.type<"u"?Wo[e.type]:void 0,value:typeof e.value<"u"?X(e.value):void 0}}function Jt(e){const{account:t,gasPrice:n,maxFeePerGas:r,maxPriorityFeePerGas:s,to:a}=e,o=t?Ce(t):void 0;if(o&&!_e(o.address))throw new Nt({address:o.address});if(a&&!_e(a))throw new Nt({address:a});if(typeof n<"u"&&(typeof r<"u"||typeof s<"u"))throw new Io;if(r&&r>2n**256n-1n)throw new ln({maxFeePerGas:r});if(s&&r&&s>r)throw new un({maxFeePerGas:r,maxPriorityFeePerGas:s})}class _o extends I{constructor(){super("`baseFeeMultiplier` must be greater than 1."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseFeeScalarError"})}}class xr extends I{constructor(){super("Chain does not support EIP-1559 fees."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Eip1559FeesNotSupportedError"})}}class qo extends I{constructor({maxPriorityFeePerGas:t}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${Ee(t)} gwei).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"MaxFeePerGasTooLowError"})}}class bs extends I{constructor({blockHash:t,blockNumber:n}){let r="Block";t&&(r=`Block at hash "${t}"`),n&&(r=`Block at number "${n}"`),super(`${r} could not be found.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BlockNotFoundError"})}}const ys={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559"};function ws(e){const t={...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,chainId:e.chainId?be(e.chainId):void 0,gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,maxFeePerGas:e.maxFeePerGas?BigInt(e.maxFeePerGas):void 0,maxPriorityFeePerGas:e.maxPriorityFeePerGas?BigInt(e.maxPriorityFeePerGas):void 0,nonce:e.nonce?be(e.nonce):void 0,to:e.to?e.to:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,type:e.type?ys[e.type]:void 0,typeHex:e.type?e.type:void 0,value:e.value?BigInt(e.value):void 0,v:e.v?BigInt(e.v):void 0};return t.yParity=(()=>{if(e.yParity)return Number(e.yParity);if(typeof t.v=="bigint"){if(t.v===0n||t.v===27n)return 0;if(t.v===1n||t.v===28n)return 1;if(t.v>=35n)return t.v%2n===0n?1:0}})(),t.type==="legacy"&&(delete t.accessList,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,delete t.yParity),t.type==="eip2930"&&(delete t.maxFeePerGas,delete t.maxPriorityFeePerGas),t}function xs(e){var n;const t=(n=e.transactions)==null?void 0:n.map(r=>typeof r=="string"?r:ws(r));return{...e,baseFeePerGas:e.baseFeePerGas?BigInt(e.baseFeePerGas):null,difficulty:e.difficulty?BigInt(e.difficulty):void 0,gasLimit:e.gasLimit?BigInt(e.gasLimit):void 0,gasUsed:e.gasUsed?BigInt(e.gasUsed):void 0,hash:e.hash?e.hash:null,logsBloom:e.logsBloom?e.logsBloom:null,nonce:e.nonce?e.nonce:null,number:e.number?BigInt(e.number):null,size:e.size?BigInt(e.size):void 0,timestamp:e.timestamp?BigInt(e.timestamp):void 0,transactions:t,totalDifficulty:e.totalDifficulty?BigInt(e.totalDifficulty):null}}async function qe(e,{blockHash:t,blockNumber:n,blockTag:r,includeTransactions:s}={}){var m,y,w;const a=r??"latest",o=s??!1,c=n!==void 0?X(n):void 0;let u=null;if(t?u=await e.request({method:"eth_getBlockByHash",params:[t,o]}):u=await e.request({method:"eth_getBlockByNumber",params:[c||a,o]}),!u)throw new bs({blockHash:t,blockNumber:n});return(((w=(y=(m=e.chain)==null?void 0:m.formatters)==null?void 0:y.block)==null?void 0:w.format)||xs)(u)}async function vr(e){const t=await e.request({method:"eth_gasPrice"});return BigInt(t)}async function Ko(e,t){return vs(e,t)}async function vs(e,t){var a,o,c;const{block:n,chain:r=e.chain,request:s}=t||{};if(typeof((a=r==null?void 0:r.fees)==null?void 0:a.defaultPriorityFee)=="function"){const u=n||await J(e,qe,"getBlock")({});return r.fees.defaultPriorityFee({block:u,client:e,request:s})}if(typeof((o=r==null?void 0:r.fees)==null?void 0:o.defaultPriorityFee)<"u")return(c=r==null?void 0:r.fees)==null?void 0:c.defaultPriorityFee;try{const u=await e.request({method:"eth_maxPriorityFeePerGas"});return gn(u)}catch{const[u,h]=await Promise.all([n?Promise.resolve(n):J(e,qe,"getBlock")({}),J(e,vr,"getGasPrice")({})]);if(typeof u.baseFeePerGas!="bigint")throw new xr;const m=h-u.baseFeePerGas;return m<0n?0n:m}}async function Jo(e,t){return Xn(e,t)}async function Xn(e,t){var w,N;const{block:n,chain:r=e.chain,request:s,type:a="eip1559"}=t||{},o=await(async()=>{var b,T;return typeof((b=r==null?void 0:r.fees)==null?void 0:b.baseFeeMultiplier)=="function"?r.fees.baseFeeMultiplier({block:n,client:e,request:s}):((T=r==null?void 0:r.fees)==null?void 0:T.baseFeeMultiplier)??1.2})();if(o<1)throw new _o;const u=10**(((w=o.toString().split(".")[1])==null?void 0:w.length)??0),h=b=>b*BigInt(Math.ceil(o*u))/BigInt(u),m=n||await J(e,qe,"getBlock")({});if(typeof((N=r==null?void 0:r.fees)==null?void 0:N.estimateFeesPerGas)=="function")return r.fees.estimateFeesPerGas({block:n,client:e,multiply:h,request:s,type:a});if(a==="eip1559"){if(typeof m.baseFeePerGas!="bigint")throw new xr;const b=s!=null&&s.maxPriorityFeePerGas?s.maxPriorityFeePerGas:await vs(e,{block:m,chain:r,request:s}),T=h(m.baseFeePerGas);return{maxFeePerGas:(s==null?void 0:s.maxFeePerGas)??T+b,maxPriorityFeePerGas:b}}return{gasPrice:(s==null?void 0:s.gasPrice)??h(await J(e,vr,"getGasPrice")({}))}}async function Ts(e,{address:t,blockTag:n="latest",blockNumber:r}){const s=await e.request({method:"eth_getTransactionCount",params:[t,r?X(r):n]});return be(s)}function Yo(e){if(e.type)return e.type;if(typeof e.maxFeePerGas<"u"||typeof e.maxPriorityFeePerGas<"u")return"eip1559";if(typeof e.gasPrice<"u")return typeof e.accessList<"u"?"eip2930":"legacy";throw new Oo({transaction:e})}async function vn(e,t){const{account:n=e.account,chain:r,gas:s,nonce:a,type:o}=t;if(!n)throw new mt;const c=Ce(n),u=await J(e,qe,"getBlock")({blockTag:"latest"}),h={...t,from:c.address};if(typeof a>"u"&&(h.nonce=await J(e,Ts,"getTransactionCount")({address:c.address,blockTag:"pending"})),typeof o>"u")try{h.type=Yo(h)}catch{h.type=typeof u.baseFeePerGas=="bigint"?"eip1559":"legacy"}if(h.type==="eip1559"){const{maxFeePerGas:m,maxPriorityFeePerGas:y}=await Xn(e,{block:u,chain:r,request:h});if(typeof t.maxPriorityFeePerGas>"u"&&t.maxFeePerGas&&t.maxFeePerGas<y)throw new qo({maxPriorityFeePerGas:y});h.maxPriorityFeePerGas=y,h.maxFeePerGas=m}else{if(typeof t.maxFeePerGas<"u"||typeof t.maxPriorityFeePerGas<"u")throw new xr;const{gasPrice:m}=await Xn(e,{block:u,chain:r,request:h,type:"legacy"});h.gasPrice=m}return typeof s>"u"&&(h.gas=await J(e,Tr,"estimateGas")({...h,account:{address:c.address,type:"json-rpc"}})),Jt(h),h}async function Tr(e,t){var s,a,o;const n=t.account??e.account;if(!n)throw new mt({docsPath:"/docs/actions/public/estimateGas"});const r=Ce(n);try{const{accessList:c,blockNumber:u,blockTag:h,data:m,gas:y,gasPrice:w,maxFeePerGas:N,maxPriorityFeePerGas:b,nonce:T,to:R,value:x,...P}=r.type==="local"?await vn(e,t):t,C=(u?X(u):void 0)||h;Jt(t);const D=(o=(a=(s=e.chain)==null?void 0:s.formatters)==null?void 0:a.transactionRequest)==null?void 0:o.format,S=(D||xn)({...wr(P,{format:D}),from:r.address,accessList:c,data:m,gas:y,gasPrice:w,maxFeePerGas:N,maxPriorityFeePerGas:b,nonce:T,to:R,value:x}),Y=await e.request({method:"eth_estimateGas",params:C?[S,C]:[S]});return BigInt(Y)}catch(c){throw Ho(c,{...t,account:r,chain:e.chain})}}async function Vo(e,{abi:t,address:n,args:r,functionName:s,...a}){const o=Ye({abi:t,args:r,functionName:s});try{return await J(e,Tr,"estimateGas")({data:o,to:n,...a})}catch(c){const u=a.account?Ce(a.account):void 0;throw Ut(c,{abi:t,address:n,args:r,docsPath:"/docs/contract/estimateContractGas",functionName:s,sender:u==null?void 0:u.address})}}const Ur="/docs/contract/decodeEventLog";function Yt({abi:e,data:t,strict:n,topics:r}){const s=n??!0,[a,...o]=r;if(!a)throw new fa({docsPath:Ur});const c=e.find(b=>b.type==="event"&&a===ur(De(b)));if(!(c&&"name"in c)||c.type!=="event")throw new ha(a,{docsPath:Ur});const{name:u,inputs:h}=c,m=h==null?void 0:h.some(b=>!("name"in b&&b.name));let y=m?[]:{};const w=h.filter(b=>"indexed"in b&&b.indexed);for(let b=0;b<w.length;b++){const T=w[b],R=o[b];if(!R)throw new dt({abiItem:c,param:T});y[T.name||b]=Xo({param:T,value:R})}const N=h.filter(b=>!("indexed"in b&&b.indexed));if(N.length>0){if(t&&t!=="0x")try{const b=yn(N,t);if(b)if(m)y=[...y,...b];else for(let T=0;T<N.length;T++)y[N[T].name]=b[T]}catch(b){if(s)throw b instanceof or?new et({abiItem:c,data:b.data,params:b.params,size:b.size}):b}else if(s)throw new et({abiItem:c,data:"0x",params:N,size:0})}return{eventName:u,args:Object.values(y).length>0?y:void 0}}function Xo({param:e,value:t}){return e.type==="string"||e.type==="bytes"||e.type==="tuple"||e.type.match(/^(.*)\[(\d+)?\]$/)?t:(yn([e],t)||[])[0]}function Ae(e,{args:t,eventName:n}={}){return{...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,logIndex:e.logIndex?Number(e.logIndex):null,transactionHash:e.transactionHash?e.transactionHash:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,...n?{args:t,eventName:n}:{}}}async function Er(e,{address:t,blockHash:n,fromBlock:r,toBlock:s,event:a,events:o,args:c,strict:u}={}){const h=u??!1,m=o??(a?[a]:void 0);let y=[];m&&(y=[m.flatMap(N=>qt({abi:[N],eventName:N.name,args:c}))],a&&(y=y[0]));let w;return n?w=await e.request({method:"eth_getLogs",params:[{address:t,topics:y,blockHash:n}]}):w=await e.request({method:"eth_getLogs",params:[{address:t,topics:y,fromBlock:typeof r=="bigint"?X(r):r,toBlock:typeof s=="bigint"?X(s):s}]}),w.map(N=>{var b;try{const{eventName:T,args:R}=m?Yt({abi:m,data:N.data,topics:N.topics,strict:h}):{eventName:void 0,args:void 0};return Ae(N,{args:R,eventName:T})}catch(T){let R,x;if(T instanceof et||T instanceof dt){if(h)return;R=T.abiItem.name,x=(b=T.abiItem.inputs)==null?void 0:b.some(P=>!("name"in P&&P.name))}return Ae(N,{args:x?[]:{},eventName:R})}}).filter(Boolean)}async function Es(e,{abi:t,address:n,args:r,blockHash:s,eventName:a,fromBlock:o,toBlock:c,strict:u}){const h=a?_t({abi:t,name:a}):void 0,m=h?void 0:t.filter(y=>y.type==="event");return J(e,Er,"getLogs")({address:n,args:r,blockHash:s,event:h,events:m,fromBlock:o,toBlock:c,strict:u})}const On="/docs/contract/decodeFunctionResult";function gt({abi:e,args:t,functionName:n,data:r}){let s=e[0];if(n&&(s=_t({abi:e,args:t,name:n}),!s))throw new on(n,{docsPath:On});if(s.type!=="function")throw new on(void 0,{docsPath:On});if(!s.outputs)throw new ma(s.name,{docsPath:On});const a=yn(s.outputs,r);if(a&&a.length>1)return a;if(a&&a.length===1)return a[0]}const Zn=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"}],Ps=[{inputs:[],name:"ResolverNotFound",type:"error"},{inputs:[],name:"ResolverWildcardNotSupported",type:"error"}],Ns=[...Ps,{name:"resolve",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]}],Zo=[...Ps,{name:"reverse",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolvedAddress"},{type:"address",name:"reverseResolver"},{type:"address",name:"resolver"}]}],zr=[{name:"text",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"key",type:"string"}],outputs:[{name:"",type:"string"}]}],Hr=[{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"}],outputs:[{name:"",type:"address"}]},{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"coinType",type:"uint256"}],outputs:[{name:"",type:"bytes"}]}],Qo=[{inputs:[{internalType:"address",name:"_signer",type:"address"},{internalType:"bytes32",name:"_hash",type:"bytes32"},{internalType:"bytes",name:"_signature",type:"bytes"}],stateMutability:"nonpayable",type:"constructor"}],ei="0x82ad56cb";class Qn extends I{constructor({blockNumber:t,chain:n,contract:r}){super(`Chain "${n.name}" does not support contract "${r.name}".`,{metaMessages:["This could be due to any of the following:",...t&&r.blockCreated&&r.blockCreated>t?[`- The contract "${r.name}" was not deployed until block ${r.blockCreated} (current block ${t}).`]:[`- The chain does not have the contract "${r.name}" configured.`]]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainDoesNotSupportContract"})}}class ti extends I{constructor({chain:t,currentChainId:n}){super(`The current chain of the wallet (id: ${n}) does not match the target chain for the transaction (id: ${t.id} – ${t.name}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${t.id} – ${t.name}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainMismatchError"})}}class ni extends I{constructor(){super(["No chain was provided to the request.","Please provide a chain with the `chain` argument on the Action, or by supplying a `chain` to WalletClient."].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainNotFoundError"})}}class Cs extends I{constructor(){super("No chain was provided to the Client."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ClientChainNotConfiguredError"})}}function pt({blockNumber:e,chain:t,contract:n}){var s;const r=(s=t==null?void 0:t.contracts)==null?void 0:s[n];if(!r)throw new Qn({chain:t,contract:{name:n}});if(e&&r.blockCreated&&r.blockCreated>e)throw new Qn({blockNumber:e,chain:t,contract:{name:n,blockCreated:r.blockCreated}});return r.address}function ri(e,{docsPath:t,...n}){const r=(()=>{const s=yr(e,n);return s instanceof wn?e:s})();return new gs(r,{docsPath:t,...n})}const Mn=new Map;function js({fn:e,id:t,shouldSplitBatch:n,wait:r=0,sort:s}){const a=async()=>{const m=u();o();const y=m.map(({args:w})=>w);y.length!==0&&e(y).then(w=>{var N;s&&Array.isArray(w)&&w.sort(s);for(let b=0;b<m.length;b++){const{pendingPromise:T}=m[b];(N=T.resolve)==null||N.call(T,[w[b],w])}}).catch(w=>{var N;for(let b=0;b<m.length;b++){const{pendingPromise:T}=m[b];(N=T.reject)==null||N.call(T,w)}})},o=()=>Mn.delete(t),c=()=>u().map(({args:m})=>m),u=()=>Mn.get(t)||[],h=m=>Mn.set(t,[...u(),m]);return{flush:o,async schedule(m){const y={},w=new Promise((T,R)=>{y.resolve=T,y.reject=R});return(n==null?void 0:n([...c(),m]))&&a(),u().length>0?(h({args:m,pendingPromise:y}),w):(h({args:m,pendingPromise:y}),setTimeout(a,r),w)}}}async function Tn(e,t){var x,P,v,C;const{account:n=e.account,batch:r=!!((x=e.batch)!=null&&x.multicall),blockNumber:s,blockTag:a="latest",accessList:o,data:c,gas:u,gasPrice:h,maxFeePerGas:m,maxPriorityFeePerGas:y,nonce:w,to:N,value:b,...T}=t,R=n?Ce(n):void 0;try{Jt(t);const O=(s?X(s):void 0)||a,S=(C=(v=(P=e.chain)==null?void 0:P.formatters)==null?void 0:v.transactionRequest)==null?void 0:C.format,q=(S||xn)({...wr(T,{format:S}),from:R==null?void 0:R.address,accessList:o,data:c,gas:u,gasPrice:h,maxFeePerGas:m,maxPriorityFeePerGas:y,nonce:w,to:N,value:b});if(r&&si({request:q}))try{return await ai(e,{...q,blockNumber:s,blockTag:a})}catch(_){if(!(_ instanceof Cs)&&!(_ instanceof Qn))throw _}const Q=await e.request({method:"eth_call",params:O?[q,O]:[q]});return Q==="0x"?{data:void 0}:{data:Q}}catch(D){const O=oi(D),{offchainLookup:S,offchainLookupSignature:Y}=await Vs(async()=>{const{offchainLookup:q,offchainLookupSignature:Q}=await import("./ccip-B_fqKDXk.js");return{offchainLookup:q,offchainLookupSignature:Q}},__vite__mapDeps([0,1,2]));if((O==null?void 0:O.slice(0,10))===Y&&N)return{data:await S(e,{data:O,to:N})};throw ri(D,{...t,account:R,chain:e.chain})}}function si({request:e}){const{data:t,to:n,...r}=e;return!(!t||t.startsWith(ei)||!n||Object.values(r).filter(s=>typeof s<"u").length>0)}async function ai(e,t){var T;const{batchSize:n=1024,wait:r=0}=typeof((T=e.batch)==null?void 0:T.multicall)=="object"?e.batch.multicall:{},{blockNumber:s,blockTag:a="latest",data:o,multicallAddress:c,to:u}=t;let h=c;if(!h){if(!e.chain)throw new Cs;h=pt({blockNumber:s,chain:e.chain,contract:"multicall3"})}const y=(s?X(s):void 0)||a,{schedule:w}=js({id:`${e.uid}.${y}`,wait:r,shouldSplitBatch(R){return R.reduce((P,{data:v})=>P+(v.length-2),0)>n*2},fn:async R=>{const x=R.map(C=>({allowFailure:!0,callData:C.data,target:C.to})),P=Ye({abi:Zn,args:[x],functionName:"aggregate3"}),v=await e.request({method:"eth_call",params:[{data:P,to:h},y]});return gt({abi:Zn,args:[x],functionName:"aggregate3",data:v||"0x"})}}),[{returnData:N,success:b}]=await w({data:o,to:u});if(!b)throw new br({data:N});return N==="0x"?{data:void 0}:{data:N}}function oi(e){if(!(e instanceof I))return;const t=e.walk();return typeof t.data=="object"?t.data.data:t.data}async function Ke(e,{abi:t,address:n,args:r,functionName:s,...a}){const o=Ye({abi:t,args:r,functionName:s});try{const{data:c}=await J(e,Tn,"call")({data:o,to:n,...a});return gt({abi:t,args:r,functionName:s,data:c||"0x"})}catch(c){throw Ut(c,{abi:t,address:n,args:r,docsPath:"/docs/contract/readContract",functionName:s})}}async function ii(e,{abi:t,address:n,args:r,dataSuffix:s,functionName:a,...o}){const c=o.account?Ce(o.account):void 0,u=Ye({abi:t,args:r,functionName:a});try{const{data:h}=await J(e,Tn,"call")({batch:!1,data:`${u}${s?s.replace("0x",""):""}`,to:n,...o});return{result:gt({abi:t,args:r,functionName:a,data:h||"0x"}),request:{abi:t,address:n,args:r,dataSuffix:s,functionName:a,...o}}}catch(h){throw Ut(h,{abi:t,address:n,args:r,docsPath:"/docs/contract/simulateContract",functionName:a,sender:c==null?void 0:c.address})}}const Fn=new Map,Wr=new Map;let ci=0;function bt(e,t,n){const r=++ci,s=()=>Fn.get(e)||[],a=()=>{const m=s();Fn.set(e,m.filter(y=>y.id!==r))},o=()=>{const m=Wr.get(e);s().length===1&&m&&m(),a()},c=s();if(Fn.set(e,[...c,{id:r,fns:t}]),c&&c.length>0)return o;const u={};for(const m in t)u[m]=(...y)=>{var N,b;const w=s();if(w.length!==0)for(const T of w)(b=(N=T.fns)[m])==null||b.call(N,...y)};const h=n(u);return typeof h=="function"&&Wr.set(e,h),o}async function er(e){return new Promise(t=>setTimeout(t,e))}function Vt(e,{emitOnBegin:t,initialWaitTime:n,interval:r}){let s=!0;const a=()=>s=!1;return(async()=>{let c;t&&(c=await e({unpoll:a}));const u=await(n==null?void 0:n(c))??r;await er(u);const h=async()=>{s&&(await e({unpoll:a}),await er(r),h())};h()})(),a}const li=new Map,ui=new Map;function di(e){const t=(s,a)=>({clear:()=>a.delete(s),get:()=>a.get(s),set:o=>a.set(s,o)}),n=t(e,li),r=t(e,ui);return{clear:()=>{n.clear(),r.clear()},promise:n,response:r}}async function fi(e,{cacheKey:t,cacheTime:n=1/0}){const r=di(t),s=r.response.get();if(s&&n>0&&new Date().getTime()-s.created.getTime()<n)return s.data;let a=r.promise.get();a||(a=e(),r.promise.set(a));try{const o=await a;return r.response.set({created:new Date,data:o}),o}finally{r.promise.clear()}}const hi=e=>`blockNumber.${e}`;async function Xt(e,{cacheTime:t=e.cacheTime,maxAge:n}={}){const r=await fi(()=>e.request({method:"eth_blockNumber"}),{cacheKey:hi(e.uid),cacheTime:n??t});return BigInt(r)}async function En(e,{filter:t}){const n="strict"in t&&t.strict;return(await t.request({method:"eth_getFilterChanges",params:[t.id]})).map(s=>{var a;if(typeof s=="string")return s;try{const{eventName:o,args:c}="abi"in t&&t.abi?Yt({abi:t.abi,data:s.data,topics:s.topics,strict:n}):{eventName:void 0,args:void 0};return Ae(s,{args:c,eventName:o})}catch(o){let c,u;if(o instanceof et||o instanceof dt){if("strict"in t&&t.strict)return;c=o.abiItem.name,u=(a=o.abiItem.inputs)==null?void 0:a.some(h=>!("name"in h&&h.name))}return Ae(s,{args:u?[]:{},eventName:c})}}).filter(Boolean)}async function Pn(e,{filter:t}){return t.request({method:"eth_uninstallFilter",params:[t.id]})}function mi(e,{abi:t,address:n,args:r,batch:s=!0,eventName:a,onError:o,onLogs:c,poll:u,pollingInterval:h=e.pollingInterval,strict:m}){return(typeof u<"u"?u:e.transport.type!=="webSocket")?(()=>{const b=ve(["watchContractEvent",n,r,s,e.uid,a,h]),T=m??!1;return bt(b,{onLogs:c,onError:o},R=>{let x,P,v=!1;const C=Vt(async()=>{var D;if(!v){try{P=await J(e,cs,"createContractEventFilter")({abi:t,address:n,args:r,eventName:a,strict:T})}catch{}v=!0;return}try{let O;if(P)O=await J(e,En,"getFilterChanges")({filter:P});else{const S=await J(e,Xt,"getBlockNumber")({});x&&x!==S?O=await J(e,Es,"getContractEvents")({abi:t,address:n,args:r,eventName:a,fromBlock:x+1n,toBlock:S,strict:T}):O=[],x=S}if(O.length===0)return;if(s)R.onLogs(O);else for(const S of O)R.onLogs([S])}catch(O){P&&O instanceof tt&&(v=!1),(D=R.onError)==null||D.call(R,O)}},{emitOnBegin:!0,interval:h});return async()=>{P&&await J(e,Pn,"uninstallFilter")({filter:P}),C()}})})():(()=>{let b=!0,T=()=>b=!1;return(async()=>{try{const R=a?qt({abi:t,eventName:a,args:r}):[],{unsubscribe:x}=await e.transport.subscribe({params:["logs",{address:n,topics:R}],onData(P){var C;if(!b)return;const v=P.result;try{const{eventName:D,args:O}=Yt({abi:t,data:v.data,topics:v.topics,strict:m}),S=Ae(v,{args:O,eventName:D});c([S])}catch(D){let O,S;if(D instanceof et||D instanceof dt){if(m)return;O=D.abiItem.name,S=(C=D.abiItem.inputs)==null?void 0:C.some(q=>!("name"in q&&q.name))}const Y=Ae(v,{args:S?[]:{},eventName:O});c([Y])}},onError(P){o==null||o(P)}});T=x,b||T()}catch(R){o==null||o(R)}})(),T})()}function Ss({chain:e,currentChainId:t}){if(!e)throw new ni;if(t!==e.id)throw new ti({chain:e,currentChainId:t})}function gi(e,{docsPath:t,...n}){const r=(()=>{const s=yr(e,n);return s instanceof wn?e:s})();return new Mo(r,{docsPath:t,...n})}async function zt(e){const t=await e.request({method:"eth_chainId"});return be(t)}async function Pr(e,{serializedTransaction:t}){return e.request({method:"eth_sendRawTransaction",params:[t]})}async function Nr(e,t){var T,R,x,P;const{account:n=e.account,chain:r=e.chain,accessList:s,data:a,gas:o,gasPrice:c,maxFeePerGas:u,maxPriorityFeePerGas:h,nonce:m,to:y,value:w,...N}=t;if(!n)throw new mt({docsPath:"/docs/actions/wallet/sendTransaction"});const b=Ce(n);try{Jt(t);let v;if(r!==null&&(v=await J(e,zt,"getChainId")({}),Ss({currentChainId:v,chain:r})),b.type==="local"){const S=await J(e,vn,"prepareTransactionRequest")({account:b,accessList:s,chain:r,data:a,gas:o,gasPrice:c,maxFeePerGas:u,maxPriorityFeePerGas:h,nonce:m,to:y,value:w,...N});v||(v=await J(e,zt,"getChainId")({}));const Y=(T=r==null?void 0:r.serializers)==null?void 0:T.transaction,q=await b.signTransaction({...S,chainId:v},{serializer:Y});return await J(e,Pr,"sendRawTransaction")({serializedTransaction:q})}const C=(P=(x=(R=e.chain)==null?void 0:R.formatters)==null?void 0:x.transactionRequest)==null?void 0:P.format,O=(C||xn)({...wr(N,{format:C}),accessList:s,data:a,from:b.address,gas:o,gasPrice:c,maxFeePerGas:u,maxPriorityFeePerGas:h,nonce:m,to:y,value:w});return await e.request({method:"eth_sendTransaction",params:[O]})}catch(v){throw gi(v,{...t,account:b,chain:t.chain||void 0})}}async function pi(e,{abi:t,address:n,args:r,dataSuffix:s,functionName:a,...o}){const c=Ye({abi:t,args:r,functionName:a});return await J(e,Nr,"sendTransaction")({data:`${c}${s?s.replace("0x",""):""}`,to:n,...o})}async function bi(e,{chain:t}){const{id:n,name:r,nativeCurrency:s,rpcUrls:a,blockExplorers:o}=t;await e.request({method:"wallet_addEthereumChain",params:[{chainId:X(n),chainName:r,nativeCurrency:s,rpcUrls:a.default.http,blockExplorerUrls:o?Object.values(o).map(({url:c})=>c):void 0}]})}const tr=256;let rn=tr,sn;function yi(e=11){if(!sn||rn+e>tr*2){sn="",rn=0;for(let t=0;t<tr;t++)sn+=(256+Math.random()*256|0).toString(16).substring(1)}return sn.substring(rn,rn+++e)}function As(e){const{batch:t,cacheTime:n=e.pollingInterval??4e3,key:r="base",name:s="Base Client",pollingInterval:a=4e3,type:o="base"}=e,c=e.chain,u=e.account?Ce(e.account):void 0,{config:h,request:m,value:y}=e.transport({chain:c,pollingInterval:a}),w={...h,...y},N={account:u,batch:t,cacheTime:n,chain:c,key:r,name:s,pollingInterval:a,request:m,transport:w,type:o,uid:yi()};function b(T){return R=>{const x=R(T);for(const v in N)delete x[v];const P={...T,...x};return Object.assign(P,{extend:b(P)})}}return Object.assign(N,{extend:b(N)})}function nr(e,{delay:t=100,retryCount:n=2,shouldRetry:r=()=>!0}={}){return new Promise((s,a)=>{const o=async({count:c=0}={})=>{const u=async({error:h})=>{const m=typeof t=="function"?t({count:c,error:h}):t;m&&await er(m),o({count:c+1})};try{const h=await e();s(h)}catch(h){if(c<n&&await r({count:c,error:h}))return u({error:h});a(h)}};o()})}const wi=e=>"code"in e?e.code!==-1&&e.code!==-32004&&e.code!==-32005&&e.code!==-32042&&e.code!==-32603:e instanceof Et&&e.status?e.status!==403&&e.status!==408&&e.status!==413&&e.status!==429&&e.status!==500&&e.status!==502&&e.status!==503&&e.status!==504:!1;function xi(e,{retryDelay:t=150,retryCount:n=3}={}){return async r=>nr(async()=>{try{return await e(r)}catch(s){const a=s;switch(a.code){case Ct.code:throw new Ct(a);case jt.code:throw new jt(a);case St.code:throw new St(a);case At.code:throw new At(a);case ut.code:throw new ut(a);case tt.code:throw new tt(a);case Rt.code:throw new Rt(a);case $t.code:throw new $t(a);case It.code:throw new It(a);case Ot.code:throw new Ot(a);case Mt.code:throw new Mt(a);case Ft.code:throw new Ft(a);case lt.code:throw new lt(a);case kt.code:throw new kt(a);case Bt.code:throw new Bt(a);case Dt.code:throw new Dt(a);case Lt.code:throw new Lt(a);case Gt.code:throw new Gt(a);case 5e3:throw new lt(a);default:throw s instanceof I?s:new Go(a)}}},{delay:({count:s,error:a})=>{var o;if(a&&a instanceof Et){const c=(o=a==null?void 0:a.headers)==null?void 0:o.get("Retry-After");if(c!=null&&c.match(/\d/))return parseInt(c)*1e3}return~~(1<<s)*t},retryCount:n,shouldRetry:({error:s})=>!wi(s)})}function Rs({key:e,name:t,request:n,retryCount:r=3,retryDelay:s=150,timeout:a,type:o},c){return{config:{key:e,name:t,request:n,retryCount:r,retryDelay:s,timeout:a,type:o},request:xi(n,{retryCount:r,retryDelay:s}),value:c}}function vi(e,t={}){const{key:n="custom",name:r="Custom Provider",retryDelay:s}=t;return({retryCount:a})=>Rs({key:n,name:r,request:e.request.bind(e),retryCount:t.retryCount??a,retryDelay:s,type:"custom"})}class Ti extends I{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro"})}}function $s(e,{errorInstance:t=new Error("timed out"),timeout:n,signal:r}){return new Promise((s,a)=>{(async()=>{let o;try{const c=new AbortController;n>0&&(o=setTimeout(()=>{r?c.abort():a(t)},n)),s(await e({signal:c==null?void 0:c.signal}))}catch(c){c.name==="AbortError"&&a(t),a(c)}finally{clearTimeout(o)}})()})}let rr=0;async function Ei(e,{body:t,fetchOptions:n={},timeout:r=1e4}){var c;const{headers:s,method:a,signal:o}=n;try{const u=await $s(async({signal:m})=>await fetch(e,{...n,body:Array.isArray(t)?ve(t.map(w=>({jsonrpc:"2.0",id:w.id??rr++,...w}))):ve({jsonrpc:"2.0",id:t.id??rr++,...t}),headers:{...s,"Content-Type":"application/json"},method:a||"POST",signal:o||(r>0?m:void 0)}),{errorInstance:new zn({body:t,url:e}),timeout:r,signal:!0});let h;if((c=u.headers.get("Content-Type"))!=null&&c.startsWith("application/json")?h=await u.json():h=await u.text(),!u.ok)throw new Et({body:t,details:ve(h.error)||u.statusText,headers:u.headers,status:u.status,url:e});return h}catch(u){throw u instanceof Et||u instanceof zn?u:new Et({body:t,details:u.message,url:e})}}function Pi(e,{body:t,onResponse:n}){if(e.readyState===e.CLOSED||e.readyState===e.CLOSING)throw new Do({body:t,url:e.url,details:"Socket is closed."});const r=rr++,s=({data:a})=>{var c;const o=JSON.parse(a);typeof o.id=="number"&&r!==o.id||(n==null||n(o),t.method==="eth_subscribe"&&typeof o.result=="string"&&e.subscriptions.set(o.result,s),t.method==="eth_unsubscribe"&&e.subscriptions.delete((c=t.params)==null?void 0:c[0]))};return e.requests.set(r,s),e.send(JSON.stringify({jsonrpc:"2.0",...t,id:r})),e}async function Ni(e,{body:t,timeout:n=1e4}){return $s(()=>new Promise(r=>sr.webSocket(e,{body:t,onResponse:r})),{errorInstance:new zn({body:t,url:e.url}),timeout:n})}const sr={http:Ei,webSocket:Pi,webSocketAsync:Ni};function _r(e,t={}){const{batch:n,fetchOptions:r,key:s="http",name:a="HTTP JSON-RPC",retryDelay:o}=t;return({chain:c,retryCount:u,timeout:h})=>{const{batchSize:m=1e3,wait:y=0}=typeof n=="object"?n:{},w=t.retryCount??u,N=h??t.timeout??1e4,b=e||(c==null?void 0:c.rpcUrls.default.http[0]);if(!b)throw new Ti;return Rs({key:s,name:a,async request({method:T,params:R}){const x={method:T,params:R},{schedule:P}=js({id:`${e}`,wait:y,shouldSplitBatch(O){return O.length>m},fn:O=>sr.http(b,{body:O,fetchOptions:r,timeout:N}),sort:(O,S)=>O.id-S.id}),v=async O=>n?P(O):[await sr.http(b,{body:O,fetchOptions:r,timeout:N})],[{error:C,result:D}]=await v(x);if(C)throw new ps({body:x,error:C,url:b});return D},retryCount:w,retryDelay:o,timeout:N,type:"http"},{fetchOptions:r,url:e})}}function Cr(e,t){var r,s,a;if(!(e instanceof I))return!1;const n=e.walk(o=>o instanceof Un);return n instanceof Un?!!(((r=n.data)==null?void 0:r.errorName)==="ResolverNotFound"||((s=n.data)==null?void 0:s.errorName)==="ResolverWildcardNotSupported"||(a=n.reason)!=null&&a.includes("Wildcard on non-extended resolvers is not supported")||t==="reverse"&&n.reason===ls[50]):!1}function Is(e){if(e.length!==66||e.indexOf("[")!==0||e.indexOf("]")!==65)return null;const t=`0x${e.slice(1,65)}`;return Oe(t)?t:null}function an(e){let t=new Uint8Array(32).fill(0);if(!e)return Pt(t);const n=e.split(".");for(let r=n.length-1;r>=0;r-=1){const s=Is(n[r]),a=s?We(s):xe(Be(n[r]),"bytes");t=xe(Le([t,a]),"bytes")}return Pt(t)}function Ci(e){return`[${e.slice(2)}]`}function ji(e){const t=new Uint8Array(32).fill(0);return e?Is(e)||xe(Be(e)):Pt(t)}function Nn(e){const t=e.replace(/^\.|\.$/gm,"");if(t.length===0)return new Uint8Array(1);const n=new Uint8Array(Be(t).byteLength+2);let r=0;const s=t.split(".");for(let a=0;a<s.length;a++){let o=Be(s[a]);o.byteLength>255&&(o=Be(Ci(ji(s[a])))),n[r]=o.length,n.set(o,r+1),r+=o.length+1}return n.byteLength!==r+1?n.slice(0,r+1):n}async function Si(e,{blockNumber:t,blockTag:n,coinType:r,name:s,universalResolverAddress:a}){let o=a;if(!o){if(!e.chain)throw new Error("client chain not configured. universalResolverAddress is required.");o=pt({blockNumber:t,chain:e.chain,contract:"ensUniversalResolver"})}try{const c=Ye({abi:Hr,functionName:"addr",...r!=null?{args:[an(s),BigInt(r)]}:{args:[an(s)]}}),u=await J(e,Ke,"readContract")({address:o,abi:Ns,functionName:"resolve",args:[Ge(Nn(s)),c],blockNumber:t,blockTag:n});if(u[0]==="0x")return null;const h=gt({abi:Hr,args:r!=null?[an(s),BigInt(r)]:void 0,functionName:"addr",data:u[0]});return h==="0x"||it(h)==="0x00"?null:h}catch(c){if(Cr(c,"resolve"))return null;throw c}}class Ai extends I{constructor({data:t}){super("Unable to extract image from metadata. The metadata may be malformed or invalid.",{metaMessages:["- Metadata must be a JSON object with at least an `image`, `image_url` or `image_data` property.","",`Provided data: ${JSON.stringify(t)}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"EnsAvatarInvalidMetadataError"})}}class Tt extends I{constructor({reason:t}){super(`ENS NFT avatar URI is invalid. ${t}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"EnsAvatarInvalidNftUriError"})}}class jr extends I{constructor({uri:t}){super(`Unable to resolve ENS avatar URI "${t}". The URI may be malformed, invalid, or does not respond with a valid image.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"EnsAvatarUriResolutionError"})}}class Ri extends I{constructor({namespace:t}){super(`ENS NFT avatar namespace "${t}" is not supported. Must be "erc721" or "erc1155".`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"EnsAvatarUnsupportedNamespaceError"})}}const $i=/(?<protocol>https?:\/\/[^\/]*|ipfs:\/|ipns:\/|ar:\/)?(?<root>\/)?(?<subpath>ipfs\/|ipns\/)?(?<target>[\w\-.]+)(?<subtarget>\/.*)?/,Ii=/^(Qm[1-9A-HJ-NP-Za-km-z]{44,}|b[A-Za-z2-7]{58,}|B[A-Z2-7]{58,}|z[1-9A-HJ-NP-Za-km-z]{48,}|F[0-9A-F]{50,})(\/(?<target>[\w\-.]+))?(?<subtarget>\/.*)?$/,Oi=/^data:([a-zA-Z\-/+]*);base64,([^"].*)/,Mi=/^data:([a-zA-Z\-/+]*)?(;[a-zA-Z0-9].*?)?(,)/;async function Fi(e){try{const t=await fetch(e,{method:"HEAD"});if(t.status===200){const n=t.headers.get("content-type");return n==null?void 0:n.startsWith("image/")}return!1}catch(t){return typeof t=="object"&&typeof t.response<"u"||!globalThis.hasOwnProperty("Image")?!1:new Promise(n=>{const r=new Image;r.onload=()=>{n(!0)},r.onerror=()=>{n(!1)},r.src=e})}}function qr(e,t){return e?e.endsWith("/")?e.slice(0,-1):e:t}function Os({uri:e,gatewayUrls:t}){const n=Oi.test(e);if(n)return{uri:e,isOnChain:!0,isEncoded:n};const r=qr(t==null?void 0:t.ipfs,"https://ipfs.io"),s=qr(t==null?void 0:t.arweave,"https://arweave.net"),a=e.match($i),{protocol:o,subpath:c,target:u,subtarget:h=""}=(a==null?void 0:a.groups)||{},m=o==="ipns:/"||c==="ipns/",y=o==="ipfs:/"||c==="ipfs/"||Ii.test(e);if(e.startsWith("http")&&!m&&!y){let N=e;return t!=null&&t.arweave&&(N=e.replace(/https:\/\/arweave.net/g,t==null?void 0:t.arweave)),{uri:N,isOnChain:!1,isEncoded:!1}}if((m||y)&&u)return{uri:`${r}/${m?"ipns":"ipfs"}/${u}${h}`,isOnChain:!1,isEncoded:!1};if(o==="ar:/"&&u)return{uri:`${s}/${u}${h||""}`,isOnChain:!1,isEncoded:!1};let w=e.replace(Mi,"");if(w.startsWith("<svg")&&(w=`data:image/svg+xml;base64,${btoa(w)}`),w.startsWith("data:")||w.startsWith("{"))return{uri:w,isOnChain:!0,isEncoded:!1};throw new jr({uri:e})}function Ms(e){if(typeof e!="object"||!("image"in e)&&!("image_url"in e)&&!("image_data"in e))throw new Ai({data:e});return e.image||e.image_url||e.image_data}async function ki({gatewayUrls:e,uri:t}){try{const n=await fetch(t).then(s=>s.json());return await Sr({gatewayUrls:e,uri:Ms(n)})}catch{throw new jr({uri:t})}}async function Sr({gatewayUrls:e,uri:t}){const{uri:n,isOnChain:r}=Os({uri:t,gatewayUrls:e});if(r||await Fi(n))return n;throw new jr({uri:t})}function Bi(e){let t=e;t.startsWith("did:nft:")&&(t=t.replace("did:nft:","").replace(/_/g,"/"));const[n,r,s]=t.split("/"),[a,o]=n.split(":"),[c,u]=r.split(":");if(!a||a.toLowerCase()!=="eip155")throw new Tt({reason:"Only EIP-155 supported"});if(!o)throw new Tt({reason:"Chain ID not found"});if(!u)throw new Tt({reason:"Contract address not found"});if(!s)throw new Tt({reason:"Token ID not found"});if(!c)throw new Tt({reason:"ERC namespace not found"});return{chainID:parseInt(o),namespace:c.toLowerCase(),contractAddress:u,tokenID:s}}async function Di(e,{nft:t}){if(t.namespace==="erc721")return Ke(e,{address:t.contractAddress,abi:[{name:"tokenURI",type:"function",stateMutability:"view",inputs:[{name:"tokenId",type:"uint256"}],outputs:[{name:"",type:"string"}]}],functionName:"tokenURI",args:[BigInt(t.tokenID)]});if(t.namespace==="erc1155")return Ke(e,{address:t.contractAddress,abi:[{name:"uri",type:"function",stateMutability:"view",inputs:[{name:"_id",type:"uint256"}],outputs:[{name:"",type:"string"}]}],functionName:"uri",args:[BigInt(t.tokenID)]});throw new Ri({namespace:t.namespace})}async function Li(e,{gatewayUrls:t,record:n}){return/eip155:/i.test(n)?Gi(e,{gatewayUrls:t,record:n}):Sr({uri:n,gatewayUrls:t})}async function Gi(e,{gatewayUrls:t,record:n}){const r=Bi(n),s=await Di(e,{nft:r}),{uri:a,isOnChain:o,isEncoded:c}=Os({uri:s,gatewayUrls:t});if(o&&(a.includes("data:application/json;base64,")||a.startsWith("{"))){const h=c?atob(a.replace("data:application/json;base64,","")):a,m=JSON.parse(h);return Sr({uri:Ms(m),gatewayUrls:t})}let u=r.tokenID;return r.namespace==="erc1155"&&(u=u.replace("0x","").padStart(64,"0")),ki({gatewayUrls:t,uri:a.replace(/(?:0x)?{id}/,u)})}async function Fs(e,{blockNumber:t,blockTag:n,name:r,key:s,universalResolverAddress:a}){let o=a;if(!o){if(!e.chain)throw new Error("client chain not configured. universalResolverAddress is required.");o=pt({blockNumber:t,chain:e.chain,contract:"ensUniversalResolver"})}try{const c=await J(e,Ke,"readContract")({address:o,abi:Ns,functionName:"resolve",args:[Ge(Nn(r)),Ye({abi:zr,functionName:"text",args:[an(r),s]})],blockNumber:t,blockTag:n});if(c[0]==="0x")return null;const u=gt({abi:zr,functionName:"text",data:c[0]});return u===""?null:u}catch(c){if(Cr(c,"resolve"))return null;throw c}}async function Ui(e,{blockNumber:t,blockTag:n,gatewayUrls:r,name:s,universalResolverAddress:a}){const o=await J(e,Fs,"getEnsText")({blockNumber:t,blockTag:n,key:"avatar",name:s,universalResolverAddress:a});if(!o)return null;try{return await Li(e,{record:o,gatewayUrls:r})}catch{return null}}async function zi(e,{address:t,blockNumber:n,blockTag:r,universalResolverAddress:s}){let a=s;if(!a){if(!e.chain)throw new Error("client chain not configured. universalResolverAddress is required.");a=pt({blockNumber:n,chain:e.chain,contract:"ensUniversalResolver"})}const o=`${t.toLowerCase().substring(2)}.addr.reverse`;try{const[c,u]=await J(e,Ke,"readContract")({address:a,abi:Zo,functionName:"reverse",args:[Ge(Nn(o))],blockNumber:n,blockTag:r});return t.toLowerCase()!==u.toLowerCase()?null:c}catch(c){if(Cr(c,"reverse"))return null;throw c}}async function Hi(e,{blockNumber:t,blockTag:n,name:r,universalResolverAddress:s}){let a=s;if(!a){if(!e.chain)throw new Error("client chain not configured. universalResolverAddress is required.");a=pt({blockNumber:t,chain:e.chain,contract:"ensUniversalResolver"})}const[o]=await J(e,Ke,"readContract")({address:a,abi:[{inputs:[{type:"bytes"}],name:"findResolver",outputs:[{type:"address"},{type:"bytes32"}],stateMutability:"view",type:"function"}],functionName:"findResolver",args:[Ge(Nn(r))],blockNumber:t,blockTag:n});return o}async function Wi(e){const t=bn(e,{method:"eth_newBlockFilter"}),n=await e.request({method:"eth_newBlockFilter"});return{id:n,request:t(n),type:"block"}}async function ks(e,{address:t,args:n,event:r,events:s,fromBlock:a,strict:o,toBlock:c}={}){const u=s??(r?[r]:void 0),h=bn(e,{method:"eth_newFilter"});let m=[];u&&(m=[u.flatMap(w=>qt({abi:[w],eventName:w.name,args:n}))],r&&(m=m[0]));const y=await e.request({method:"eth_newFilter",params:[{address:t,fromBlock:typeof a=="bigint"?X(a):a,toBlock:typeof c=="bigint"?X(c):c,...m.length?{topics:m}:{}}]});return{abi:u,args:n,eventName:r?r.name:void 0,fromBlock:a,id:y,request:h(y),strict:o,toBlock:c,type:"event"}}async function Bs(e){const t=bn(e,{method:"eth_newPendingTransactionFilter"}),n=await e.request({method:"eth_newPendingTransactionFilter"});return{id:n,request:t(n),type:"transaction"}}async function _i(e,{address:t,blockNumber:n,blockTag:r="latest"}){const s=n?X(n):void 0,a=await e.request({method:"eth_getBalance",params:[t,s||r]});return BigInt(a)}async function qi(e,{blockHash:t,blockNumber:n,blockTag:r="latest"}={}){const s=n!==void 0?X(n):void 0;let a;return t?a=await e.request({method:"eth_getBlockTransactionCountByHash",params:[t]}):a=await e.request({method:"eth_getBlockTransactionCountByNumber",params:[s||r]}),be(a)}async function Ki(e,{address:t,blockNumber:n,blockTag:r="latest"}){const s=n!==void 0?X(n):void 0,a=await e.request({method:"eth_getCode",params:[t,s||r]});if(a!=="0x")return a}function Ji(e){var t;return{baseFeePerGas:e.baseFeePerGas.map(n=>BigInt(n)),gasUsedRatio:e.gasUsedRatio,oldestBlock:BigInt(e.oldestBlock),reward:(t=e.reward)==null?void 0:t.map(n=>n.map(r=>BigInt(r)))}}async function Yi(e,{blockCount:t,blockNumber:n,blockTag:r="latest",rewardPercentiles:s}){const a=n?X(n):void 0,o=await e.request({method:"eth_feeHistory",params:[X(t),a||r,s]});return Ji(o)}async function Vi(e,{filter:t}){const n=t.strict??!1;return(await t.request({method:"eth_getFilterLogs",params:[t.id]})).map(s=>{var a;try{const{eventName:o,args:c}="abi"in t&&t.abi?Yt({abi:t.abi,data:s.data,topics:s.topics,strict:n}):{eventName:void 0,args:void 0};return Ae(s,{args:c,eventName:o})}catch(o){let c,u;if(o instanceof et||o instanceof dt){if("strict"in t&&t.strict)return;c=o.abiItem.name,u=(a=o.abiItem.inputs)==null?void 0:a.some(h=>!("name"in h&&h.name))}return Ae(s,{args:u?[]:{},eventName:c})}}).filter(Boolean)}const Xi=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,Zi=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function Qi({domain:e,message:t,primaryType:n,types:r}){const s=typeof e>"u"?{}:e,a={EIP712Domain:Hs({domain:s}),...r};zs({domain:s,message:t,primaryType:n,types:a});const o=["0x1901"];return s&&o.push(ec({domain:s,types:a})),n!=="EIP712Domain"&&o.push(Ds({data:t,primaryType:n,types:a})),xe(Le(o))}function ec({domain:e,types:t}){return Ds({data:e,primaryType:"EIP712Domain",types:t})}function Ds({data:e,primaryType:t,types:n}){const r=Ls({data:e,primaryType:t,types:n});return xe(r)}function Ls({data:e,primaryType:t,types:n}){const r=[{type:"bytes32"}],s=[tc({primaryType:t,types:n})];for(const a of n[t]){const[o,c]=Us({types:n,name:a.name,type:a.type,value:e[a.name]});r.push(o),s.push(c)}return Wt(r,s)}function tc({primaryType:e,types:t}){const n=Ge(nc({primaryType:e,types:t}));return xe(n)}function nc({primaryType:e,types:t}){let n="";const r=Gs({primaryType:e,types:t});r.delete(e);const s=[e,...Array.from(r).sort()];for(const a of s)n+=`${a}(${t[a].map(({name:o,type:c})=>`${c} ${o}`).join(",")})`;return n}function Gs({primaryType:e,types:t},n=new Set){const r=e.match(/^\w*/u),s=r==null?void 0:r[0];if(n.has(s)||t[s]===void 0)return n;n.add(s);for(const a of t[s])Gs({primaryType:a.type,types:t},n);return n}function Us({types:e,name:t,type:n,value:r}){if(e[n]!==void 0)return[{type:"bytes32"},xe(Ls({data:r,primaryType:n,types:e}))];if(n==="bytes")return r=`0x${(r.length%2?"0":"")+r.slice(2)}`,[{type:"bytes32"},xe(r)];if(n==="string")return[{type:"bytes32"},xe(Ge(r))];if(n.lastIndexOf("]")===n.length-1){const s=n.slice(0,n.lastIndexOf("[")),a=r.map(o=>Us({name:t,type:s,types:e,value:o}));return[{type:"bytes32"},xe(Wt(a.map(([o])=>o),a.map(([,o])=>o)))]}return[{type:n},r]}function zs({domain:e,message:t,primaryType:n,types:r}){const s=r,a=(o,c)=>{for(const u of o){const{name:h,type:m}=u,y=m,w=c[h],N=y.match(Zi);if(N&&(typeof w=="number"||typeof w=="bigint")){const[R,x,P]=N;X(w,{signed:x==="int",size:parseInt(P)/8})}if(y==="address"&&typeof w=="string"&&!_e(w))throw new Nt({address:w});const b=y.match(Xi);if(b){const[R,x]=b;if(x&&fe(w)!==parseInt(x))throw new pa({expectedSize:parseInt(x),givenSize:fe(w)})}const T=s[y];T&&a(T,w)}};if(s.EIP712Domain&&e&&a(s.EIP712Domain,e),n!=="EIP712Domain"){const o=s[n];a(o,t)}}function Hs({domain:e}){return[typeof(e==null?void 0:e.name)=="string"&&{name:"name",type:"string"},(e==null?void 0:e.version)&&{name:"version",type:"string"},typeof(e==null?void 0:e.chainId)=="number"&&{name:"chainId",type:"uint256"},(e==null?void 0:e.verifyingContract)&&{name:"verifyingContract",type:"address"},(e==null?void 0:e.salt)&&{name:"salt",type:"bytes32"}].filter(Boolean)}const kn="/docs/contract/encodeDeployData";function Ws({abi:e,args:t,bytecode:n}){if(!t||t.length===0)return n;const r=e.find(a=>"type"in a&&a.type==="constructor");if(!r)throw new ca({docsPath:kn});if(!("inputs"in r))throw new Ir({docsPath:kn});if(!r.inputs||r.inputs.length===0)throw new Ir({docsPath:kn});const s=Wt(r.inputs,t);return dr([n,s])}const rc={"0x0":"reverted","0x1":"success"};function sc(e){return{...e,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,contractAddress:e.contractAddress?e.contractAddress:null,cumulativeGasUsed:e.cumulativeGasUsed?BigInt(e.cumulativeGasUsed):null,effectiveGasPrice:e.effectiveGasPrice?BigInt(e.effectiveGasPrice):null,gasUsed:e.gasUsed?BigInt(e.gasUsed):null,logs:e.logs?e.logs.map(t=>Ae(t)):null,to:e.to?e.to:null,transactionIndex:e.transactionIndex?be(e.transactionIndex):null,status:e.status?rc[e.status]:null,type:e.type?ys[e.type]||e.type:null}}const ac=`Ethereum Signed Message:
`;function oc(e,t){const n=typeof e=="string"?Be(e):e.raw instanceof Uint8Array?e.raw:We(e.raw),r=Be(`${ac}${n.length}`);return xe(Le([r,n]),t)}function ic(e,t){let[n,r="0"]=e.split(".");const s=n.startsWith("-");if(s&&(n=n.slice(1)),r=r.replace(/(0+)$/,""),t===0)Math.round(+`.${r}`)===1&&(n=`${BigInt(n)+1n}`),r="";else if(r.length>t){const[a,o,c]=[r.slice(0,t-1),r.slice(t-1,t),r.slice(t)],u=Math.round(+`${o}.${c}`);u>9?r=`${BigInt(a)+BigInt(1)}0`.padStart(a.length+1,"0"):r=`${a}${u}`,r.length>t&&(r=r.slice(1),n=`${BigInt(n)+1n}`),r=r.slice(0,t)}else r=r.padEnd(t,"0");return BigInt(`${s?"-":""}${n}${r}`)}function ke(e,t="wei"){return ic(e,ds[t])}function cc(e){return e.map(t=>({...t,value:BigInt(t.value)}))}function lc(e){return{...e,balance:e.balance?BigInt(e.balance):void 0,nonce:e.nonce?be(e.nonce):void 0,storageProof:e.storageProof?cc(e.storageProof):void 0}}async function uc(e,{address:t,blockNumber:n,blockTag:r,storageKeys:s}){const a=r??"latest",o=n!==void 0?X(n):void 0,c=await e.request({method:"eth_getProof",params:[t,s,o||a]});return lc(c)}async function dc(e,{address:t,blockNumber:n,blockTag:r="latest",slot:s}){const a=n!==void 0?X(n):void 0;return await e.request({method:"eth_getStorageAt",params:[t,s,a||r]})}async function Ar(e,{blockHash:t,blockNumber:n,blockTag:r,hash:s,index:a}){var m,y,w;const o=r||"latest",c=n!==void 0?X(n):void 0;let u=null;if(s?u=await e.request({method:"eth_getTransactionByHash",params:[s]}):t?u=await e.request({method:"eth_getTransactionByBlockHashAndIndex",params:[t,X(a)]}):u=await e.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[c||o,X(a)]}),!u)throw new hs({blockHash:t,blockNumber:n,blockTag:o,hash:s,index:a});return(((w=(y=(m=e.chain)==null?void 0:m.formatters)==null?void 0:y.transaction)==null?void 0:w.format)||ws)(u)}async function fc(e,{hash:t,transactionReceipt:n}){const[r,s]=await Promise.all([J(e,Xt,"getBlockNumber")({}),t?J(e,Ar,"getBlockNumber")({hash:t}):void 0]),a=(n==null?void 0:n.blockNumber)||(s==null?void 0:s.blockNumber);return a?r-a+1n:0n}async function ar(e,{hash:t}){var s,a,o;const n=await e.request({method:"eth_getTransactionReceipt",params:[t]});if(!n)throw new ms({hash:t});return(((o=(a=(s=e.chain)==null?void 0:s.formatters)==null?void 0:a.transactionReceipt)==null?void 0:o.format)||sc)(n)}async function hc(e,t){var T;const{allowFailure:n=!0,batchSize:r,blockNumber:s,blockTag:a,contracts:o,multicallAddress:c}=t,u=r??(typeof((T=e.batch)==null?void 0:T.multicall)=="object"&&e.batch.multicall.batchSize||1024);let h=c;if(!h){if(!e.chain)throw new Error("client chain not configured. multicallAddress is required.");h=pt({blockNumber:s,chain:e.chain,contract:"multicall3"})}const m=[[]];let y=0,w=0;for(let R=0;R<o.length;R++){const{abi:x,address:P,args:v,functionName:C}=o[R];try{const D=Ye({abi:x,args:v,functionName:C});w+=(D.length-2)/2,u>0&&w>u&&m[y].length>0&&(y++,w=(D.length-2)/2,m[y]=[]),m[y]=[...m[y],{allowFailure:!0,callData:D,target:P}]}catch(D){const O=Ut(D,{abi:x,address:P,args:v,docsPath:"/docs/contract/multicall",functionName:C});if(!n)throw O;m[y]=[...m[y],{allowFailure:!0,callData:"0x",target:P}]}}const N=await Promise.allSettled(m.map(R=>J(e,Ke,"readContract")({abi:Zn,address:h,args:[R],blockNumber:s,blockTag:a,functionName:"aggregate3"}))),b=[];for(let R=0;R<N.length;R++){const x=N[R];if(x.status==="rejected"){if(!n)throw x.reason;for(let v=0;v<m[R].length;v++)b.push({status:"failure",error:x.reason,result:void 0});continue}const P=x.value;for(let v=0;v<P.length;v++){const{returnData:C,success:D}=P[v],{callData:O}=m[R][v],{abi:S,address:Y,functionName:q,args:Q}=o[b.length];try{if(O==="0x")throw new mn;if(!D)throw new br({data:C});const _=gt({abi:S,args:Q,data:C,functionName:q});b.push(n?{result:_,status:"success"}:_)}catch(_){const ae=Ut(_,{abi:S,address:Y,args:Q,docsPath:"/docs/contract/multicall",functionName:q});if(!n)throw ae;b.push({error:ae,result:void 0,status:"failure"})}}}if(b.length!==o.length)throw new I("multicall results mismatch");return b}const mc="0x60806040523480156200001157600080fd5b50604051620007003803806200070083398101604081905262000034916200056f565b6000620000438484846200004f565b9050806000526001601ff35b600080846001600160a01b0316803b806020016040519081016040528181526000908060200190933c90507f6492649264926492649264926492649264926492649264926492649264926492620000a68462000451565b036200021f57600060608085806020019051810190620000c79190620005ce565b8651929550909350915060000362000192576000836001600160a01b031683604051620000f5919062000643565b6000604051808303816000865af19150503d806000811462000134576040519150601f19603f3d011682016040523d82523d6000602084013e62000139565b606091505b5050905080620001905760405162461bcd60e51b815260206004820152601e60248201527f5369676e617475726556616c696461746f723a206465706c6f796d656e74000060448201526064015b60405180910390fd5b505b604051630b135d3f60e11b808252906001600160a01b038a1690631626ba7e90620001c4908b90869060040162000661565b602060405180830381865afa158015620001e2573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200020891906200069d565b6001600160e01b031916149450505050506200044a565b805115620002b157604051630b135d3f60e11b808252906001600160a01b03871690631626ba7e9062000259908890889060040162000661565b602060405180830381865afa15801562000277573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200029d91906200069d565b6001600160e01b031916149150506200044a565b8251604114620003195760405162461bcd60e51b815260206004820152603a6024820152600080516020620006e083398151915260448201527f3a20696e76616c6964207369676e6174757265206c656e677468000000000000606482015260840162000187565b620003236200046b565b506020830151604080850151855186939260009185919081106200034b576200034b620006c9565b016020015160f81c9050601b81148015906200036b57508060ff16601c14155b15620003cf5760405162461bcd60e51b815260206004820152603b6024820152600080516020620006e083398151915260448201527f3a20696e76616c6964207369676e617475726520762076616c75650000000000606482015260840162000187565b6040805160008152602081018083528a905260ff83169181019190915260608101849052608081018390526001600160a01b038a169060019060a0016020604051602081039080840390855afa1580156200042e573d6000803e3d6000fd5b505050602060405103516001600160a01b031614955050505050505b9392505050565b60006020825110156200046357600080fd5b508051015190565b60405180606001604052806003906020820280368337509192915050565b6001600160a01b03811681146200049f57600080fd5b50565b634e487b7160e01b600052604160045260246000fd5b60005b83811015620004d5578181015183820152602001620004bb565b50506000910152565b600082601f830112620004f057600080fd5b81516001600160401b03808211156200050d576200050d620004a2565b604051601f8301601f19908116603f01168101908282118183101715620005385762000538620004a2565b816040528381528660208588010111156200055257600080fd5b62000565846020830160208901620004b8565b9695505050505050565b6000806000606084860312156200058557600080fd5b8351620005928162000489565b6020850151604086015191945092506001600160401b03811115620005b657600080fd5b620005c486828701620004de565b9150509250925092565b600080600060608486031215620005e457600080fd5b8351620005f18162000489565b60208501519093506001600160401b03808211156200060f57600080fd5b6200061d87838801620004de565b935060408601519150808211156200063457600080fd5b50620005c486828701620004de565b6000825162000657818460208701620004b8565b9190910192915050565b828152604060208201526000825180604084015262000688816060850160208701620004b8565b601f01601f1916919091016060019392505050565b600060208284031215620006b057600080fd5b81516001600160e01b0319811681146200044a57600080fd5b634e487b7160e01b600052603260045260246000fdfe5369676e617475726556616c696461746f72237265636f7665725369676e6572";/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */BigInt(0);BigInt(1);BigInt(2);function gc(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function pc(e,t){const n=Oe(e)?We(e):e,r=Oe(t)?We(t):t;return gc(n,r)}async function _s(e,{address:t,hash:n,signature:r,...s}){const a=Oe(r)?r:Ge(r);try{const{data:o}=await J(e,Tn,"call")({data:Ws({abi:Qo,args:[t,n,a],bytecode:mc}),...s});return pc(o??"0x0","0x1")}catch(o){if(o instanceof gs)return!1;throw o}}async function bc(e,{address:t,message:n,signature:r,...s}){const a=oc(n);return _s(e,{address:t,hash:a,signature:r,...s})}async function yc(e,{address:t,signature:n,message:r,primaryType:s,types:a,domain:o,...c}){const u=Qi({message:r,primaryType:s,types:a,domain:o});return _s(e,{address:t,hash:u,signature:n,...c})}function qs(e,{emitOnBegin:t=!1,emitMissed:n=!1,onBlockNumber:r,onError:s,poll:a,pollingInterval:o=e.pollingInterval}){const c=typeof a<"u"?a:e.transport.type!=="webSocket";let u;return c?(()=>{const y=ve(["watchBlockNumber",e.uid,t,n,o]);return bt(y,{onBlockNumber:r,onError:s},w=>Vt(async()=>{var N;try{const b=await J(e,Xt,"getBlockNumber")({cacheTime:0});if(u){if(b===u)return;if(b-u>1&&n)for(let T=u+1n;T<b;T++)w.onBlockNumber(T,u),u=T}(!u||b>u)&&(w.onBlockNumber(b,u),u=b)}catch(b){(N=w.onError)==null||N.call(w,b)}},{emitOnBegin:t,interval:o}))})():(()=>{let y=!0,w=()=>y=!1;return(async()=>{try{const{unsubscribe:N}=await e.transport.subscribe({params:["newHeads"],onData(b){var R;if(!y)return;const T=gn((R=b.result)==null?void 0:R.number);r(T,u),u=T},onError(b){s==null||s(b)}});w=N,y||w()}catch(N){s==null||s(N)}})(),w})()}async function wc(e,{confirmations:t=1,hash:n,onReplaced:r,pollingInterval:s=e.pollingInterval,timeout:a}){const o=ve(["waitForTransactionReceipt",e.uid,n]);let c,u,h,m=!1;return new Promise((y,w)=>{a&&setTimeout(()=>w(new Fo({hash:n})),a);const N=bt(o,{onReplaced:r,resolve:y,reject:w},b=>{const T=J(e,qs,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:s,async onBlockNumber(R){if(m)return;let x=R;const P=v=>{T(),v(),N()};try{if(h){if(t>1&&(!h.blockNumber||x-h.blockNumber+1n<t))return;P(()=>b.resolve(h));return}if(c||(m=!0,await nr(async()=>{c=await J(e,Ar,"getTransaction")({hash:n}),c.blockNumber&&(x=c.blockNumber)},{delay:({count:v})=>~~(1<<v)*200,retryCount:6}),m=!1),h=await J(e,ar,"getTransactionReceipt")({hash:n}),t>1&&(!h.blockNumber||x-h.blockNumber+1n<t))return;P(()=>b.resolve(h))}catch(v){if(c&&(v instanceof hs||v instanceof ms))try{u=c,m=!0;const C=await nr(()=>J(e,qe,"getBlock")({blockNumber:x,includeTransactions:!0}),{delay:({count:S})=>~~(1<<S)*200,retryCount:6,shouldRetry:({error:S})=>S instanceof bs});m=!1;const D=C.transactions.find(({from:S,nonce:Y})=>S===u.from&&Y===u.nonce);if(!D||(h=await J(e,ar,"getTransactionReceipt")({hash:D.hash}),t>1&&(!h.blockNumber||x-h.blockNumber+1n<t)))return;let O="replaced";D.to===u.to&&D.value===u.value?O="repriced":D.from===D.to&&D.value===0n&&(O="cancelled"),P(()=>{var S;(S=b.onReplaced)==null||S.call(b,{reason:O,replacedTransaction:u,transaction:D,transactionReceipt:h}),b.resolve(h)})}catch(C){P(()=>b.reject(C))}else P(()=>b.reject(v))}}})})})}function xc(e,{blockTag:t="latest",emitMissed:n=!1,emitOnBegin:r=!1,onBlock:s,onError:a,includeTransactions:o,poll:c,pollingInterval:u=e.pollingInterval}){const h=typeof c<"u"?c:e.transport.type!=="webSocket",m=o??!1;let y;return h?(()=>{const b=ve(["watchBlocks",e.uid,n,r,m,u]);return bt(b,{onBlock:s,onError:a},T=>Vt(async()=>{var R;try{const x=await J(e,qe,"getBlock")({blockTag:t,includeTransactions:m});if(x.number&&(y!=null&&y.number)){if(x.number===y.number)return;if(x.number-y.number>1&&n)for(let P=(y==null?void 0:y.number)+1n;P<x.number;P++){const v=await J(e,qe,"getBlock")({blockNumber:P,includeTransactions:m});T.onBlock(v,y),y=v}}(!(y!=null&&y.number)||t==="pending"&&!(x!=null&&x.number)||x.number&&x.number>y.number)&&(T.onBlock(x,y),y=x)}catch(x){(R=T.onError)==null||R.call(T,x)}},{emitOnBegin:r,interval:u}))})():(()=>{let b=!0,T=()=>b=!1;return(async()=>{try{const{unsubscribe:R}=await e.transport.subscribe({params:["newHeads"],onData(x){var C,D,O;if(!b)return;const v=(((O=(D=(C=e.chain)==null?void 0:C.formatters)==null?void 0:D.block)==null?void 0:O.format)||xs)(x.result);s(v,y),y=v},onError(x){a==null||a(x)}});T=R,b||T()}catch(R){a==null||a(R)}})(),T})()}function vc(e,{address:t,args:n,batch:r=!0,event:s,events:a,onError:o,onLogs:c,poll:u,pollingInterval:h=e.pollingInterval,strict:m}){const y=typeof u<"u"?u:e.transport.type!=="webSocket",w=m??!1;return y?(()=>{const T=ve(["watchEvent",t,n,r,e.uid,s,h]);return bt(T,{onLogs:c,onError:o},R=>{let x,P,v=!1;const C=Vt(async()=>{var D;if(!v){try{P=await J(e,ks,"createEventFilter")({address:t,args:n,event:s,events:a,strict:w})}catch{}v=!0;return}try{let O;if(P)O=await J(e,En,"getFilterChanges")({filter:P});else{const S=await J(e,Xt,"getBlockNumber")({});x&&x!==S?O=await J(e,Er,"getLogs")({address:t,args:n,event:s,events:a,fromBlock:x+1n,toBlock:S}):O=[],x=S}if(O.length===0)return;if(r)R.onLogs(O);else for(const S of O)R.onLogs([S])}catch(O){P&&O instanceof tt&&(v=!1),(D=R.onError)==null||D.call(R,O)}},{emitOnBegin:!0,interval:h});return async()=>{P&&await J(e,Pn,"uninstallFilter")({filter:P}),C()}})})():(()=>{let T=!0,R=()=>T=!1;return(async()=>{try{const x=a??(s?[s]:void 0);let P=[];x&&(P=[x.flatMap(C=>qt({abi:[C],eventName:C.name,args:n}))],s&&(P=P[0]));const{unsubscribe:v}=await e.transport.subscribe({params:["logs",{address:t,topics:P}],onData(C){var O;if(!T)return;const D=C.result;try{const{eventName:S,args:Y}=Yt({abi:x,data:D.data,topics:D.topics,strict:w}),q=Ae(D,{args:Y,eventName:S});c([q])}catch(S){let Y,q;if(S instanceof et||S instanceof dt){if(m)return;Y=S.abiItem.name,q=(O=S.abiItem.inputs)==null?void 0:O.some(_=>!("name"in _&&_.name))}const Q=Ae(D,{args:q?[]:{},eventName:Y});c([Q])}},onError(C){o==null||o(C)}});R=v,T||R()}catch(x){o==null||o(x)}})(),R})()}function Tc(e,{batch:t=!0,onError:n,onTransactions:r,poll:s,pollingInterval:a=e.pollingInterval}){return(typeof s<"u"?s:e.transport.type!=="webSocket")?(()=>{const h=ve(["watchPendingTransactions",e.uid,t,a]);return bt(h,{onTransactions:r,onError:n},m=>{let y;const w=Vt(async()=>{var N;try{if(!y)try{y=await J(e,Bs,"createPendingTransactionFilter")({});return}catch(T){throw w(),T}const b=await J(e,En,"getFilterChanges")({filter:y});if(b.length===0)return;if(t)m.onTransactions(b);else for(const T of b)m.onTransactions([T])}catch(b){(N=m.onError)==null||N.call(m,b)}},{emitOnBegin:!0,interval:a});return async()=>{y&&await J(e,Pn,"uninstallFilter")({filter:y}),w()}})})():(()=>{let h=!0,m=()=>h=!1;return(async()=>{try{const{unsubscribe:y}=await e.transport.subscribe({params:["newPendingTransactions"],onData(w){if(!h)return;const N=w.result;r([N])},onError(w){n==null||n(w)}});m=y,h||m()}catch(y){n==null||n(y)}})(),m})()}function Ec(e){return{call:t=>Tn(e,t),createBlockFilter:()=>Wi(e),createContractEventFilter:t=>cs(e,t),createEventFilter:t=>ks(e,t),createPendingTransactionFilter:()=>Bs(e),estimateContractGas:t=>Vo(e,t),estimateGas:t=>Tr(e,t),getBalance:t=>_i(e,t),getBlock:t=>qe(e,t),getBlockNumber:t=>Xt(e,t),getBlockTransactionCount:t=>qi(e,t),getBytecode:t=>Ki(e,t),getChainId:()=>zt(e),getContractEvents:t=>Es(e,t),getEnsAddress:t=>Si(e,t),getEnsAvatar:t=>Ui(e,t),getEnsName:t=>zi(e,t),getEnsResolver:t=>Hi(e,t),getEnsText:t=>Fs(e,t),getFeeHistory:t=>Yi(e,t),estimateFeesPerGas:t=>Jo(e,t),getFilterChanges:t=>En(e,t),getFilterLogs:t=>Vi(e,t),getGasPrice:()=>vr(e),getLogs:t=>Er(e,t),getProof:t=>uc(e,t),estimateMaxPriorityFeePerGas:t=>Ko(e,t),getStorageAt:t=>dc(e,t),getTransaction:t=>Ar(e,t),getTransactionConfirmations:t=>fc(e,t),getTransactionCount:t=>Ts(e,t),getTransactionReceipt:t=>ar(e,t),multicall:t=>hc(e,t),prepareTransactionRequest:t=>vn(e,t),readContract:t=>Ke(e,t),sendRawTransaction:t=>Pr(e,t),simulateContract:t=>ii(e,t),verifyMessage:t=>bc(e,t),verifyTypedData:t=>yc(e,t),uninstallFilter:t=>Pn(e,t),waitForTransactionReceipt:t=>wc(e,t),watchBlocks:t=>xc(e,t),watchBlockNumber:t=>qs(e,t),watchContractEvent:t=>mi(e,t),watchEvent:t=>vc(e,t),watchPendingTransactions:t=>Tc(e,t)}}function Pc(e){const{key:t="public",name:n="Public Client"}=e;return As({...e,key:t,name:n,type:"publicClient"}).extend(Ec)}function Nc(e,{abi:t,args:n,bytecode:r,...s}){const a=Ws({abi:t,args:n,bytecode:r});return Nr(e,{...s,data:a})}async function Cc(e){var n;return((n=e.account)==null?void 0:n.type)==="local"?[e.account.address]:(await e.request({method:"eth_accounts"})).map(r=>gr(r))}async function jc(e){return await e.request({method:"wallet_getPermissions"})}async function Sc(e){return(await e.request({method:"eth_requestAccounts"})).map(n=>vo(n))}async function Ac(e,t){return e.request({method:"wallet_requestPermissions",params:[t]})}async function Rc(e,{account:t=e.account,message:n}){if(!t)throw new mt({docsPath:"/docs/actions/wallet/signMessage"});const r=Ce(t);if(r.type==="local")return r.signMessage({message:n});const s=typeof n=="string"?ir(n):n.raw instanceof Uint8Array?Ge(n.raw):n.raw;return e.request({method:"personal_sign",params:[s,r.address]})}async function $c(e,t){var h,m,y,w;const{account:n=e.account,chain:r=e.chain,...s}=t;if(!n)throw new mt({docsPath:"/docs/actions/wallet/signTransaction"});const a=Ce(n);Jt({account:a,...t});const o=await J(e,zt,"getChainId")({});r!==null&&Ss({currentChainId:o,chain:r});const c=(r==null?void 0:r.formatters)||((h=e.chain)==null?void 0:h.formatters),u=((m=c==null?void 0:c.transactionRequest)==null?void 0:m.format)||xn;return a.type==="local"?a.signTransaction({...s,chainId:o},{serializer:(w=(y=e.chain)==null?void 0:y.serializers)==null?void 0:w.transaction}):await e.request({method:"eth_signTransaction",params:[{...u(s),chainId:X(o),from:a.address}]})}async function Ic(e,{account:t=e.account,domain:n,message:r,primaryType:s,types:a}){if(!t)throw new mt({docsPath:"/docs/actions/wallet/signTypedData"});const o=Ce(t),c={EIP712Domain:Hs({domain:n}),...a};if(zs({domain:n,message:r,primaryType:s,types:c}),o.type==="local")return o.signTypedData({domain:n,primaryType:s,types:c,message:r});const u=ve({domain:n??{},primaryType:s,types:c,message:r},(h,m)=>Oe(m)?m.toLowerCase():m);return e.request({method:"eth_signTypedData_v4",params:[o.address,u]})}async function Oc(e,{id:t}){await e.request({method:"wallet_switchEthereumChain",params:[{chainId:X(t)}]})}async function Mc(e,t){return await e.request({method:"wallet_watchAsset",params:t})}function Fc(e){return{addChain:t=>bi(e,t),deployContract:t=>Nc(e,t),getAddresses:()=>Cc(e),getChainId:()=>zt(e),getPermissions:()=>jc(e),prepareTransactionRequest:t=>vn(e,t),requestAddresses:()=>Sc(e),requestPermissions:t=>Ac(e,t),sendRawTransaction:t=>Pr(e,t),sendTransaction:t=>Nr(e,t),signMessage:t=>Rc(e,t),signTransaction:t=>$c(e,t),signTypedData:t=>Ic(e,t),switchChain:t=>Oc(e,t),watchAsset:t=>Mc(e,t),writeContract:t=>pi(e,t)}}function Kr(e){const{key:t="wallet",name:n="Wallet Client",transport:r}=e;return As({...e,key:t,name:n,transport:a=>r({...a,retryCount:0}),type:"walletClient"}).extend(Fc)}const Ie={6342:{name:"MegaETH Testnet",rpcUrl:"https://carrot.megaeth.com/rpc",fallbackRpcUrls:["https://carrot.megaeth.com/rpc"],wsUrl:"wss://carrot.megaeth.com/ws",contractAddress:"0xb34cac1135c27ec810e7e6880325085783c1a7e0",faucetAddress:"0x76b71a17d82232fd29aca475d14ed596c67c4b85",chainId:6342,sendMethod:"realtime_sendRawTransaction",connectionTimeouts:{initial:1e4,retry:3e3,request:5e3},maxConnections:3},31337:{name:"Foundry Local",rpcUrl:"http://127.0.0.1:8545",fallbackRpcUrls:["http://127.0.0.1:8545"],contractAddress:"0xb34cac1135c27ec810e7e6880325085783c1a7e0",faucetAddress:"0x76b71a17d82232fd29aca475d14ed596c67c4b85",chainId:31337,sendMethod:"eth_sendRawTransaction",connectionTimeouts:{initial:1e4,retry:5e3,request:15e3},maxConnections:2},50311:{name:"Somnia Testnet",rpcUrl:"https://testnet.somnia.network",fallbackRpcUrls:["https://testnet.somnia.network"],contractAddress:"0xb34cac1135c27ec810e7e6880325085783c1a7e0",faucetAddress:"0x76b71a17d82232fd29aca475d14ed596c67c4b85",chainId:50311,sendMethod:"eth_sendRawTransaction",connectionTimeouts:{initial:2e4,retry:1e4,request:3e4},maxConnections:2},1313161556:{name:"RISE Testnet",rpcUrl:"https://testnet-rpc.rise.com",fallbackRpcUrls:["https://testnet-rpc.rise.com"],contractAddress:"0xb34cac1135c27ec810e7e6880325085783c1a7e0",faucetAddress:"0x76b71a17d82232fd29aca475d14ed596c67c4b85",chainId:1313161556,sendMethod:"eth_sendRawTransactionSync",connectionTimeouts:{initial:2e4,retry:1e4,request:3e4},maxConnections:2}},kc=[{inputs:[],name:"update",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"number",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],Bn=e=>{try{if(typeof e=="string"){const t=e.replace(/^cadesplugin_loaded/,"").replace(/^EnableInte.*?$/,"").trim();return t.length===0?null:JSON.parse(t)}return e}catch(t){return console.warn("Failed to parse JSON response:",t.message,"Data:",e),null}},Ks=()=>{const{authenticated:e,user:t}=nt(),{wallets:n}=Ht(),[r,s]=M.useState(!1),[a,o]=M.useState(!1),[c,u]=M.useState("0"),[h,m]=M.useState(0),y=M.useRef({}),w=M.useRef({}),N="megaBuddies_globalCache",b={gasParams:5*60*1e3,chainParams:30*1e3,rpcHealth:2*60*1e3,clients:10*60*1e3,nonce:30*1e3},T=()=>{try{const d={gasParams:{data:(f=>JSON.parse(JSON.stringify(f,(g,p)=>typeof p=="bigint"?p.toString()+"n":p)))(w.current),timestamp:Date.now()},chainParams:{data:Q.current,timestamp:Date.now()},rpcHealth:{data:x.current,timestamp:Date.now()},nonceCache:{data:C.current,timestamp:Date.now()}};localStorage.setItem(N,JSON.stringify(d))}catch(i){console.warn("Failed to save global cache:",i)}},R=()=>{try{const i=localStorage.getItem(N);if(i){const d=JSON.parse(i),f=Date.now(),g=p=>{if(typeof p=="string"&&p.endsWith("n"))return BigInt(p.slice(0,-1));if(typeof p=="object"&&p!==null){const E=Array.isArray(p)?[]:{};for(const[j,G]of Object.entries(p))E[j]=g(G);return E}return p};d.gasParams&&f-d.gasParams.timestamp<b.gasParams&&(w.current=g(d.gasParams.data),console.log("🎯 Loaded cached gas parameters from storage")),d.chainParams&&f-d.chainParams.timestamp<b.chainParams&&(Q.current=d.chainParams.data,console.log("🎯 Loaded cached chain parameters from storage")),d.rpcHealth&&f-d.rpcHealth.timestamp<b.rpcHealth&&(x.current=d.rpcHealth.data,console.log("🎯 Loaded cached RPC health from storage")),d.nonceCache&&f-d.nonceCache.timestamp<b.nonce&&(Object.entries(d.nonceCache.data).forEach(([p,E])=>{E&&typeof E.currentNonce=="number"&&(C.current[p]={...E,isUpdating:!1,lastUpdate:E.lastUpdate||0})}),console.log("🎯 Loaded cached nonce data from storage"))}}catch(i){console.warn("Failed to load global cache:",i)}};M.useEffect(()=>{R();const i=setInterval(T,3e4),d=()=>T();window.addEventListener("beforeunload",d);const f=setInterval(()=>{Object.keys(V.current).forEach(g=>{const p=V.current[g];p&&p.state==="OPEN"&&Date.now()-p.lastFailureTime>p.timeout&&(p.state="HALF_OPEN",p.failures=0,console.log(`🔄 Auto-reset circuit breaker for chain ${g} - trying again`))})},1e4);return()=>{clearInterval(i),clearInterval(f),window.removeEventListener("beforeunload",d),T()}},[]),M.useRef({});const x=M.useRef({}),P=M.useRef({}),v=M.useRef({}),C=M.useRef({}),D=M.useRef({}),O=M.useRef(0),S=M.useRef({}),Y=i=>(S.current[i]||(S.current[i]={recentTransactions:[],averageBlockchainTime:0,successRate:0,totalTransactions:0,successfulTransactions:0,lastUpdate:Date.now()}),S.current[i]),q=(i,d,f)=>{const g=Y(i);g.recentTransactions.push({blockchainTime:d,success:f,timestamp:Date.now()}),g.recentTransactions.length>50&&g.recentTransactions.shift(),g.totalTransactions++,f&&g.successfulTransactions++;const p=g.recentTransactions.filter(E=>E.success);return p.length>0&&(g.averageBlockchainTime=p.reduce((E,j)=>E+j.blockchainTime,0)/p.length),g.successRate=g.successfulTransactions/g.totalTransactions*100,g.lastUpdate=Date.now(),g},Q=M.useRef({}),_={6342:{poolSize:300,refillAt:.1,batchSize:100,maxRetries:3,retryDelay:200,burstMode:!0,maxBurstSize:15,burstCooldown:100},31337:{poolSize:120,refillAt:.2,batchSize:30,maxRetries:3,retryDelay:150,burstMode:!0,maxBurstSize:8,burstCooldown:200},50311:{poolSize:100,refillAt:.2,batchSize:25,maxRetries:3,retryDelay:300,burstMode:!0,maxBurstSize:6,burstCooldown:400},1313161556:{poolSize:50,refillAt:.4,batchSize:12,maxRetries:2,retryDelay:400,burstMode:!1,maxBurstSize:2,burstCooldown:1500},default:{poolSize:60,refillAt:.3,batchSize:15,maxRetries:3,retryDelay:300,burstMode:!1,maxBurstSize:2,burstCooldown:1e3}},ae={reducedBatchSize:1,increasedDelay:1e3,degradedMode:!1},je=M.useRef({6342:{...ae}}),me=M.useRef({}),Ue=i=>(me.current[i]||(me.current[i]={lastBurstTime:0,burstCount:0,inCooldown:!1,pendingTransactions:[],processingBurst:!1}),me.current[i]),rt=i=>{const d=_[i]||_.default;if(!d.burstMode)return!1;const f=Ue(i),g=Date.now();return f.inCooldown&&g-f.lastBurstTime<d.burstCooldown?!1:(f.inCooldown&&g-f.lastBurstTime>=d.burstCooldown&&(f.inCooldown=!1,f.burstCount=0),f.burstCount<d.maxBurstSize)},Ve=(i,d)=>{const f=_[i]||_.default;if(!f.burstMode)return;const g=Ue(i),p=Date.now();d&&(g.burstCount++,g.lastBurstTime=p,g.burstCount>=f.maxBurstSize&&(g.inCooldown=!0,console.log(`Burst mode short cooldown activated for chain ${i} (${f.burstCooldown}ms) - optimized for long sessions`)))},Cn=async(i,d)=>{const f=Ue(i);return new Promise((g,p)=>{f.pendingTransactions.push({fn:d,resolve:g,reject:p,timestamp:Date.now()}),f.processingBurst||jn(i)})},jn=async i=>{const d=Ue(i);for(d.processingBurst=!0;d.pendingTransactions.length>0;){if(!rt(i)){const p=_[i]||_.default,E=Math.max(100,p.burstCooldown/10);await new Promise(j=>setTimeout(j,E));continue}const g=d.pendingTransactions.shift();if(!g)break;try{const p=await g.fn();Ve(i,!0),g.resolve(p)}catch(p){Ve(i,!1),g.reject(p)}}d.processingBurst=!1},Zt=i=>{const d=Ie[i];d&&(x.current[i]||(x.current[i]={endpoints:d.fallbackRpcUrls.map(f=>({url:f,healthy:!0,lastChecked:0,consecutiveFailures:0,responseTime:0})),currentEndpointIndex:0,lastHealthCheck:0}))},Qt=async i=>{const d=x.current[i];if(!d)return Zt(i),Ie[i].rpcUrl;for(let f=0;f<d.endpoints.length;f++){const g=d.endpoints[d.currentEndpointIndex];if(g.healthy||g.consecutiveFailures<3)return g.url;d.currentEndpointIndex=(d.currentEndpointIndex+1)%d.endpoints.length}return console.warn(`All RPC endpoints for chain ${i} appear unhealthy, using primary`),d.endpoints[0].url},Sn=(i,d,f,g=0)=>{const p=x.current[i];if(!p)return;const E=p.endpoints.find(j=>j.url===d);E&&(E.lastChecked=Date.now(),E.responseTime=g,f?(E.healthy=!0,E.consecutiveFailures=0):(E.consecutiveFailures++,E.consecutiveFailures>=3&&(E.healthy=!1,console.warn(`Marking RPC endpoint as unhealthy: ${d} (${E.consecutiveFailures} failures)`))))},An=(i,d)=>{const f=`${i}-${d}`,g=Ie[i];if(P.current[f]||(P.current[f]=0),P.current[f]>=g.maxConnections)throw new Error(`Maximum connections (${g.maxConnections}) reached for ${f}`);return P.current[f]++,()=>{P.current[f]>0&&P.current[f]--}},yt=i=>{const d=je.current[i];d&&(d.degradedMode=!0,console.log(`Enabled fallback mode for chain ${i}`))},en=i=>{const d=je.current[i];return d!=null&&d.degradedMode?d:null},ne=()=>{if(!e||!n.length)return console.log("🔍 getEmbeddedWallet: Not authenticated or no wallets available"),null;const i=n.find(d=>d.walletClientType==="privy"||d.connectorType==="embedded"||d.connectorType==="privy"||d.type==="embedded"||d.walletClientType==="embedded"||d.walletIndex===0);return i?(console.log("✅ Found embedded wallet:",{address:i.address,walletClientType:i.walletClientType,connectorType:i.connectorType,type:i.type,walletIndex:i.walletIndex}),i):(console.log("⚠️ No embedded wallet found, available wallets:",n.length),console.log("⚠️ This might cause faucet to send to wrong wallet!"),null)},Xe=async()=>{if(!e||!t)return console.log("🔍 ensureEmbeddedWallet: Not authenticated or no user"),null;const i=ne();if(i&&(i.walletClientType==="privy"||i.connectorType==="embedded"||i.type==="embedded"||i.walletClientType==="embedded"||i.walletIndex===0))return console.log("✅ Embedded wallet already exists:",i.address),i;console.log("🔄 Attempting to create embedded wallet...");try{await new Promise(f=>setTimeout(f,1e3));const d=ne();if(d)return console.log("✅ Found embedded wallet after waiting:",d.address),d;if(window.privy&&window.privy.createWallet){console.log("🔄 Attempting to create wallet via Privy...");const f=await window.privy.createWallet();console.log("✅ Created new embedded wallet via Privy:",f),await new Promise(p=>setTimeout(p,2e3));const g=ne();return g?(console.log("✅ Embedded wallet successfully registered:",g.address),g):(console.log("⚠️ Wallet created but not found in wallets list"),f)}return console.log("⚠️ Privy createWallet not available"),null}catch(d){return console.error("❌ Failed to create embedded wallet:",d),console.error("Error details:",{message:d.message,stack:d.stack,privyAvailable:!!window.privy,createWalletAvailable:!!(window.privy&&window.privy.createWallet)}),null}},pe=async i=>{const d=`${i}`;if(y.current[d])return y.current[d];const f=Ie[i];if(!f)throw new Error(`Unsupported network: ${i}`);let g=ne();if(!g&&(console.log("🔄 No embedded wallet found, attempting to ensure one exists..."),g=await Xe(),!g))throw new Error("No embedded wallet found and could not create one");Zt(i);try{const p=await Qt(i);console.log(`Using RPC endpoint for chain ${i}: ${p}`);const E=An(i,p),j=Pc({chain:{id:i,name:f.name,network:f.name.toLowerCase().replace(/\s+/g,"-"),nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:[p]},public:{http:[p]}}},transport:_r(p,{timeout:f.connectionTimeouts.initial,retryCount:4,retryDelay:({count:$})=>Math.min(1e3*Math.pow(2,$),8e3)})});let G;i===6342?G=Kr({account:g.address,chain:j.chain,transport:vi({async request({method:$,params:L}){var U,A;if($==="eth_signTransaction"){const k=ne();if(!k)throw new Error("No embedded wallet found for signing");const B=await((U=k.getProvider)==null?void 0:U.call(k))||await((A=k.getEthereumProvider)==null?void 0:A.call(k))||k;if(B!=null&&B.request)return await B.request({method:$,params:L});throw new Error("Unable to get provider for signing")}return await j.request({method:$,params:L})}})}):G=Kr({account:g.address,chain:j.chain,transport:_r(p,{timeout:f.connectionTimeouts.retry,retryCount:4,retryDelay:({count:$})=>Math.min(1e3*Math.pow(2,$),5e3)})});const z={publicClient:j,walletClient:G,config:f,rpcUrl:p,releaseConnection:E};return y.current[d]=z,console.log(`Created clients for chain ${i}:`,{publicRPC:p,signingMethod:i===6342?"Local Privy":"RPC"}),z}catch(p){throw console.error(`Error creating clients for chain ${i}:`,p),p}},ye=(i,d)=>{const f=`${i}-${d}`;return C.current[f]||(C.current[f]={currentNonce:null,pendingNonce:null,lastUpdate:0,isUpdating:!1}),C.current[f]},wt=async(i,d,f=!1)=>{const g=ye(i,d),p=Date.now(),E=i.toString(),j=v.current[E];if(j&&j.isReady&&!f){const z=j.baseNonce+j.currentIndex;return console.log(`🎯 Using pool-based nonce ${z} for ${d} on chain ${i} (pool: ${j.currentIndex}/${j.transactions.length})`),z}if(!g.currentNonce||f||p-g.lastUpdate>3e4){if(g.isUpdating){let z=0;for(;g.isUpdating&&z<5e3;)await new Promise($=>setTimeout($,100)),z+=100;g.isUpdating&&(console.warn("⚠️ Nonce update timeout, forcing reset"),g.isUpdating=!1)}if(!g.isUpdating){g.isUpdating=!0;try{const{publicClient:z}=await pe(i),[$,L]=await Promise.all([z.getTransactionCount({address:d,blockTag:"latest"}),z.getTransactionCount({address:d,blockTag:"pending"})]),U=Math.max($,L),A=g.currentNonce||0;f?(g.currentNonce=U,g.pendingNonce=U,console.log(`🔄 Force refresh: nonce updated for ${d} on chain ${i}: ${A} → ${U}`)):U>A?(g.currentNonce=U,g.pendingNonce=U,console.log(`🔄 Nonce updated for ${d} on chain ${i}: ${A} → ${U}`)):(g.pendingNonce=g.currentNonce,console.log(`🔄 Keeping local nonce for ${d} on chain ${i}: ${g.currentNonce} (network: ${U})`)),g.lastUpdate=p}catch(z){console.error("❌ Error updating nonce:",z),g.currentNonce!==null?(console.warn(`⚠️ Using cached nonce ${g.currentNonce} due to network error`),g.pendingNonce=g.currentNonce):(g.currentNonce=0,g.pendingNonce=0,console.warn("⚠️ Initializing nonce to 0 due to network error"))}finally{g.isUpdating=!1}}}const G=g.pendingNonce;return g.pendingNonce+=1,console.log(`🎯 Allocated nonce ${G} for ${d} on chain ${i}`),G},H=async i=>{const d=i.toString();if(w.current[d]){const f=w.current[d],g=Date.now()-(f.timestamp||0),p=i===6342?2*60*1e3:b.gasParams;if(g<p)return console.log(`🎯 Using cached gas params for chain ${i} (age: ${Math.round(g/1e3)}s)`),f}try{const{publicClient:f}=await pe(i);let g,p;if(i===6342)console.log("⚡ Using ultra-optimized gas parameters for MegaETH real-time gaming"),g=ke("0.001"),p=ke("0.0005");else if(i===31337)g=ke("0.01"),p=ke("0.001");else try{g=await f.getGasPrice()*2n,p=ke("1")}catch(j){console.warn("Failed to get dynamic gas price, using fallback:",j),g=ke("20"),p=ke("2")}const E={maxFeePerGas:g,maxPriorityFeePerGas:p,timestamp:Date.now()};return w.current[d]=E,console.log(`⚡ Gas params for chain ${i}: {maxFeePerGas: ${Number(g)/1e9} gwei, maxPriorityFeePerGas: ${Number(p)/1e9} gwei}`),setTimeout(T,100),E}catch(f){if(console.error("Error getting gas params:",f),w.current[d])return console.log("🔄 Using stale cached gas params due to error"),w.current[d];const g={maxFeePerGas:ke("20"),maxPriorityFeePerGas:ke("2"),timestamp:Date.now()};return w.current[d]=g,g}},F=async i=>{const d=i.toString();if(Q.current[d])return Q.current[d];try{const{publicClient:f}=await pe(i),[g,p]=await Promise.all([ge(()=>f.getChainId(),2,500,i),ge(()=>f.getBlockNumber(),2,500,i)]),E={chainId:g,blockNumber:Number(p)},j=i===6342?3e4:6e4;return Q.current[d]=E,setTimeout(()=>{delete Q.current[d]},j),console.log(`Cached chain params for ${i}:`,E),E}catch(f){return console.error("Error getting chain params:",f),{chainId:i,blockNumber:0}}},se=async(i,d,f)=>{const g=i.toString();console.log("🚀 Starting pre-signing - balance already verified in initData");const p=_[i]||_.default,E=en(i);let j=Math.min(f,p.poolSize);E&&(j=Math.min(j,E.reducedBatchSize),console.log(`Using fallback mode for chain ${i}: batch size ${j}`)),console.log(`Pre-signing ${j} transactions for chain ${i} starting from nonce ${d}`),v.current[g]||(v.current[g]={transactions:[],currentIndex:0,baseNonce:d,hasTriggeredRefill:!1,isRefilling:!1,isReady:!1});const G=v.current[g],{walletClient:z}=await pe(i),$=await H(i);console.log(`Using gas parameters: {maxFeePerGasGwei: ${Number($.maxFeePerGas)/10**9}, maxPriorityFeePerGasGwei: ${Number($.maxPriorityFeePerGas)/10**9}}`);const L=Ie[i],U=ne(),A=10;console.log(`🚀 Starting parallel pre-signing of ${j} transactions`);try{const B=d,K={account:U.address,to:L.contractAddress,data:"0xa2e62045",nonce:B,maxFeePerGas:$.maxFeePerGas,maxPriorityFeePerGas:$.maxPriorityFeePerGas,value:0n,type:"eip1559",gas:100000n},Z=await z.signTransaction(K);G.transactions.push({signedTx:Z,_reservedNonce:B,timestamp:Date.now()}),G.isReady=!0,console.log("🎮 First transaction ready - gaming can begin!"),console.log("✅ Pre-signed transaction pool is now ACTIVE with 1 transaction"),le(i)}catch(B){throw console.error("Failed to sign first transaction:",B),B}for(let B=1;B<j;B+=A){const K=Math.min(B+A,j),Z=[];for(let we=B;we<K;we++){const de=d+we,Ze=async()=>{var Te,Qe;try{const $e={account:U.address,to:L.contractAddress,data:"0xa2e62045",nonce:de,maxFeePerGas:$.maxFeePerGas,maxPriorityFeePerGas:$.maxPriorityFeePerGas,value:0n,type:"eip1559",gas:100000n};let In;return i===6342?In=await ge(async()=>await z.signTransaction($e),E?1:p.maxRetries,p.retryDelay,i):In=await ge(()=>z.signTransaction($e),E?1:p.maxRetries,p.retryDelay,i),{signedTx:In,_reservedNonce:de,timestamp:Date.now()}}catch($e){return console.error(`Error signing transaction with nonce ${de}:`,$e),((Te=$e.message)!=null&&Te.includes("rate limit")||$e.status===429||$e.status===403||(Qe=$e.message)!=null&&Qe.includes("not whitelisted"))&&console.log("Rate limit/403/not whitelisted detected during pre-signing, skipping transaction"),null}};Z.push(Ze())}const ee=(await Promise.all(Z)).filter(we=>we!==null);if(G.transactions.push(...ee),console.log(`Pre-signed batch ${Math.floor((B-1)/A)+1}/${Math.ceil((j-1)/A)} - total ${G.transactions.length}/${j}`),K<j){const we=E?E.increasedDelay:Math.min(p.retryDelay,100);we>0&&await new Promise(de=>setTimeout(de,we))}}console.log(`Successfully pre-signed ${G.transactions.length} transactions`),E&&G.transactions.length>0&&console.log("Fallback mode: minimum transactions ready for gaming");const k=ye(i,U.address);k&&(k.pendingNonce=Math.max(k.pendingNonce||0,d+G.transactions.length))},W=async(i,d,f)=>{const g=i.toString(),p=v.current[g];if(!p||p.isRefilling){console.log("Pool extension already in progress, skipping");return}try{p.isRefilling=!0,console.log(`Extending pool for chain ${i} from nonce ${d} with ${f} transactions`);const E=[],{walletClient:j}=await pe(i),G=await H(i),z=Ie[i],$=ne(),L=10;console.log(`📝 Starting parallel signing of ${f} transactions in batches of ${L}`);for(let U=0;U<f;U+=L){const A=Math.min(U+L,f),k=A-U,B=[];for(let oe=U;oe<A;oe++){const ee=d+oe,we=async()=>{try{const de={account:$.address,to:z.contractAddress,data:"0xa2e62045",nonce:ee,maxFeePerGas:G.maxFeePerGas,maxPriorityFeePerGas:G.maxPriorityFeePerGas,value:0n,type:"eip1559",gas:100000n};return{signedTx:await j.signTransaction(de),_reservedNonce:ee,timestamp:Date.now()}}catch(de){return console.error(`Error signing extension transaction with nonce ${ee}:`,de),null}};B.push(we())}const Z=(await Promise.all(B)).filter(oe=>oe!==null);if(E.push(...Z),console.log(`Extended pool: signed batch ${Math.floor(U/L)+1}/${Math.ceil(f/L)} - total ${E.length}/${f}`),Z.length<k){console.warn(`⚠️ Only ${Z.length}/${k} transactions signed in batch, stopping extension`);break}}if(p&&E.length>0){p.transactions.push(...E),console.log(`Pool extended successfully. Total transactions: ${p.transactions.length}`);const U=ye(i,$.address);U&&(U.pendingNonce=Math.max(U.pendingNonce||0,d+E.length)),p&&(p.hasTriggeredRefill=!1,console.log(`✅ Pool refill completed and flag reset. Pool now has ${p.transactions.length} total transactions`))}}catch(E){console.error("Error extending transaction pool:",E)}finally{p&&(p.isRefilling=!1)}},st=async i=>{const d=i.toString(),f=v.current[d],g=_[i]||_.default;let p=await re(i),E=parseFloat(p);if(E<5e-5){console.warn(`⚠️ Balance low (${p} ETH). Initiating faucet + wait sequence before using pre-signed transactions...`);const j=ne();if(j)try{await Re(j.address,i).catch(()=>{}),p=await ue(i,5e-5,3e4),E=parseFloat(p)}catch(G){console.warn("⚠️ Faucet/wait sequence failed:",G)}if(E<5e-5)throw console.error(`❌ Insufficient balance after wait (${p} ETH) for using pre-signed transactions`),new Error(`Insufficient balance for blockchain transactions: ${p} ETH. Please wait a few seconds for faucet or refresh.`)}if(f&&f.isReady&&f.transactions.length>f.currentIndex){const j=f.transactions[f.currentIndex];if(f.currentIndex++,console.log(`🎯 Using pre-signed transaction ${f.currentIndex}/${f.transactions.length} (nonce: ${j._reservedNonce})`),f.currentIndex%10===0){const z=f.transactions.length-f.currentIndex,$=(f.currentIndex/f.transactions.length*100).toFixed(1);console.log(`📊 Pool utilization: ${$}% (${f.currentIndex}/${f.transactions.length}), ${z} remaining`)}f.currentIndex%5===0&&f.currentIndex>0&&!f.hasTriggeredRefill&&!f.isRefilling&&(console.log(`🔄 FREQUENT refilling at ${f.currentIndex} transactions used`),f.hasTriggeredRefill=!0,(async()=>{try{const z=ne();if(z){const{publicClient:$}=await pe(i),L=await $.getTransactionCount({address:z.address,blockTag:"pending"}),U=f.baseNonce+f.currentIndex-1,A=Math.max(L,U+1);console.log(`🎯 Refill nonce calculation: network=${L}, lastUsed=${U}, nextAvailable=${A}`);const k=f.currentIndex,B=Math.max(50,g.batchSize*3),K=k>50?Math.floor(B*1.8):B;console.log(`🚀 CRITICAL refill: adding ${K} transactions from nonce ${A}`),console.log(`📊 Pool status before refill: ${f.transactions.length-f.currentIndex} remaining`),await W(i,A,K);const Z=ye(i,z.address);Z&&(Z.currentNonce=A,Z.pendingNonce=A+K,Z.lastUpdate=Date.now())}}catch(z){console.error("❌ Error in critical pool refill:",z),f.hasTriggeredRefill=!1}})());const G=f.transactions.length-f.currentIndex;return G<=5&&!f.hasTriggeredRefill&&!f.isRefilling&&(console.warn(`🚨 CRITICAL: Only ${G} transactions left, emergency refill!`),f.hasTriggeredRefill=!0,(async()=>{try{const z=ne();if(z){const{publicClient:$}=await pe(i),L=await $.getTransactionCount({address:z.address,blockTag:"pending"}),U=f.baseNonce+f.currentIndex-1,A=Math.max(L,U+1),k=Math.max(100,g.batchSize*4);console.log(`🆘 EMERGENCY refill: adding ${k} transactions from nonce ${A}`),await W(i,A,k);const B=ye(i,z.address);B&&(B.currentNonce=A,B.pendingNonce=A+k,B.lastUpdate=Date.now())}}catch(z){console.error("❌ Emergency refill failed:",z),f.hasTriggeredRefill=!1}})()),j.signedTx}else if(f)if(f.isReady){if(f.transactions.length<=f.currentIndex)throw console.log(`📭 Transaction pool empty for chain ${i} (used ${f.currentIndex}/${f.transactions.length})`),new Error(`Pre-signed transaction pool exhausted for chain ${i}. Only pre-signed transactions are allowed.`)}else throw console.log(`⏳ Transaction pool not ready yet for chain ${i} (${f.transactions.length} transactions in progress)`),new Error(`Pre-signed transaction pool not ready for chain ${i}. Wait for initialization to complete.`);else throw console.log(`❌ No transaction pool exists for chain ${i}`),new Error(`No pre-signed transaction pool available for chain ${i}. Only pre-signed transactions are allowed.`);try{console.error("🚨 CRITICAL: Pre-signed pool empty! Attempting emergency refill...");const j=ne();if(j){const G=ye(i,j.address),z=_[i]||_.default,$=Math.min(5,z.batchSize),L=G.pendingNonce;console.log(`🚨 Emergency pre-signing ${$} transactions from nonce ${L}`),await se(i,L,$);const U=v.current[i.toString()];if(U&&U.isReady&&U.transactions.length>U.currentIndex){const A=U.transactions[U.currentIndex];return U.currentIndex++,console.log(`✅ Emergency transaction obtained: ${U.currentIndex}/${U.transactions.length}`),A.signedTx}}}catch(j){console.error("❌ Emergency refill failed:",j)}throw new Error("CRITICAL ERROR: Pre-signed transaction pool exhausted and emergency refill failed. Only pre-signed transactions are allowed in this game.")},le=i=>{const d=i.toString(),f=setInterval(async()=>{const g=v.current[d];if(!g||!g.isReady)return;const p=g.transactions.length-g.currentIndex,E=g.transactions.length,j=g.currentIndex,G=Math.floor(j/5);if(j%5===0&&j>0){const z=p>30?"🚀 EXCELLENT":p>20?"✅ GOOD":p>10?"⚠️ WARNING":"🚨 CRITICAL";console.log(`📊 Enhanced Pool Stats for chain ${i} (Jump #${j}):`),console.log(`  • Consumed: ${j} transactions`),console.log(`  • Remaining: ${p} transactions`),console.log(`  • Total pool size: ${E} transactions`),console.log(`  • Pool health: ${z}`),console.log(`  • Refill status: ${g.isRefilling?"🔄 ACTIVE":"⏸️ IDLE"}`),console.log(`  • Last refill triggered: ${g.hasTriggeredRefill?"✅ YES":"❌ NO"}`),j>=15&&j<=25&&(console.warn(`⚠️ CRITICAL ZONE: Jump ${j}/20+ - monitoring for slowdown issues`),p<15&&console.error(`🚨 DANGER: Only ${p} transactions left at jump ${j}! This causes 5s delays!`))}if(p<=3&&!g.isRefilling&&(console.error(`🚨 INFINITE POOL VIOLATION: Only ${p} transactions left!`),console.error("  • This should never happen with infinite pool logic"),console.error(`  • Consumed: ${j}, Total: ${E}, Cycles: ${G}`),g.hasTriggeredRefill||(g.hasTriggeredRefill=!0,console.log("🚨 EMERGENCY: Force-refilling infinite pool..."),setTimeout(async()=>{try{const z=ne();if(z){const $=ye(i,z.address);await W(i,$.pendingNonce,25)}}catch(z){console.error("❌ Emergency infinite pool refill failed:",z)}},0))),p<=8&&j>10&&console.warn(`⚠️ INFINITE POOL: Low remaining transactions (${p}) - check refill mechanism`),(p<=3||!g.isRefilling&&p<=8)&&!g.hasTriggeredRefill){g.hasTriggeredRefill=!0;try{const z=ne();if(z){const{publicClient:$}=await pe(i),L=await $.getTransactionCount({address:z.address,blockTag:"pending"}),U=g.baseNonce+g.currentIndex-1,A=Math.max(L,U+1),k=Math.max(20,Math.floor((g.transactions.length||20)*.75));await W(i,A,k);const B=ye(i,z.address);B&&(B.currentNonce=A,B.pendingNonce=A+k,B.lastUpdate=Date.now()),g.hasTriggeredRefill=!1}}catch(z){console.warn("Auto-refill attempt failed:",z),g.hasTriggeredRefill=!1}}},3e3);return console.log(`👁️ Started INFINITE pool monitoring for chain ${i}`),console.log("📊 Pool will grow by +10 transactions every 5 consumed (mathematical infinity)"),f},re=async i=>{try{const{publicClient:d}=await pe(i),f=ne();if(!f)return console.error("No embedded wallet available for balance check"),"0";const g=await d.getBalance({address:f.address}),p=(Number(g)/10**18).toFixed(4);return u(p),console.log(`Balance for ${f.address}: ${p} ETH`),p}catch(d){return console.error("Error checking balance:",d),u("0"),"0"}},ue=async(i,d=5e-5,f=3e4)=>{const g=Date.now();let p="0";if(p=await re(i),parseFloat(p)>=d)return p;let E=0;for(;Date.now()-g<f;){const j=E<5?300:800;if(await new Promise(G=>setTimeout(G,j)),p=await re(i),parseFloat(p)>=d)return p;E++}return p},Me=async(i,d=5,f=3e4)=>{const g=i.toString(),p=Date.now(),E=ne();if(!E)throw new Error("No embedded wallet available for pre-sign pool init");const j=await ue(i,5e-5,f);if(parseFloat(j)<5e-5)throw new Error(`Insufficient balance after wait (${j} ETH)`);let G=v.current[g];if(G&&G.isReady&&G.transactions.length-G.currentIndex>=d)return!0;const{publicClient:z}=await pe(i),$=await z.getTransactionCount({address:E.address,blockTag:"pending"}),L=_[i]||_.default,U=Math.max(d,Math.min(L.poolSize||20,25)),A=ye(i,E.address);for(A&&(A.pendingNonce=Math.max(A.pendingNonce||$,$+U)),await se(i,$,U);Date.now()-p<f;){if(G=v.current[g],G&&G.isReady&&G.transactions.length-G.currentIndex>=d)return!0;await new Promise(k=>setTimeout(k,200))}if(G=v.current[g],G&&G.transactions.length>G.currentIndex)return!0;throw new Error("Pre-signed pool not ready in time")},Ne=i=>{i&&(console.log("🔄 Starting automatic balance updates for chain:",i),te.current&&clearInterval(te.current),te.current=setInterval(async()=>{try{await re(i)}catch(d){console.warn("Auto balance update failed:",d)}},1e4))},Se=()=>{te.current&&(clearInterval(te.current),te.current=null,console.log("🛑 Stopped automatic balance updates"))},Re=async(i,d)=>{const f=`faucet_${d}_${i}`,g=5*60*1e3;try{const p=localStorage.getItem(f);if(p){const k=Date.now()-parseInt(p);if(k<g){const B=Math.ceil((g-k)/1e3);throw console.log(`⏱️ Faucet cooldown: ${B}s remaining`),new Error(`Faucet is on cooldown. Try again in ${B} seconds.`)}}console.log("💰 Calling optimized faucet for address:",i),console.log("🌐 Chain ID:",d);const E=ne(),j=E&&E.address===i;if(!j)throw new Error("Faucet target must be the embedded wallet. Please wait for wallet to initialize.");console.log("🔍 Faucet target address check:",{address:i,isEmbeddedWallet:j,embeddedWalletAddress:E==null?void 0:E.address,walletType:(E==null?void 0:E.walletClientType)||(E==null?void 0:E.connectorType)||(E==null?void 0:E.type)});const G=new AbortController,z=setTimeout(()=>G.abort(),3e4),$=window.location.hostname==="localhost"?"/api/faucet":`${window.location.origin}/api/faucet`;console.log("📡 Faucet API URL:",$);const L=await fetch($,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:i,chainId:d,timestamp:Date.now(),clientVersion:"1.0",force:!0}),signal:G.signal,mode:"cors"});if(clearTimeout(z),!L.ok){let k="Faucet request failed";try{const B=await L.text();let K={};try{K=JSON.parse(B)}catch{}if(k=K.error||k,K.code==="INSUFFICIENT_BALANCE")k="Faucet is temporarily empty. Please try again later.";else if(K.code==="RATE_LIMIT")k=`Rate limit exceeded. Try again in ${K.retryAfter||300} seconds.`;else if(K.code==="ALREADY_SUFFICIENT")return console.log("💰 Balance already sufficient, skipping faucet"),{success:!0,message:"Sufficient balance already available",skipped:!0}}catch(B){console.error("Failed to parse faucet error response:",B),L.status===429?k="Too many requests. Please wait a few minutes and try again.":L.status===503?k="Faucet service is temporarily unavailable. Please try again later.":k=`HTTP ${L.status}: ${L.statusText}`}throw new Error(k)}const U=await L.text();let A={};try{A=JSON.parse(U)}catch{}if((!A||!A.success)&&console.warn("Faucet responded without success flag:",U),A&&A.success&&localStorage.setItem(f,Date.now().toString()),console.log("💰 Faucet success:",A),A.txHash){console.log("⏳ Faucet transaction sent, updating balance immediately...");try{await re(d),console.log("✅ Balance updated immediately after faucet transaction")}catch(k){console.warn("Failed to update balance after faucet:",k)}}return{success:!0,...A,timestamp:Date.now(),isEmbeddedWallet:j}}catch(p){throw console.error("❌ Faucet error:",p),p.name==="AbortError"?new Error("Faucet request timed out. Please check your connection and try again."):p.message.includes("Failed to fetch")||p.message.includes("NetworkError")?new Error("Network error. Please check your connection and try again."):p.message.includes("cooldown")||p.message.includes("Rate limit")||p.message.includes("temporarily unavailable")?p:new Error(`Faucet error: ${p.message}`)}},Rn=async(i,d)=>{var G,z,$;const f=Ie[i],g=_[i]||_.default,p=await Qt(i),E=Date.now();let j=!1;try{let L,U;if(f.sendMethod==="realtime_sendRawTransaction"){if(console.log("🚀 Using MegaETH realtime_sendRawTransaction for instant execution..."),L=await ge(async()=>{var K,Z,oe,ee,we;const k=new AbortController,B=setTimeout(()=>k.abort(),f.connectionTimeouts.request);try{const de=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",method:"realtime_sendRawTransaction",params:[d],id:Date.now()}),signal:k.signal,mode:"cors"});if(clearTimeout(B),!de.ok){const Qe=await de.text();throw new Error(`HTTP ${de.status}: ${Qe}`)}const Ze=await de.text(),Te=Bn(Ze);if(!Te)throw new Error("Invalid response format from MegaETH RPC");if(Te.error){if((K=Te.error.message)!=null&&K.includes("nonce too low"))throw console.log("🔄 MegaETH nonce too low, triggering refresh"),new Error("nonce too low");if((Z=Te.error.message)!=null&&Z.includes("rate limit"))throw console.log("⏱️ MegaETH rate limit hit, will retry"),new Error("rate limit exceeded");if((oe=Te.error.message)!=null&&oe.includes("already known"))return console.log("🔄 Transaction already known by network - likely duplicate, treating as success"),{result:{transactionHash:"duplicate_tx_"+Date.now(),status:"0x1",gasUsed:"0x66f9",blockNumber:"0x"+Date.now().toString(16),from:((ee=Te.error.data)==null?void 0:ee.from)||"0x0",to:((we=Te.error.data)==null?void 0:we.to)||"0x0"}};throw new Error(`MegaETH RPC Error: ${Te.error.message}`)}return Te}catch(de){throw clearTimeout(B),de.name==="AbortError"?new Error("MegaETH RPC timeout - real-time deadline exceeded"):de}},g.maxRetries,100,i),L.error)throw new Error(`MegaETH Real-time Error: ${L.error.message}`);return U=L.result,console.log("⚡ MegaETH instant transaction hash:",U),j=!0,{hash:U,receipt:L.result,isInstant:!0,network:"MegaETH"}}else if(f.sendMethod==="eth_sendRawTransactionSync"){console.log("📦 Using RISE eth_sendRawTransactionSync for fast execution...");const A=new AbortController,k=setTimeout(()=>A.abort(),f.connectionTimeouts.retry);try{L=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",method:"eth_sendRawTransactionSync",params:[d],id:Date.now()}),signal:A.signal,mode:"cors"}),clearTimeout(k);const B=await L.text(),K=Bn(B);if(!K)throw new Error("Invalid response format from RISE RPC");if(K.error)throw(G=K.error.message)!=null&&G.includes("nonce too low")?(console.log("🔄 RISE nonce too low detected"),new Error("nonce too low")):new Error(K.error.message||"RISE transaction failed");return j=!0,{hash:K.result,receipt:K.result,isInstant:!0,network:"RISE"}}catch(B){throw clearTimeout(k),B.name==="AbortError"?new Error("RISE RPC timeout"):B}}else{console.log("🔗 Using standard eth_sendRawTransaction...");const A=new AbortController,k=setTimeout(()=>A.abort(),f.connectionTimeouts.retry);try{L=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",method:"eth_sendRawTransaction",params:[d],id:Date.now()}),signal:A.signal,mode:"cors"}),clearTimeout(k);const B=await L.text(),K=Bn(B);if(!K)throw new Error("Invalid response format from RPC");if(K.error)throw(z=K.error.message)!=null&&z.includes("nonce too low")?(console.log("🔄 Standard RPC nonce too low detected"),new Error("nonce too low")):new Error(K.error.message||"Transaction failed");return j=!0,{hash:K.result,isInstant:!1,network:f.name}}catch(B){throw clearTimeout(k),B.name==="AbortError"?new Error("Standard RPC timeout"):B}}}catch(L){if(console.error("❌ Send transaction error:",L),($=L.message)!=null&&$.includes("nonce too low")){const U=ne();if(U){console.log('🔄 Refreshing nonce due to "nonce too low" error');try{await wt(i,U.address,!0);const A=i.toString(),k=v.current[A];k&&(console.log("🗑️ Clearing invalid pre-signed transaction pool"),k.transactions=[],k.currentIndex=0,k.isReady=!1,k.hasTriggeredRefill=!1,setTimeout(async()=>{try{const{publicClient:B}=await pe(i),K=await B.getTransactionCount({address:U.address,blockTag:"pending"});console.log(`🔄 Recreating pool with actual network nonce: ${K}`);const Z=ye(i,U.address);Z.currentNonce=K,Z.pendingNonce=K,Z.lastUpdate=Date.now();const oe=_[i]||_.default;await se(i,K,oe.batchSize),console.log(`✅ Pre-signed transaction pool recreated with correct nonces starting from ${K}`)}catch(B){console.error("❌ Failed to recreate transaction pool:",B)}},100))}catch(A){console.error("Failed to refresh nonce:",A)}}}throw L}finally{const L=Date.now()-E;Sn(i,p,j,L),j&&console.log(`✅ Transaction sent successfully in ${L}ms via ${f.sendMethod}`)}},$n=async i=>{if(!ne())throw new Error("No embedded wallet available");if(i===6342){const p=i.toString(),E=v.current[p];if(E&&E.isReady&&E.transactions.length>E.currentIndex){if(O.current>10)throw console.log("🚫 Maximum MegaETH throughput reached, throttling"),new Error("Transaction throughput limit reached")}else if(O.current>2)throw console.log("🚫 Too many concurrent realtime transactions"),new Error("Realtime transaction limit reached")}else if(a)throw new Error("Transaction already pending, blocking jump");Y(i);const f=performance.now();return(_[i]||_.default).burstMode&&rt(i)?(console.log("🚀 Using burst mode for transaction"),await Cn(i,async()=>await at(i,f))):await at(i,f)},at=async(i,d)=>{var E,j,G,z;let f=null,g=0,p=!1;try{if(i!==6342&&o(!0),O.current++,f=await st(i),!f)throw new Error("Failed to get transaction for sending");console.log("⚡ Sending instant on-chain jump transaction...");const $=await Rn(i,f);console.log("📡 Transaction sent:",$);const L=Ie[i];let U=$;if(L.sendMethod==="realtime_sendRawTransaction")console.log("✅ MegaETH instant confirmation:",$),U=$.receipt||$,p=!0;else if(L.sendMethod==="eth_sendRawTransactionSync")console.log("✅ RISE sync confirmation:",$),U=$.receipt||$,p=!0;else{console.log("⏳ Waiting for transaction confirmation...");try{const{publicClient:k}=await pe(i),B=await Promise.race([k.waitForTransactionReceipt({hash:$.hash,timeout:3e4}),new Promise((K,Z)=>setTimeout(()=>Z(new Error("Transaction confirmation timeout")),35e3))]);console.log("✅ Transaction confirmed:",B),U=B,p=!0}catch(k){console.warn("⚠️ Transaction confirmation failed, but transaction may still be valid:",k),U=$,p=!0}}g=performance.now()-d,console.log(`🎮 Jump transaction completed in ${Math.round(g)}ms:`,U);const A=q(i,g,p);return console.log(`📊 Performance: Avg ${Math.round(A.averageBlockchainTime)}ms, Success Rate ${A.successRate.toFixed(1)}%`),{...U,blockchainTime:Math.round(g),reactionTime:0,performanceMetrics:{averageBlockchainTime:Math.round(A.averageBlockchainTime),successRate:A.successRate,totalTransactions:A.totalTransactions}}}catch($){if(console.error("❌ Error sending on-chain movement:",$),g=performance.now()-d,q(i,g,!1),(E=$.message)!=null&&E.includes("nonce too low")){console.log("🔄 Nonce too low detected, refreshing nonce and retrying...");try{const L=ne();if(L){await wt(i,L.address,!0);const U=i.toString(),A=v.current[U];A&&(console.log("🗑️ Clearing invalid pre-signed transaction pool due to nonce error"),A.transactions=[],A.currentIndex=0,A.isReady=!1,A.hasTriggeredRefill=!1),console.log("✅ Nonce refreshed, please try again")}else console.error("❌ No wallet available for nonce refresh")}catch(L){console.error("❌ Failed to refresh nonce:",L)}}else if((j=$.message)!=null&&j.includes("context deadline exceeded"))console.log("⏰ Network timeout detected, transaction may still be processing...");else if((G=$.message)!=null&&G.includes("insufficient funds")||(z=$.message)!=null&&z.includes("Insufficient balance")){console.log("💰 Insufficient funds detected, consider calling faucet...");try{const L=ne();L&&(console.log("🔄 Attempting automatic faucet call due to insufficient balance..."),await Re(L.address,i),console.log("✅ Automatic faucet call completed"))}catch(L){console.warn("⚠️ Automatic faucet call failed:",L)}}throw new Error(`Blockchain transaction error: ${$.message}`)}finally{i!==6342&&o(!1),O.current=Math.max(0,O.current-1)}},tn=async i=>{const d=i.toString();if(!(D.current[d]||r))try{s(!0),console.log("🚀 Starting instant blockchain initialization for chain:",i);let f=null,g=0;const p=10;for(;!f&&g<p;)f=ne(),f||(await new Promise(A=>setTimeout(A,1e3)),g++);if(!f)throw new Error("No embedded wallet available");f.walletClientType==="privy"&&console.log("⚡ INSTANT GAMING MODE ENABLED - игра готова!"),await F(i);const E=ye(i,f.address),j=[],G=Promise.all([re(i),ge(async()=>{const{publicClient:A}=await pe(i);return await A.getTransactionCount({address:f.address,blockTag:"pending"})},3,1e3,i)]).then(async([A,k])=>{if(E.currentNonce=k,E.pendingNonce=k,E.lastUpdate=Date.now(),console.log("💰 Current balance:",A),console.log("🎯 Starting nonce:",k),parseFloat(A)<5e-5){console.log(`💰 Balance is ${A} ETH (< 0.00005), calling faucet SYNCHRONOUSLY...`);const B=ne();if(!B)return console.warn("⚠️ No embedded wallet available for faucet, deferring until available"),{currentBalance:A,initialNonce:k};console.log("🎯 Using embedded wallet for faucet:",B.address);try{const K=await Re(B.address,i);console.log("✅ Synchronous faucet completed"),K.isEmbeddedWallet?console.log("✅ Faucet sent to embedded wallet:",B.address):console.log("⚠️ Faucet sent to non-embedded wallet:",B.address);const Z=await re(i);return console.log("✅ Balance updated immediately after faucet response:",Z),await wt(i,B.address,!0),{currentBalance:Z,initialNonce:k}}catch(K){return console.warn("⚠️ Synchronous faucet failed:",K),{currentBalance:A,initialNonce:k}}}return{currentBalance:A,initialNonce:k}});j.push(G);try{console.log("⏳ Ensuring pre-signed pool is ready before start..."),await Me(i,5,25e3),console.log("✅ Pre-signed pool ready. Proceeding.")}catch(A){console.warn("⚠️ Could not fully prepare pre-signed pool before start:",(A==null?void 0:A.message)||A)}D.current[d]=!0,console.log("⚡ INSTANT GAMING MODE ENABLED - игра готова!");const z=_[i]||_.default,$=en(i);let L=z.poolSize;$&&(L=$.reducedBatchSize,console.log(`Using fallback batch size: ${L}`)),G.then(async({currentBalance:A,initialNonce:k})=>{console.log(`💰 Pre-signing with balance: ${A} ETH`);let B=A;if(parseFloat(B)<5e-5&&(console.warn(`⚠️ Balance still insufficient (${B} ETH) for pre-signing - waiting briefly for funding...`),B=await ue(i,5e-5,15e3)),parseFloat(B)<5e-5){console.warn(`⚠️ Balance not funded after wait (${B} ETH). Skipping pre-signing for now.`);return}console.log(`🔄 Background pre-signing ${L} transactions starting from nonce ${k}`);const K=ye(i,f.address);return K&&(K.pendingNonce=Math.max(K.pendingNonce||k,k+L)),se(i,k,L).then(()=>{const Z=v.current[d];Z&&Z.transactions.length>0?console.log(`✅ Background pre-signed ${Z.transactions.length} transactions - performance boost ready!`):console.log("⚠️ Pre-signing completed with 0 transactions - using realtime mode")}).catch(Z=>{var oe;console.warn("⚠️ Background pre-signing failed (non-blocking):",Z),(oe=Z.message)!=null&&oe.includes("Insufficient balance")&&console.error("❌ Pre-signing failed due to insufficient balance. User needs to wait for faucet or refresh page."),yt(i),console.log("🔄 Enabled realtime fallback mode - game continues smoothly")})}).catch(A=>{console.warn("Background pre-signing error (non-critical):",A)}),await G,Ne(i),console.log("🎮 Blockchain ready for instant gaming on chain:",i),console.log($?"⚠️ Running in fallback mode - reduced performance expected":"🚀 Full performance mode activating in background..."),Promise.all(j.slice(1)).then(()=>{console.log("✅ Full blockchain optimization complete")}).catch(A=>{console.warn("⚠️ Some background optimizations failed (non-critical):",A)})}catch(f){console.error("❌ Critical initialization error:",f),D.current[d]=!0,yt(i),console.log("🔄 Emergency fallback mode enabled - game will work with realtime signing")}finally{s(!1)}},ze=async i=>{try{const{publicClient:d,config:f}=await pe(i),g=await d.readContract({address:f.contractAddress,abi:kc,functionName:"number"});return m(Number(g)),Number(g)}catch(d){return console.error("Error reading contract number:",d),0}},V=M.useRef({}),te=M.useRef(null),he=i=>(V.current[i]||(V.current[i]={failures:0,lastFailureTime:0,state:"CLOSED",threshold:5,timeout:6e4}),V.current[i]),ge=async(i,d=3,f=1e3,g=null)=>{var j,G,z,$,L,U,A,k,B,K,Z;let p,E=null;if(g&&(E=he(g),E.state==="OPEN")){const oe=Date.now()-E.lastFailureTime;if(oe<E.timeout)throw new Error(`Circuit breaker is OPEN for chain ${g}. Try again in ${Math.round((E.timeout-oe)/1e3)} seconds.`);E.state="HALF_OPEN",console.log(`Circuit breaker for chain ${g} entering HALF_OPEN state`)}for(let oe=0;oe<d;oe++)try{const ee=await i();return E&&(E.failures=0,E.state="CLOSED"),ee}catch(ee){p=ee;const we=oe===d-1;E&&(E.failures++,E.lastFailureTime=Date.now(),E.failures>=E.threshold&&(E.state="OPEN",console.warn(`Circuit breaker OPENED for chain ${g} after ${E.failures} failures`)));const de=ee.status===429||ee.status===403||ee.status===500||ee.status===502||ee.status===503||ee.status===504||((j=ee.message)==null?void 0:j.includes("rate limit"))||((G=ee.message)==null?void 0:G.includes("timeout"))||((z=ee.message)==null?void 0:z.includes("context deadline exceeded"))||(($=ee.message)==null?void 0:$.includes("connection"))||((L=ee.message)==null?void 0:L.includes("network"))||((U=ee.message)==null?void 0:U.includes("fetch"))||ee.name==="AbortError"||ee.name==="TypeError",Ze=((A=ee.message)==null?void 0:A.includes("nonce too low"))||((k=ee.message)==null?void 0:k.includes("insufficient funds"))||((B=ee.message)==null?void 0:B.includes("gas too low"))||((K=ee.message)==null?void 0:K.includes("invalid signature"))||((Z=ee.message)==null?void 0:Z.includes("execution reverted"));if(we||Ze||!de)throw Ze&&console.log(`Non-retryable error encountered: ${ee.message}`),ee;if(E&&E.state==="OPEN"){console.log(`Circuit breaker is OPEN, stopping retries for chain ${g}`);break}const Te=Math.random()*1e3,Qe=Math.min(f*Math.pow(2,oe)+Te,3e4);console.log(`Retry attempt ${oe+1}/${d} after ${Math.round(Qe)}ms delay due to:`,ee.message),await new Promise($e=>setTimeout($e,Qe))}throw p};return M.useEffect(()=>{window.location.hostname==="localhost"&&(window.blockchainDebug={getRPCHealth:i=>x.current[i],getCircuitBreaker:i=>V.current[i],getTransactionPool:i=>v.current[i],getBurstState:i=>me.current[i],getConnectionPool:()=>P.current,getNonceManager:(i,d)=>C.current[`${i}-${d}`],forceCircuitBreakerOpen:i=>{const d=he(i);d.state="OPEN",d.failures=d.threshold,d.lastFailureTime=Date.now(),console.log(`Force opened circuit breaker for chain ${i}`)},resetCircuitBreaker:i=>{const d=he(i);d.state="CLOSED",d.failures=0,console.log(`Reset circuit breaker for chain ${i}`)},clearTransactionPool:i=>{const d=i.toString();v.current[d]&&(v.current[d].transactions=[],v.current[d].currentIndex=0,console.log(`Cleared transaction pool for chain ${i}`))},generateHealthReport:i=>{const d=x.current[i],f=v.current[i==null?void 0:i.toString()],g=V.current[i],p={timestamp:new Date().toISOString(),chainId:i,rpcEndpoints:d,transactionPool:f?{totalTransactions:f.transactions.length,currentIndex:f.currentIndex,availableTransactions:f.transactions.length-f.currentIndex,isRefilling:f.isRefilling}:null,circuitBreaker:g,connections:P.current,burstState:me.current[i]};return console.table(p),p}},console.log("🔧 Blockchain debug utilities loaded. Use window.blockchainDebug for monitoring."),console.log("📊 Example: window.blockchainDebug.generateHealthReport(6342)"))},[]),M.useEffect(()=>(window.location.hostname==="localhost"&&(window.blockchainDebug={getRPCHealth:i=>x.current[i],getCircuitBreaker:i=>V.current[i],getTransactionPool:i=>v.current[i],getBurstState:i=>me.current[i],getConnectionPool:()=>P.current,getNonceManager:(i,d)=>C.current[`${i}-${d}`],getPerformanceMetrics:i=>S.current[i],getGlobalCache:()=>{try{const i=localStorage.getItem(N);return i?JSON.parse(i):null}catch{return null}},forceCircuitBreakerOpen:i=>{const d=he(i);d.state="OPEN",d.failures=d.threshold,d.lastFailureTime=Date.now(),console.log(`Force opened circuit breaker for chain ${i}`)},resetCircuitBreaker:i=>{const d=he(i);d.state="CLOSED",d.failures=0,console.log(`Reset circuit breaker for chain ${i}`)},clearTransactionPool:i=>{const d=i.toString();v.current[d]&&(v.current[d].transactions=[],v.current[d].currentIndex=0,console.log(`Cleared transaction pool for chain ${i}`))},generatePerformanceReport:i=>{var G,z;const d=x.current[i],f=v.current[i==null?void 0:i.toString()],g=V.current[i],p=S.current[i],E=window.blockchainDebug.getGlobalCache(),j={timestamp:new Date().toISOString(),chainId:i,network:((G=Ie[i])==null?void 0:G.name)||"Unknown",rpcEndpoints:d?{current:(z=d.endpoints[d.currentEndpointIndex])==null?void 0:z.url,healthyCount:d.endpoints.filter($=>$.healthy).length,totalCount:d.endpoints.length,endpoints:d.endpoints.map($=>({url:$.url,healthy:$.healthy,failures:$.consecutiveFailures,responseTime:$.responseTime}))}:null,transactionPool:f?{totalTransactions:f.transactions.length,currentIndex:f.currentIndex,availableTransactions:f.transactions.length-f.currentIndex,poolUtilization:`${Math.round(f.currentIndex/f.transactions.length*100)}%`,isRefilling:f.isRefilling,hasTriggeredRefill:f.hasTriggeredRefill}:null,circuitBreaker:g?{state:g.state,failures:g.failures,threshold:g.threshold,lastFailure:g.lastFailureTime?new Date(g.lastFailureTime).toISOString():null}:null,performance:p?{totalTransactions:p.totalTransactions,successfulTransactions:p.successfulTransactions,successRate:`${p.successRate.toFixed(1)}%`,averageBlockchainTime:`${Math.round(p.averageBlockchainTime)}ms`,recentTransactions:p.recentTransactions.slice(-10).map($=>({blockchainTime:`${$.blockchainTime}ms`,success:$.success,timestamp:new Date($.timestamp).toISOString()})),performanceGrade:p.averageBlockchainTime<1e3?"🚀 INSTANT":p.averageBlockchainTime<3e3?"⚡ FAST":p.averageBlockchainTime<5e3?"🔥 GOOD":"🐌 SLOW"}:null,connections:P.current,burstState:me.current[i]?{lastBurstTime:new Date(me.current[i].lastBurstTime).toISOString(),burstCount:me.current[i].burstCount,inCooldown:me.current[i].inCooldown,pendingTransactions:me.current[i].pendingTransactions.length}:null,globalCache:E?{gasParamsAge:E.gasParams?`${Math.round((Date.now()-E.gasParams.timestamp)/1e3)}s ago`:"None",chainParamsAge:E.chainParams?`${Math.round((Date.now()-E.chainParams.timestamp)/1e3)}s ago`:"None",rpcHealthAge:E.rpcHealth?`${Math.round((Date.now()-E.rpcHealth.timestamp)/1e3)}s ago`:"None"}:null};return console.group(`📊 Performance Report - ${j.network} (Chain ${i})`),console.table(j.performance),console.log("🔗 RPC Health:",j.rpcEndpoints),console.log("🎯 Transaction Pool:",j.transactionPool),console.log("⚡ Circuit Breaker:",j.circuitBreaker),console.log("🚀 Burst State:",j.burstState),console.log("💾 Global Cache:",j.globalCache),console.groupEnd(),j},quickStats:i=>{var g;const d=S.current[i],f=v.current[i==null?void 0:i.toString()];if(d&&f){const p=f.currentIndex,E=f.transactions.length-f.currentIndex,j=Math.floor(p/5),G=j*10;console.log(`🎮 ${((g=Ie[i])==null?void 0:g.name)||"Chain "+i}:`),console.log(`  ⚡ Avg Speed: ${Math.round(d.averageBlockchainTime)}ms`),console.log(`  📊 Success Rate: ${d.successRate.toFixed(1)}%`),console.log(`  🎯 Pool Status: ${E}/${f.transactions.length} ready`),console.log(`  ♾️  Infinite Pool: ${p} used, +${G} growth (${j} cycles)`),console.log(`  📈 Next refill: ${5-p%5} transactions`),console.log(`  🚀 Performance: ${d.averageBlockchainTime<1e3?"INSTANT":d.averageBlockchainTime<3e3?"FAST":"SLOW"}`)}else console.log("📊 No performance data available yet")},infinitePoolStats:i=>{const d=v.current[i==null?void 0:i.toString()];if(!d){console.log("❌ No pool found for chain",i);return}const f=d.currentIndex,g=d.transactions.length-d.currentIndex,p=d.transactions.length,E=Math.floor(f/5),j=E*10,G=(Math.floor(f/5)+1)*5,z=G-f;if(console.group(`♾️ Infinite Pool Analysis - Chain ${i}`),console.log("📊 Current Status:"),console.log(`  • Total transactions: ${p}`),console.log(`  • Consumed: ${f}`),console.log(`  • Remaining: ${g}`),console.log(`  • Pool ready: ${d.isReady?"✅":"❌"}`),console.log(`  • Refilling: ${d.isRefilling?"🔄":"⏸️"}`),console.log("🔄 Growth Cycles:"),console.log(`  • Completed cycles: ${E}`),console.log(`  • Net growth: +${j} transactions`),console.log(`  • Growth rate: ${f>0?(j/f*100).toFixed(1):0}%`),console.log("📈 Next Refill:"),console.log(`  • Refill trigger at: ${G} consumed`),console.log(`  • Transactions until refill: ${z}`),console.log("  • Will add: +15 transactions"),console.log("🎯 Pool Efficiency:"),console.log(`  • Efficiency: ${(g/p*100).toFixed(1)}%`),console.log(`  • Trend: ${g>20?"📈 Growing":g>10?"➡️ Stable":"📉 Needs attention"}`),console.log(`  • Is infinite: ${p>50?"✅ Yes":"❌ Not yet"}`),f>0){const $=f+j;console.log("🧮 Mathematical Verification:"),console.log(`  • Theoretical pool size: ${$}`),console.log(`  • Actual pool size: ${p}`),console.log(`  • Difference: ${p-$} (should be positive)`)}console.groupEnd()},forceResetAllCircuitBreakers:()=>{Object.keys(V.current).forEach(i=>{const d=V.current[i];d&&(d.state="CLOSED",d.failures=0,d.lastFailureTime=0,console.log(`✅ Force reset circuit breaker for chain ${i}`))}),console.log("🚀 All circuit breakers reset - ready for gaming!")}},console.log("🔧 Blockchain debug utilities loaded. Use window.blockchainDebug for monitoring."),console.log("📊 Examples:"),console.log("  • window.blockchainDebug.generatePerformanceReport(6342)"),console.log("  • window.blockchainDebug.quickStats(6342)"),console.log("  • window.blockchainDebug.infinitePoolStats(6342) // 🆕 Infinite pool analysis"),console.log("  • window.blockchainDebug.getPerformanceMetrics(6342)"),console.log("  • window.blockchainDebug.forceResetAllCircuitBreakers() // Экстренный сброс"),setTimeout(()=>{Object.keys(V.current).forEach(i=>{const d=V.current[i];d&&d.state==="OPEN"&&(d.state="CLOSED",d.failures=0,console.log(`🔄 Auto-reset circuit breaker for chain ${i} on page load`))})},2e3)),()=>{Se()}),[]),M.useEffect(()=>{e&&t&&n.length===0&&(console.log("🔄 User authenticated but no wallets found, ensuring embedded wallet creation..."),(async()=>{try{await Xe()}catch(d){console.error("Failed to ensure embedded wallet:",d)}})())},[e,t,n.length]),M.useEffect(()=>{e&&t&&n.length>0&&(ne()||(console.log("🔄 User has wallets but no embedded wallet found, retrying creation..."),(async()=>{try{await new Promise(f=>setTimeout(f,2e3)),await Xe()}catch(f){console.error("Failed to retry embedded wallet creation:",f)}})()))},[e,t,n.length]),{isInitializing:r,transactionPending:a,transactionPendingCount:O.current,balance:c,contractNumber:h,initData:tn,sendUpdate:$n,checkBalance:re,callFaucet:Re,getContractNumber:ze,getEmbeddedWallet:ne,ensureEmbeddedWallet:Xe,startBalanceAutoUpdate:Ne,stopBalanceAutoUpdate:Se,isAuthenticated:e,isReady:e&&n.length>0,getPoolStatus:i=>{const d=v.current[i==null?void 0:i.toString()];if(!d)return null;const f=Math.floor(d.currentIndex/5),g=f*10;return{total:d.transactions.length,used:d.currentIndex,remaining:d.transactions.length-d.currentIndex,isReady:d.isReady,isRefilling:d.isRefilling,cyclesCompleted:f,netGrowth:g,isInfinite:d.transactions.length>50,trend:d.transactions.length-d.currentIndex>20?"growing":d.transactions.length-d.currentIndex>10?"stable":"attention"}},getInfinitePoolStats:i=>{const d=v.current[i==null?void 0:i.toString()];if(!d)return null;const f=d.currentIndex,g=d.transactions.length-d.currentIndex,p=d.transactions.length,E=Math.floor(f/5),j=E*10,G=(Math.floor(f/5)+1)*5,z=G-f;return{consumed:f,remaining:g,total:p,cyclesCompleted:E,netGrowth:j,nextRefillAt:G,transactionsToNextRefill:z,isInfinite:p>50,growthRate:f>0?(j/f*100).toFixed(1)+"%":"0%",poolEfficiency:p>0?(g/p*100).toFixed(1)+"%":"0%"}},startPoolMonitoring:le}},Bc=({selectedNetwork:e,className:t=""})=>{const{authenticated:n}=nt(),{wallets:r}=Ht(),{balance:s,getEmbeddedWallet:a,getPoolStatus:o,getInfinitePoolStats:c}=Ks(),[u,h]=M.useState(null),[m,y]=M.useState(null),[w,N]=M.useState(!1);if(M.useEffect(()=>{if(n&&r.length>0){const x=a();x&&y({address:x.address,type:x.walletClientType,isEmbedded:x.walletClientType==="privy"})}},[n,r,a]),M.useEffect(()=>{if(e&&e.id!=="select"){const x=()=>{try{const v=o(e.id),C=c(e.id);h({...v,infiniteStats:C})}catch(v){console.warn("Failed to get pool status:",v)}};x();const P=setInterval(x,1e3);return()=>clearInterval(P)}},[e,o,c]),!n||!m)return null;const b=x=>x?`${x.slice(0,6)}...${x.slice(-4)}`:"",T=x=>x?x.isReady&&x.totalTransactions>10?"text-green-400":x.isReady&&x.totalTransactions>5?"text-yellow-400":x.isReady?"text-orange-400":"text-red-400":"text-gray-400",R=x=>x?x.isReady&&x.totalTransactions>10?"🚀":x.isReady&&x.totalTransactions>5?"⚡":x.isReady?"⚠️":"❌":"⏳";return l.jsxs("div",{className:`privy-wallet-status ${t}`,children:[l.jsxs("div",{className:"status-header",onClick:()=>N(!w),style:{cursor:"pointer"},children:[l.jsxs("div",{className:"wallet-info",children:[l.jsx("span",{className:"wallet-icon",children:"👛"}),l.jsx("span",{className:"wallet-address",children:b(m.address)}),m.isEmbedded&&l.jsx("span",{className:"embedded-badge",children:"Privy"})]}),e&&e.id!=="select"&&u&&l.jsxs("div",{className:"pool-status",children:[l.jsx("span",{className:`status-icon ${T(u)}`,children:R(u)}),l.jsx("span",{className:`pool-count ${T(u)}`,children:u.totalTransactions-u.consumedTransactions})]}),l.jsx("span",{className:`expand-icon ${w?"expanded":""}`,children:"▼"})]}),w&&l.jsxs("div",{className:"status-details",children:[l.jsxs("div",{className:"detail-section",children:[l.jsx("h4",{children:"💰 Wallet Details"}),l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Address:"}),l.jsx("span",{className:"monospace",children:m.address})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Type:"}),l.jsx("span",{children:m.isEmbedded?"Privy Embedded":"External"})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Balance:"}),l.jsxs("span",{children:[s||"0.0000"," ETH"]})]})]}),e&&e.id!=="select"&&u&&l.jsxs("div",{className:"detail-section",children:[l.jsx("h4",{children:"⚡ Pre-signed Pool Status"}),l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Network:"}),l.jsx("span",{children:e.name})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Status:"}),l.jsx("span",{className:T(u),children:u.isReady?"Ready":"Initializing"})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Available:"}),l.jsx("span",{className:T(u),children:u.totalTransactions-u.consumedTransactions})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Total Signed:"}),l.jsx("span",{children:u.totalTransactions})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Used:"}),l.jsx("span",{children:u.consumedTransactions})]}),u.infiniteStats&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Refill Cycles:"}),l.jsx("span",{children:u.infiniteStats.cycles})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Growth Rate:"}),l.jsxs("span",{children:["+",u.infiniteStats.netGrowthPerCycle,"/cycle"]})]})]})]}),e&&e.id!=="select"&&l.jsxs("div",{className:"detail-section",children:[l.jsx("h4",{children:"🎮 Gaming Performance"}),l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Instant Mode:"}),l.jsx("span",{className:"text-green-400",children:u!=null&&u.isReady?"Active":"Preparing"})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Burst Mode:"}),l.jsx("span",{className:"text-blue-400",children:"Enabled"})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("span",{children:"Auto-refill:"}),l.jsx("span",{className:"text-purple-400",children:"Infinite"})]})]})]})]})},Dc=({transactionPending:e,transactionPendingCount:t,balance:n,blockchainStatus:r,selectedNetwork:s,authenticated:a})=>{var x;const[o,c]=M.useState([]),[u,h]=M.useState(1),[m,y]=M.useState(0),[w,N]=M.useState(0);M.useEffect(()=>{if(a&&s&&!s.isWeb2&&r&&(r.totalMovements||0)>0){const v=r.lastTransactionTime||0;if(v>m&&v>0){const C={id:u,type:"transaction",title:"Jump Completed",message:`Jump completed in ${v}ms on ${s.name}`,status:"completed",timestamp:Date.now(),completedAt:Date.now()};c(D=>[...D,C]),h(D=>D+1),y(v)}}},[r==null?void 0:r.totalMovements,r==null?void 0:r.lastTransactionTime,a,s,u,m]),M.useEffect(()=>{if(a&&s&&!s.isWeb2)if(t>w){const P={id:u,type:"transaction",title:"Transaction Pending",message:`Processing jump on ${s.name}`,status:"pending",timestamp:Date.now()};c(v=>[...v,P]),h(v=>v+1),N(t)}else t<w&&N(t)},[t,a,s,u,w]),M.useEffect(()=>{r!=null&&r.lastTransactionTime&&a&&s&&!s.isWeb2&&c(P=>P.map(v=>v.status==="pending"&&v.type==="transaction"?{...v,status:"completed",message:`Jump completed in ${r.lastTransactionTime}ms`,completedAt:Date.now()}:v))},[r==null?void 0:r.lastTransactionTime,a,s]),M.useEffect(()=>{var P;if(r!=null&&r.lastError&&a&&s&&!s.isWeb2&&!o.some(C=>C.type==="error"&&Date.now()-C.timestamp<5e3&&C.message.includes(r.lastError.type))){const C={id:u,type:"error",title:"Transaction Error",message:`${r.lastError.type}: ${(P=r.lastError.message)==null?void 0:P.slice(0,50)}...`,status:"error",timestamp:Date.now()};c(D=>[...D,C]),h(D=>D+1)}},[(x=r==null?void 0:r.lastError)==null?void 0:x.timestamp,a,s,o,u]),M.useEffect(()=>{if(r!=null&&r.averageTransactionTime&&r.averageTransactionTime<1e3&&a&&s&&!s.isWeb2&&!o.some(v=>v.type==="performance"&&Date.now()-v.timestamp<3e4)){const v={id:u,type:"performance",title:"Excellent Performance!",message:`Average speed: ${Math.round(r.averageTransactionTime)}ms - Gaming Mode Active! 🚀`,status:"success",timestamp:Date.now()};c(C=>[...C,v]),h(C=>C+1)}},[r==null?void 0:r.averageTransactionTime,a,s,o,u]),M.useEffect(()=>{if(n&&parseFloat(n)<5e-5&&a&&s&&!s.isWeb2&&!o.some(v=>v.type==="low-balance"&&v.status!=="dismissed")){const v={id:u,type:"low-balance",title:"Low Balance",message:`Balance: ${n} ETH - Get test tokens`,status:"warning",timestamp:Date.now()};c(C=>[...C,v]),h(C=>C+1)}},[n,a,s,o,u]),M.useEffect(()=>{const P=setInterval(()=>{c(v=>{const C=Date.now(),D=v.filter(O=>!(O.status==="completed"&&O.completedAt&&C-O.completedAt>3e3||C-O.timestamp>1e4));return D.length===v.length?v:D})},2e3);return()=>clearInterval(P)},[]);const b=M.useCallback(P=>{c(v=>v.filter(C=>C.id!==P))},[]),T=M.useCallback((P,v)=>P==="transaction"?v==="pending"?"⏳":v==="completed"?"✅":"🔄":P==="low-balance"?"⚠️":P==="error"?"❌":P==="performance"?"🚀":"📢",[]),R=M.useCallback((P,v)=>P==="transaction"?v==="pending"?"pending":v==="completed"?"success":"info":P==="low-balance"?"warning":P==="error"?"error":P==="performance"?"success":"info",[]);return!a||!s||s.isWeb2||o.length===0?null:l.jsx("div",{className:"transaction-notifications",children:o.map(P=>l.jsx("div",{className:`notification ${R(P.type,P.status)}`,children:l.jsxs("div",{className:"notification-content",children:[l.jsxs("div",{className:"notification-header",children:[l.jsx("span",{className:"notification-icon",children:T(P.type,P.status)}),l.jsx("span",{className:"notification-title",children:P.title}),l.jsx("button",{className:"notification-close",onClick:()=>b(P.id),children:"×"})]}),l.jsx("div",{className:"notification-message",children:P.message}),P.type==="transaction"&&P.status==="pending"&&l.jsx("div",{className:"notification-progress",children:l.jsx("div",{className:"progress-bar",children:l.jsx("div",{className:"progress-fill"})})})]})},P.id))})};class Lc{constructor(t,n,r,s,a,o,c=null){ie(this,"WALK_ANIMATION_TIMER",180);ie(this,"walkAnimationTimer",this.WALK_ANIMATION_TIMER);ie(this,"buddyRunImages",[]);ie(this,"jumpPressed",!1);ie(this,"jumpInProgress",!1);ie(this,"falling",!1);ie(this,"JUMP_SPEED",.65);ie(this,"GRAVITY",.38);ie(this,"dustParticles",[]);ie(this,"showDust",!1);ie(this,"dustTimer",0);ie(this,"touchstart",()=>{this.jumpPressed=!0});ie(this,"touchend",()=>{this.jumpPressed=!1});ie(this,"keydown",t=>{t.code==="Space"&&(this.jumpPressed=!0)});ie(this,"keyup",t=>{t.code==="Space"&&(this.jumpPressed=!1)});this.ctx=t,this.canvas=t.canvas,this.width=n,this.height=r,this.minJumpHeight=s,this.maxJumpHeight=a,this.scaleRatio=o,this.onMovementCallback=c,this.x=10*o,this.y=this.canvas.height-this.height,this.yStandingPosition=this.y,this.standingStillImage=new Image,this.standingStillImage.src="assets/buddy_standing_still.png",this.standingStillImage.onerror=()=>console.error("Failed to load buddy_standing_still.png"),this.image=this.standingStillImage,this.jumpingImage=new Image,this.jumpingImage.src="assets/buddy_standing_still_eye_closed.png",this.jumpingImage.onerror=()=>console.error("Failed to load buddy_standing_still_eye_closed.png");const u=new Image;u.src="assets/buddy_run1.png",u.onerror=()=>console.error("Failed to load buddy_run1.png");const h=new Image;h.src="assets/buddy_run2.png",h.onerror=()=>console.error("Failed to load buddy_run2.png"),this.buddyRunImages.push(u),this.buddyRunImages.push(h),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),window.removeEventListener("touchstart",this.touchstart),window.removeEventListener("touchend",this.touchend),window.addEventListener("touchstart",this.touchstart),window.addEventListener("touchend",this.touchend)}update(t,n){this.run(t,n),this.jumpInProgress&&(this.image=this.jumpingImage),this.jump(n),this.updateDust(n)}jump(t){this.jumpPressed&&(this.jumpInProgress||this.onMovementCallback&&this.onMovementCallback(),this.jumpInProgress=!0),this.jumpInProgress&&!this.falling?this.y>this.canvas.height-this.minJumpHeight||this.y>this.canvas.height-this.maxJumpHeight&&this.jumpPressed?this.y-=this.JUMP_SPEED*t*this.scaleRatio:this.falling=!0:this.y<this.yStandingPosition?(this.y+=this.GRAVITY*t*this.scaleRatio,this.y+this.height>this.canvas.height&&(this.y=this.yStandingPosition,this.createDustEffect())):(this.falling=!1,this.jumpInProgress=!1)}createDustEffect(){this.showDust=!0,this.dustTimer=300}updateDust(t){this.showDust&&(this.dustTimer-=t,this.dustTimer<=0&&(this.showDust=!1))}run(t,n){this.walkAnimationTimer<=0&&(this.image===this.buddyRunImages[0]?this.image=this.buddyRunImages[1]:this.image=this.buddyRunImages[0],this.walkAnimationTimer=this.WALK_ANIMATION_TIMER),this.walkAnimationTimer-=n*t}draw(){if(this.image&&this.image.complete&&this.image.naturalWidth>0&&this.ctx.drawImage(this.image,this.x,this.y,this.width,this.height),this.showDust){this.ctx.fillStyle="rgba(139, 69, 19, 0.6)";const t=this.yStandingPosition+this.height;for(let n=0;n<5;n++){const r=this.x+this.width*.2+n*8*this.scaleRatio,s=(3-n*.5)*this.scaleRatio;this.ctx.beginPath(),this.ctx.arc(r,t-s,s,0,Math.PI*2),this.ctx.fill()}}}}class Gc{constructor(t,n,r,s,a){this.ctx=t,this.canvas=t.canvas,this.width=n,this.height=r,this.speed=s,this.scaleRatio=a,this.x=0,this.y=this.canvas.height-this.height,this.groundImage=new Image,this.groundImage.src="assets/ground.png",this.groundImage.onerror=()=>console.error("Failed to load ground.png")}update(t,n){this.x-=t*n*this.speed*this.scaleRatio}draw(){this.ctx.fillStyle="#7BA428",this.ctx.fillRect(0,this.y,this.canvas.width,this.height),this.ctx.fillStyle="#6B9420";for(let t=0;t<this.canvas.width;t+=3)this.ctx.fillRect(t,this.y,1,this.height);this.ctx.fillStyle="#8B4513",this.ctx.fillRect(0,this.y+this.height*.7,this.canvas.width,this.height*.3),this.x<-this.width&&(this.x=0)}reset(){this.x=0}}class Uc{constructor(t,n,r,s,a,o){this.ctx=t,this.x=n,this.y=r,this.width=s,this.height=a,this.image=o}update(t,n,r,s){this.x-=t*n*r*s}draw(){this.image&&this.image.complete&&this.image.naturalWidth>0&&this.ctx.drawImage(this.image,this.x,this.y,this.width,this.height)}collideWith(t){return t.x<this.x+this.width/1.4&&t.x+t.width/1.4>this.x&&t.y<this.y+this.height/1.4&&t.height+t.y/1.4>this.y}}class zc{constructor(t,n,r,s){ie(this,"CARROT_INTERVAL_MIN",500);ie(this,"CARROT_INTERVAL_MAX",2e3);ie(this,"nextCarrotInterval",null);ie(this,"carrots",[]);this.ctx=t,this.canvas=t.canvas,this.carrotImages=n,this.scaleRatio=r,this.speed=s,this.setNextCarrotTime()}setNextCarrotTime(){const t=this.getRandomNumber(this.CARROT_INTERVAL_MIN,this.CARROT_INTERVAL_MAX);this.nextCarrotInterval=t}getRandomNumber(t,n){return Math.floor(Math.random()*(n-t+1)+t)}createCarrot(){const t=this.getRandomNumber(0,this.carrotImages.length-1),n=this.carrotImages[t],r=this.canvas.width*1.5,s=this.canvas.height-n.height,a=new Uc(this.ctx,r,s,n.width,n.height,n.image);this.carrots.push(a)}update(t,n){this.nextCarrotInterval<=0&&(this.createCarrot(),this.setNextCarrotTime()),this.nextCarrotInterval-=n,this.carrots.forEach(r=>{r.update(this.speed,t,n,this.scaleRatio)}),this.carrots=this.carrots.filter(r=>r.x>-r.width)}draw(){this.carrots.forEach(t=>t.draw())}collideWith(t){return this.carrots.some(n=>n.collideWith(t))}reset(){this.carrots=[]}}class Hc{constructor(t,n,r=null){ie(this,"score",0);ie(this,"HIGH_SCORE_KEY","highScore");this.ctx=t,this.canvas=t.canvas,this.scaleRatio=n,this.blockchainStatus=r}update(t){this.score+=t*.01}reset(){this.score=0}setHighScore(){const t=Number(localStorage.getItem(this.HIGH_SCORE_KEY));this.score>t&&localStorage.setItem(this.HIGH_SCORE_KEY,Math.floor(this.score))}draw(){const t=Number(localStorage.getItem(this.HIGH_SCORE_KEY)),n=20*this.scaleRatio,r=20*this.scaleRatio;this.ctx.font=`${r}px serif`,this.ctx.fillStyle="#6B8E6B";const s=this.canvas.width-75*this.scaleRatio,a=s-125*this.scaleRatio,o=Math.floor(this.score).toString().padStart(6,0),c=t.toString().padStart(6,0);if(this.ctx.fillText(o,s,n),this.ctx.fillText(`HI ${c}`,a,n),this.blockchainStatus){const u=n+30*this.scaleRatio,h=12*this.scaleRatio;if(this.ctx.font=`${h}px monospace`,this.ctx.fillStyle=this.blockchainStatus.contractAvailable?"#7FBC7F":"#FFA500",this.ctx.fillText(`⛓️ ${this.blockchainStatus.networkName}`,10*this.scaleRatio,u),this.ctx.fillStyle="#4169E1",this.ctx.fillText(`Moves: ${this.blockchainStatus.totalMovements}`,10*this.scaleRatio,u+20*this.scaleRatio),this.blockchainStatus.pendingTransactions>0&&(this.ctx.fillStyle="#FF6347",this.ctx.fillText(`Pending: ${this.blockchainStatus.pendingTransactions}`,10*this.scaleRatio,u+40*this.scaleRatio)),this.blockchainStatus.poolStatus){const m=this.blockchainStatus.poolStatus,y=Math.floor(m.used/5),w=y*10,N=m.remaining>20?"#32CD32":m.remaining>10?"#7FBC7F":m.remaining>3?"#FFA500":"#FF6347";this.ctx.fillStyle=N;const b=m.total>50?"∞":"";this.ctx.fillText(`Pool: ${m.remaining}/${m.total}${b}`,10*this.scaleRatio,u+40*this.scaleRatio),m.used>0&&(this.ctx.fillStyle="#4169E1",this.ctx.fillText(`Growth: +${w} (${y} cycles)`,10*this.scaleRatio,u+60*this.scaleRatio)),m.isReady?m.isRefilling?(this.ctx.fillStyle="#32CD32",this.ctx.fillText("🔄 Growing pool...",10*this.scaleRatio,u+80*this.scaleRatio)):m.total>50&&(this.ctx.fillStyle="#7FBC7F",this.ctx.fillText("♾️ Infinite mode",10*this.scaleRatio,u+80*this.scaleRatio)):(this.ctx.fillStyle="#FF6347",this.ctx.fillText("⏳ Initializing...",10*this.scaleRatio,u+80*this.scaleRatio))}this.blockchainStatus.onChainScore>0&&(this.ctx.fillStyle="#32CD32",this.ctx.fillText(`On-chain: ${this.blockchainStatus.onChainScore}`,10*this.scaleRatio,u+100*this.scaleRatio))}}}const Wc=({selectedNetwork:e})=>{const t=M.useRef(null),n=M.useRef({}),{user:r,authenticated:s}=nt(),{wallets:a}=Ht();dn();const{isInitializing:o,transactionPending:c,transactionPendingCount:u,balance:h,contractNumber:m,initData:y,sendUpdate:w,checkBalance:N,getContractNumber:b,isReady:T,getEmbeddedWallet:R,ensureEmbeddedWallet:x,callFaucet:P,getPoolStatus:v}=Ks(),[C,D]=M.useState({initialized:!1,networkName:(e==null?void 0:e.name)||"Unknown",contractAvailable:!1,pendingTransactions:0,totalMovements:0,onChainScore:0,poolStatus:null}),[O,S]=M.useState(!1),[Y,q]=M.useState(!1),Q=M.useRef(!1);M.useRef(null);const _=M.useRef(0),ae=M.useRef(0),je=M.useRef({});M.useEffect(()=>{je.current={sendUpdate:w,getContractNumber:b,selectedNetwork:e,blockchainInitialized:C.initialized}},[w,b,e,C.initialized]);const me=1,Ue=1e-5,rt=800,Ve=200,Cn=88/1.5,jn=94/1.5,Zt=Ve,Qt=150,Sn=2400,An=24,yt=.5,en=[{width:48/1.5,height:100/1.5,imageSrc:"assets/carrot_1.png"},{width:98/1.5,height:100/1.5,imageSrc:"assets/carrot_2.png"},{width:68/1.5,height:70/1.5,imageSrc:"assets/carrot_3.png"}],ne=async()=>{if(!T||!e||e.isWeb2){console.log("Skipping blockchain initialization - Web2 mode or not ready"),D(H=>({...H,initialized:!1,networkName:(e==null?void 0:e.name)||"Web2 Mode"}));return}try{console.log("Initializing blockchain for network:",e.name),await y(e.id);const H=await b(e.id);D({initialized:!0,networkName:e.name,contractAvailable:!0,pendingTransactions:0,totalMovements:H,onChainScore:H}),console.log("Blockchain initialization complete")}catch(H){console.error("Failed to initialize blockchain:",H),D(F=>({...F,initialized:!1,contractAvailable:!1}))}},Xe=M.useCallback(async()=>{const{sendUpdate:H,getContractNumber:F,selectedNetwork:se,blockchainInitialized:W}=je.current;if(!se||se.isWeb2||!W){console.log("Skipping on-chain movement - Web2 mode or not initialized");return}if((se==null?void 0:se.chainId)===6342){if(_.current>8){console.log("🚫 Maximum MegaETH transaction throughput reached:",_.current);return}const le=Date.now();ae.current&&le-ae.current>1e4&&(console.log("🔄 Resetting pending count due to timeout, was:",_.current),_.current=0)}else if(Q.current){console.log("🚫 Transaction already pending, blocking jump");return}const st=Date.now();if(ae.current&&st-ae.current<100){console.log("🚫 Transaction rate limit: minimum 100ms between transactions");return}ae.current=st;try{(se==null?void 0:se.chainId)!==6342&&(Q.current=!0),_.current++,S(!0);const le=performance.now();console.log("⚡ Sending instant on-chain jump transaction...");const re=await H(se.id),ue=performance.now()-le,Me=re.blockchainTime||Math.round(ue),Ne={reactionTime:Math.round(ue-Me),blockchainTime:Me,totalTime:Math.round(ue),network:se.name,isInstant:re.isInstant||!1,txHash:re.hash||re.transactionHash,performanceMetrics:re.performanceMetrics};return console.log("🎮 Real-Time Gaming Result:",Ne),console.log(`🎯 Jump completed: ${Ne.blockchainTime}ms blockchain time, ${Ne.isInstant?"INSTANT":"PENDING"} confirmation`),D(Se=>{var Re;return{...Se,totalMovements:Se.totalMovements+1,onChainScore:Se.onChainScore+1,lastTransactionTime:Ne.blockchainTime,averageTransactionTime:((Re=Ne.performanceMetrics)==null?void 0:Re.averageBlockchainTime)||Se.averageTransactionTime,lastError:null}}),setTimeout(async()=>{try{await F(se.id)}catch(Se){console.error("Error updating contract number:",Se)}},1e3),Ne}catch(le){console.error("❌ Error sending on-chain movement:",le);let re="Transaction failed",ue="UNKNOWN";le.message.includes("insufficient funds")?(re="Insufficient funds for transaction. Please check your balance.",ue="INSUFFICIENT_FUNDS"):le.message.includes("nonce")?(re="Transaction nonce error. Please try again.",ue="NONCE_ERROR",console.log("🔄 Nonce error detected, applying recovery cooldown and resetting pending count"),ae.current=Date.now()+1e3,_.current>0&&(console.log(`🔄 Resetting pending count from ${_.current} to 0 due to nonce error`),_.current=0)):le.message.includes("timeout")?(re="Transaction timeout. Please try again.",ue="TIMEOUT"):le.message.includes("rejected")?(re="Transaction was rejected by the network.",ue="REJECTED"):le.message.includes("rate limit")?(re="Rate limit exceeded. Please wait a moment.",ue="RATE_LIMIT"):(re=`Transaction failed: ${le.message}`,ue="BLOCKCHAIN_ERROR"),console.error(`🚨 Blockchain Error [${ue}]:`,re),D(Ne=>({...Ne,lastError:{type:ue,message:re,timestamp:Date.now()}}));const Me=new Error(re);throw Me.type=ue,Me}finally{(se==null?void 0:se.chainId)!==6342&&(Q.current=!1),_.current=Math.max(0,_.current-1),S(!1)}},[]),pe=async()=>{if(!(!e||e.isWeb2||!T))try{q(!0);let H=R();if(!H&&(console.log("No embedded wallet found, attempting to create one..."),H=await x(),!H)){alert("Please connect your wallet first");return}console.log("Manual faucet request for:",H.address),(await P(H.address,e.id)).isEmbeddedWallet?alert("Faucet request successful! Funds will be sent to your game wallet."):alert("Faucet request successful! Funds should arrive shortly."),setTimeout(async()=>{await N(e.id)},3e3)}catch(H){console.error("Manual faucet error:",H),alert(`Faucet request failed: ${H.message}`)}finally{q(!1)}},ye=()=>{if(e&&e.isWeb2)return{identifier:"CLASSIC PLAYER",address:null,isWeb2:!0};if(!s||!r)return null;const H=wt();return H?{identifier:`${H.slice(0,6)}...${H.slice(-4)}`,address:H}:r.email?{identifier:r.email.split("@")[0],address:null}:null},wt=()=>{var H;return!s||!a||a.length===0?null:((H=a[0])==null?void 0:H.address)||null};return M.useEffect(()=>{if(e&&e.isWeb2){console.log("Web2 mode selected, skipping blockchain initialization"),D({initialized:!1,networkName:e.name,contractAvailable:!1,pendingTransactions:0,totalMovements:0,onChainScore:0});return}e&&T&&s&&a.length>0&&(console.log("Initializing blockchain for:",e.name),ne())},[e,T,s,a]),M.useEffect(()=>{if(e&&!e.isWeb2){const H=v(e.id);D(F=>({...F,pendingTransactions:c?1:0,poolStatus:H}))}},[c,e,v]),M.useEffect(()=>{const H=t.current;if(!H)return;const F=H.getContext("2d");let se;F.imageSmoothingEnabled=!1,F.webkitImageSmoothingEnabled=!1,F.mozImageSmoothingEnabled=!1,F.msImageSmoothingEnabled=!1;const W=n.current;Object.assign(W,{scaleRatio:null,previousTime:null,gameSpeed:me,gameOver:!1,hasAddedEventListenersForRestart:!1,waitingToStart:!0});function st(){const V=Cn*W.scaleRatio,te=jn*W.scaleRatio,he=Qt*W.scaleRatio,ge=Zt*W.scaleRatio,i=Sn*W.scaleRatio,d=An*W.scaleRatio;W.player=new Lc(F,V,te,he,ge,W.scaleRatio,e&&!e.isWeb2?Xe:null),W.ground=new Gc(F,i,d,yt,W.scaleRatio);const f=en.map(g=>{const p=new Image;return p.src=g.imageSrc,p.onerror=()=>console.error(`Failed to load ${g.imageSrc}`),{image:p,width:g.width*W.scaleRatio,height:g.height*W.scaleRatio}});W.carrotController=new zc(F,f,W.scaleRatio,yt),W.score=new Hc(F,W.scaleRatio)}function le(){W.scaleRatio=re(),H.width=rt*W.scaleRatio,H.height=Ve*W.scaleRatio,st()}function re(){const V=Math.min(window.innerHeight,document.documentElement.clientHeight),te=Math.min(window.innerWidth,document.documentElement.clientWidth);return te/V<rt/Ve?te/rt:V/Ve}function ue(){const V=Math.floor(W.scaleRatio*32);F.font=`${V}px monospace`,F.fillStyle="#ef5435",F.textAlign="center",F.shadowColor="#ef5435",F.shadowBlur=10,F.fillText("GAME OVER",H.width/2,H.height/2-V),F.shadowBlur=0;const te=Math.floor(W.scaleRatio*16);F.font=`${te}px monospace`,F.fillStyle="#929397",F.fillText("> PRESS ANY KEY TO RESTART",H.width/2,H.height/2+te);const he=ye();if(he){const ge=Math.floor(W.scaleRatio*12);F.font=`${ge}px monospace`,F.fillStyle="#1391ff",F.fillText(`> PILOT: ${he.identifier}`,H.width/2,H.height/2+te+ge+20),F.fillStyle="#929397",F.fillText(`> NETWORK: ${C.networkName}`,H.width/2,H.height/2+te+ge*2+25),C.totalMovements>0&&F.fillText(`> ON-CHAIN MOVES: ${C.totalMovements}`,H.width/2,H.height/2+te+ge*3+30)}}function Me(){const V=Math.floor(W.scaleRatio*24);F.font=`${V}px monospace`,F.fillStyle="#929397",F.textAlign="center",F.shadowColor="#929397",F.shadowBlur=5,F.fillText("> PRESS ANY KEY TO START MISSION",H.width/2,H.height/2),F.shadowBlur=0;const te=ye(),he=Math.floor(W.scaleRatio*12);F.font=`${he}px monospace`,te?(F.fillStyle="#1391ff",F.shadowColor="#1391ff",F.shadowBlur=3,F.fillText(`> PILOT AUTHENTICATED: ${te.identifier}`,H.width/2,H.height/2+V+20),F.shadowBlur=0,F.fillStyle="#929397",F.fillText(`> TARGET NETWORK: ${C.networkName}`,H.width/2,H.height/2+V+he+25),C.initialized?(F.fillStyle="#28a745",F.fillText("> BLOCKCHAIN CONNECTION: ACTIVE",H.width/2,H.height/2+V+he*2+30)):(F.fillStyle="#ffc107",F.fillText("> BLOCKCHAIN CONNECTION: SIMULATED MODE",H.width/2,H.height/2+V+he*2+30))):(F.fillStyle="#ef5435",F.fillText("> WARNING: NO PILOT AUTHENTICATED",H.width/2,H.height/2+V+20))}function Ne(){const V=F.createLinearGradient(0,0,0,H.height);V.addColorStop(0,"#121218"),V.addColorStop(.5,"#1a1a2e"),V.addColorStop(1,"#16213e"),F.fillStyle=V,F.fillRect(0,0,H.width,H.height),F.strokeStyle="rgba(146, 147, 151, 0.1)",F.lineWidth=1;const te=20*W.scaleRatio;for(let i=0;i<H.width;i+=te)F.beginPath(),F.moveTo(i,0),F.lineTo(i,H.height),F.stroke();for(let i=0;i<H.height;i+=te)F.beginPath(),F.moveTo(0,i),F.lineTo(H.width,i),F.stroke();const he=Date.now()/20%H.height;F.strokeStyle="rgba(19, 145, 255, 0.3)",F.lineWidth=2,F.beginPath(),F.moveTo(0,he),F.lineTo(H.width,he),F.stroke();const ge=F.createLinearGradient(0,0,0,H.height*.3);ge.addColorStop(0,"rgba(19, 145, 255, 0.1)"),ge.addColorStop(1,"transparent"),F.fillStyle=ge,F.fillRect(0,0,H.width,H.height*.3)}function Se(){W.hasAddedEventListenersForRestart||(W.hasAddedEventListenersForRestart=!0,setTimeout(()=>{const V=()=>{Re(),document.removeEventListener("keyup",V),document.removeEventListener("touchstart",V)};document.addEventListener("keyup",V),document.addEventListener("touchstart",V)},1e3))}function Re(){W.hasAddedEventListenersForRestart=!1,W.gameOver=!1,W.waitingToStart=!1,W.ground.reset(),W.carrotController.reset(),W.score.reset(),W.gameSpeed=me}function Rn(V){W.gameSpeed+=V*Ue}function $n(){return W.carrotController.collideWith(W.player)}function at(V){if(W.previousTime===null){W.previousTime=V,se=requestAnimationFrame(at);return}const te=V-W.previousTime;W.previousTime=V,Ne(),!W.gameOver&&!W.waitingToStart&&(W.ground.update(W.gameSpeed,te),W.carrotController.update(W.gameSpeed,te),W.player.update(W.gameSpeed,te),W.score.update(te),Rn(te),$n()&&(W.gameOver=!0,Se())),W.ground.draw(),W.carrotController.draw(),W.player.draw(),W.score.draw(),W.gameOver&&ue(),W.waitingToStart&&Me(),se=requestAnimationFrame(at)}le();const tn=()=>setTimeout(le,500);window.addEventListener("resize",tn),screen.orientation&&screen.orientation.addEventListener("change",le);const ze=()=>{Re(),document.removeEventListener("keyup",ze),document.removeEventListener("touchstart",ze)};return document.addEventListener("keyup",ze),document.addEventListener("touchstart",ze),se=requestAnimationFrame(at),()=>{se&&cancelAnimationFrame(se),window.removeEventListener("resize",tn),screen.orientation&&screen.orientation.removeEventListener("change",le),document.removeEventListener("keyup",ze),document.removeEventListener("touchstart",ze)}},[e,Xe]),l.jsxs("div",{className:"game-container",children:[l.jsx("canvas",{ref:t}),s&&e&&!e.isWeb2&&l.jsx(Bc,{selectedNetwork:e,className:"wallet-status-overlay"}),O&&l.jsx("div",{className:"transaction-toast",children:l.jsxs("div",{className:"toast-content",children:[l.jsx("div",{className:"loading-spinner"}),l.jsx("span",{children:"Sending on-chain jump..."})]})}),e&&!e.isWeb2&&l.jsxs("div",{className:"blockchain-status-panel",children:[l.jsxs("div",{className:"status-header",children:[l.jsx("span",{className:"network-name",children:C.networkName}),l.jsx("span",{className:`status-indicator ${C.initialized?"connected":"disconnected"}`,children:C.initialized?"🟢":"🔴"})]}),C.initialized&&l.jsxs("div",{className:"status-details",children:[l.jsxs("div",{className:"status-item",children:[l.jsx("span",{className:"label",children:"Balance:"}),l.jsxs("span",{className:"value",children:[h," ETH"]})]}),l.jsxs("div",{className:"status-item",children:[l.jsx("span",{className:"label",children:"Contract #:"}),l.jsx("span",{className:"value",children:m})]}),l.jsxs("div",{className:"status-item",children:[l.jsx("span",{className:"label",children:"Jumps:"}),l.jsx("span",{className:"value",children:C.totalMovements})]}),C.lastTransactionTime&&l.jsxs("div",{className:"status-item",children:[l.jsx("span",{className:"label",children:"Last TX:"}),l.jsxs("span",{className:"value performance-metric",children:[C.lastTransactionTime,"ms"]})]}),C.averageTransactionTime&&l.jsxs("div",{className:"status-item",children:[l.jsx("span",{className:"label",children:"Avg Speed:"}),l.jsxs("span",{className:"value performance-metric",children:[Math.round(C.averageTransactionTime),"ms"]})]}),C.averageTransactionTime&&l.jsxs("div",{className:"status-item",children:[l.jsx("span",{className:"label",children:"Performance:"}),l.jsx("span",{className:`value performance-indicator ${C.averageTransactionTime<1e3?"excellent":C.averageTransactionTime<3e3?"good":C.averageTransactionTime<5e3?"fair":"slow"}`,children:C.averageTransactionTime<1e3?"🚀 INSTANT":C.averageTransactionTime<3e3?"⚡ FAST":C.averageTransactionTime<5e3?"🔥 GOOD":"🐌 SLOW"})]}),C.lastError&&l.jsxs("div",{className:"status-item error",children:[l.jsx("span",{className:"label",children:"Last Error:"}),l.jsx("span",{className:"value error-text",title:C.lastError.message,children:C.lastError.type})]}),parseFloat(h)<5e-5&&l.jsx("div",{className:"status-item",children:l.jsx("button",{className:"faucet-button",onClick:pe,disabled:Y,children:Y?"Requesting...":"Get Test ETH"})}),c&&l.jsxs("div",{className:"status-item",children:[l.jsx("span",{className:"label",children:"Status:"}),l.jsx("span",{className:"value pending",children:"⚡ Processing TX..."})]})]}),o&&l.jsxs("div",{className:"initialization-status",children:[l.jsx("div",{className:"loading-spinner"}),l.jsx("span",{children:"🚀 Initializing blockchain..."})]})]}),l.jsx(Dc,{transactionPending:c,transactionPendingCount:u,balance:h,blockchainStatus:C,selectedNetwork:e,authenticated:s})]})},_c=({selectedNetwork:e,onDisconnect:t,disableNetworkControls:n=!1})=>{var O;const{user:r,authenticated:s,ready:a}=nt(),{login:o}=dn(),{logout:c}=Xs(),{wallets:u}=Ht(),[h,m]=M.useState(!1),[y,w]=M.useState(!1),N=[{id:6342,name:"MegaETH Testnet",emoji:"⚡"},{id:84532,name:"Base Sepolia",emoji:"🔵"},{id:10143,name:"Monad Testnet",emoji:"🟣"}];M.useEffect(()=>{(async()=>{var Y;if(s&&u&&u.length>0&&e&&!y)try{const q=u[0];if(q.walletClientType==="privy"){console.log(`Auto-switching to ${e.name}...`),console.log("⚡ INSTANT GAMING MODE ENABLED - игра готова!");return}let _;try{if(typeof q.getChainId=="function")_=await q.getChainId();else if(q.chainId)_=q.chainId;else{const ae=await((Y=q.getEthereumProvider)==null?void 0:Y.call(q));if(ae&&ae.request){const je=await ae.request({method:"eth_chainId"});_=parseInt(je,16)}else{console.warn("Cannot determine current chain ID, skipping auto-switch");return}}}catch(ae){console.warn("Failed to get current chain ID:",ae);return}_!==e.id&&(console.log(`Auto-switching to ${e.name}...`),w(!0),await T(e.id))}catch(q){console.warn("Auto network switch failed:",q)}finally{w(!1)}})()},[s,u,e]);const b=()=>{s?(c(),t&&t()):o()},T=async S=>{var Y,q;if(!(!u||u.length===0)){w(!0);try{const Q=u[0],_=((Y=N.find(je=>je.id===S))==null?void 0:Y.name)||"Unknown Network";if(Q.walletClientType==="privy"){console.log("⚡ INSTANT GAMING MODE ENABLED - игра готова!"),m(!1);return}if(typeof Q.switchChain!="function"){console.warn("Wallet does not support network switching"),alert("This wallet does not support automatic network switching. Please switch manually.");return}try{await Q.switchChain(S),m(!1),console.log(`Successfully switched to ${_}`);return}catch(je){console.log(`Network ${_} not found, attempting to add it...`,je);const me=R(S);if(me)await x(Q,me),await new Promise(Ue=>setTimeout(Ue,1e3)),console.log(`Switching to ${_}...`),await Q.switchChain(S),m(!1),console.log(`Successfully added and switched to ${_}`);else throw new Error(`Network configuration not found for chain ID ${S}`)}}catch(Q){if(console.error("Failed to switch network:",Q),((q=u[0])==null?void 0:q.walletClientType)==="privy"&&Q.message.includes("Unsupported chainId")){m(!1);return}let ae="Failed to switch network. ";Q.message.includes("rejected")?ae+="User cancelled the operation.":Q.message.includes("already pending")?ae+="Another network operation is in progress. Please wait and try again.":ae+="Please try again or add the network manually.",alert(ae)}finally{w(!1)}}},R=S=>({6342:{chainId:"0x18C6",chainName:"MegaETH Testnet",rpcUrls:["https://carrot.megaeth.com/rpc"],nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockExplorerUrls:["https://carrot.megaeth.com"]},84532:{chainId:"0x14A34",chainName:"Base Sepolia",rpcUrls:["https://sepolia.base.org"],nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockExplorerUrls:["https://sepolia.basescan.org"]},10143:{chainId:"0x279F",chainName:"Monad Testnet",rpcUrls:["https://testnet-rpc.monad.xyz"],nativeCurrency:{name:"Monad",symbol:"MON",decimals:18},blockExplorerUrls:["https://testnet.monadexplorer.com"]}})[S],x=async(S,Y)=>{try{await(await S.getEthersProvider()).send("wallet_addEthereumChain",[Y])}catch(q){if(q.code===4902||q.message.includes("already exists")||q.message.includes("Already added")){console.log("Network already exists in wallet");return}throw q}},P=()=>{if(!u||u.length===0)return null;const S=u[0];return N.find(Y=>Y.id===S.chainId)},v=S=>S?`${S.slice(0,6)}...${S.slice(-4)}`:"",C=()=>{var S;if((S=r==null?void 0:r.wallet)!=null&&S.address)return r.wallet.address;if(r!=null&&r.linkedAccounts){const Y=r.linkedAccounts.find(q=>q.type==="wallet");return Y==null?void 0:Y.address}return null},D=()=>{var Y,q;if((Y=r==null?void 0:r.email)!=null&&Y.address)return r.email.address;if((q=r==null?void 0:r.phone)!=null&&q.number)return r.phone.number;const S=C();return S?v(S):"Unknown User"};return a?l.jsxs("div",{className:"wallet-container",children:[l.jsxs("div",{className:"wallet-controls",children:[l.jsx("button",{className:`wallet-button ${s?"connected":""}`,onClick:b,children:s?"Disconnect":"Connect Wallet"}),s&&u&&u.length>0&&!n&&l.jsxs("div",{className:"network-selector",children:[l.jsx("button",{className:"network-button",onClick:()=>m(!h),disabled:y,children:y?"🔄 Switching...":P()?`${P().emoji} ${P().name}`:"🌐 Select Network"}),h&&l.jsx("div",{className:"network-dropdown",children:N.map(S=>{var Y;return l.jsxs("button",{className:`network-option ${((Y=P())==null?void 0:Y.id)===S.id?"active":""} ${(e==null?void 0:e.id)===S.id?"selected-game-network":""}`,onClick:()=>T(S.id),disabled:y,children:[y?"🔄":S.emoji," ",S.name,(e==null?void 0:e.id)===S.id&&" 🎮"]},S.id)})})]})]}),s&&l.jsxs("div",{className:"wallet-info",children:[l.jsx("div",{className:"wallet-status",children:"Connected"}),l.jsx("div",{className:"wallet-user",children:D()}),l.jsx("div",{className:"wallet-network",children:e?e.name:((O=P())==null?void 0:O.name)||"Unknown Network"})]})]}):l.jsx("div",{className:"wallet-container",children:l.jsx("button",{className:"wallet-button",disabled:!0,children:"Loading..."})})},qc=({onNetworkSelect:e,onStartGame:t})=>{const[n,r]=M.useState(null),[s,a]=M.useState(!0),[o,c]=M.useState(""),[u,h]=M.useState({width:window.innerWidth,height:window.innerHeight});nt(),dn();const m=[{id:"web2",name:"CLASSIC BROWSER",emoji:"🌐",description:"Pure web2 experience",tech:"No wallet required",color:"#2ecc71",status:"ONLINE",icon:"🦕",isWeb2:!0},{id:6342,name:"MEGAETH TESTNET",emoji:"⚡",description:"Ultra-fast execution layer",tech:"Lightning-fast transactions",color:"#ff6b6b",status:"ONLINE",icon:"🚀"},{id:84532,name:"BASE SEPOLIA",emoji:"🔵",description:"Ethereum L2 testnet",tech:"Reliable scaling solution",color:"#4ecdc4",status:"ONLINE",icon:"🌐"},{id:10143,name:"MONAD TESTNET",emoji:"🟣",description:"Next-gen blockchain",tech:"Advanced consensus",color:"#9b59b6",status:"BETA",icon:"🔮"}];M.useEffect(()=>{const x=["INITIALIZING NETWORK SCANNER...","DETECTING AVAILABLE CHAINS...","ESTABLISHING SECURE CONNECTIONS...","SYSTEM READY FOR NETWORK SELECTION"];let P=0;const v=setInterval(()=>{c(x[P]),P++,P>=x.length&&(clearInterval(v),setTimeout(()=>a(!1),500))},800);return()=>clearInterval(v)},[]),M.useEffect(()=>{const x=()=>{h({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]),M.useEffect(()=>{},[u]);const y=()=>{const{width:x,height:P}=u,v=x<=768,C=x>768&&x<=1024,D=x>1024,O=x>1600;let S;v?S=Math.min(x*.98,x-20):C?S=Math.min(x*.92,x-60):O?S=Math.min(x*.85,1400):S=Math.min(x*.88,1200);const Y=P*(v?.95:.9),q=Math.min(P*(v?.7:.6),v?500:600),Q=v?Math.max(15,x*.03):Math.max(20,x*.025);return{containerStyle:{width:`${S}px`,maxHeight:`${Y}px`,minHeight:`${q}px`,transition:"all 0.3s ease"},contentStyle:{padding:`${Q}px`,transition:"all 0.3s ease"},networkGridStyle:{gridTemplateColumns:v?"1fr":C?"repeat(auto-fit, minmax(280px, 1fr))":"repeat(auto-fit, minmax(300px, 1fr))",gap:`${v?15:D?25:20}px`}}},{containerStyle:w,contentStyle:N,networkGridStyle:b}=y(),T=x=>{r(x),e(x)},R=()=>{if(console.log("handleStartGame called with network:",n),n){if(n.isWeb2){console.log("Starting Web2 game mode"),t(n);return}console.log("Starting blockchain game mode"),t(n)}};return s?l.jsx("div",{className:"network-scanner-overlay",children:l.jsx("div",{className:"scanner-container",style:w,children:l.jsxs("div",{className:"scanner-content",style:N,children:[l.jsxs("div",{className:"terminal-header",children:[l.jsx("div",{className:"terminal-title",children:"NETWORK SCANNER PROTOCOL"}),l.jsxs("div",{className:"terminal-buttons",children:[l.jsx("div",{className:"terminal-button red"}),l.jsx("div",{className:"terminal-button yellow"}),l.jsx("div",{className:"terminal-button green"})]})]}),l.jsx("div",{className:"logo-section",children:l.jsx("div",{className:"pixel-logo",children:l.jsxs("div",{className:"logo-text",children:[l.jsx("span",{className:"logo-main",children:"BUDDY"}),l.jsx("span",{className:"logo-accent",children:"RUNNER"})]})})}),l.jsx("div",{className:"scanner-display",children:l.jsxs("div",{className:"radar-container",children:[l.jsx("div",{className:"radar-sweep"}),l.jsx("div",{className:"radar-grid"})]})}),l.jsxs("div",{className:"scanner-text",children:[l.jsx("span",{className:"terminal-prompt",children:">"})," ",o]})]})})}):l.jsx("div",{className:"network-selection-overlay",children:l.jsx("div",{className:"network-selection-container",style:w,children:l.jsxs("div",{className:"network-selection-content",style:N,children:[l.jsxs("div",{className:"terminal-header",children:[l.jsx("div",{className:"terminal-title",children:"BLOCKCHAIN NETWORK SELECTOR"}),l.jsxs("div",{className:"terminal-buttons",children:[l.jsx("div",{className:"terminal-button red"}),l.jsx("div",{className:"terminal-button yellow"}),l.jsx("div",{className:"terminal-button green"})]})]}),l.jsx("div",{className:"logo-section",children:l.jsxs("div",{className:"pixel-logo",children:[l.jsxs("div",{className:"logo-text",children:[l.jsx("span",{className:"logo-main",children:"BUDDY"}),l.jsx("span",{className:"logo-accent",children:"RUNNER"})]}),l.jsxs("div",{className:"logo-powered",children:["POWERED BY ",l.jsx("strong",{children:"MEGA BUDDIES"})]})]})}),l.jsxs("div",{className:"mission-briefing",children:[l.jsx("div",{className:"briefing-title",children:"MISSION BRIEFING"}),l.jsxs("div",{className:"briefing-content",children:[l.jsxs("div",{className:"terminal-text",children:[l.jsx("span",{className:"terminal-prompt",children:">"})," OBJECTIVE: SURVIVE 60 SECONDS ON EACH NETWORK"]}),l.jsxs("div",{className:"terminal-text",children:[l.jsx("span",{className:"terminal-prompt",children:">"})," ANALYZE BLOCK TIME IMPACT ON USER EXPERIENCE"]}),l.jsxs("div",{className:"terminal-text",children:[l.jsx("span",{className:"terminal-prompt",children:">"})," DISCOVER THE POWER OF REAL-TIME BLOCKCHAIN"]})]})]}),l.jsxs("div",{className:"network-selection",children:[l.jsx("div",{className:"selection-title",children:"SELECT TARGET BLOCKCHAIN NETWORK:"}),l.jsx("div",{className:"network-grid",style:b,children:m.map(x=>l.jsxs("div",{className:`network-card ${(n==null?void 0:n.id)===x.id?"selected":""}`,onClick:()=>T(x),children:[l.jsxs("div",{className:"network-header",children:[l.jsx("div",{className:"network-icon",children:x.icon}),l.jsx("div",{className:"network-status","data-status":x.status,children:x.status})]}),l.jsxs("div",{className:"network-info",children:[l.jsx("div",{className:"network-name",children:x.name}),l.jsx("div",{className:"network-description",children:x.description}),l.jsx("div",{className:"network-tech",children:x.tech})]}),l.jsxs("div",{className:"network-specs",children:[l.jsxs("div",{className:"spec-item",children:[l.jsx("span",{className:"spec-label",children:x.isWeb2?"TYPE:":"CHAIN ID:"}),l.jsx("span",{className:"spec-value",children:x.isWeb2?"WEB2":x.id})]}),l.jsxs("div",{className:"spec-item",children:[l.jsx("span",{className:"spec-label",children:"NETWORK:"}),l.jsx("span",{className:"spec-value",children:x.isWeb2?"BROWSER":"TESTNET"})]})]}),l.jsx("div",{className:"selection-indicator",children:(n==null?void 0:n.id)===x.id&&l.jsx("div",{className:"selected-glow",children:"SELECTED"})})]},x.id))}),n&&l.jsxs("div",{className:"launch-section",children:[l.jsxs("div",{className:"launch-info",children:[l.jsxs("div",{className:"terminal-text",children:[l.jsx("span",{className:"terminal-prompt",children:">"})," TARGET NETWORK: ",n.name]}),l.jsxs("div",{className:"terminal-text",children:[l.jsx("span",{className:"terminal-prompt",children:">"})," MISSION STATUS: READY FOR DEPLOYMENT"]})]}),l.jsxs("button",{className:"launch-button",onClick:R,children:[l.jsx("span",{className:"button-icon",children:"🚀"}),"LAUNCH MISSION ON ",n.name,l.jsx("div",{className:"button-glow"})]})]})]})]})})})},Kc=({onWalletConnected:e})=>{const{user:t,authenticated:n,ready:r}=nt(),{login:s}=dn(),[a,o]=M.useState("INITIALIZING"),[c,u]=M.useState("");M.useEffect(()=>{n&&t&&e()},[n,t,e]),M.useEffect(()=>{const m=setInterval(()=>{u(w=>w.length>=3?"":w+".")},500),y=setInterval(()=>{const w=["INITIALIZING","LOADING SYSTEMS","CONNECTING","SYNCING"];o(w[Math.floor(Math.random()*w.length)])},2e3);return()=>{clearInterval(m),clearInterval(y)}},[]);const h=()=>{s()};return r?l.jsx("div",{className:"wallet-connection-overlay",children:l.jsx("div",{className:"wallet-connection-container",children:l.jsxs("div",{className:"wallet-connection-content",children:[l.jsxs("div",{className:"terminal-header",children:[l.jsx("div",{className:"terminal-title",children:"WALLET CONNECTION PROTOCOL"}),l.jsxs("div",{className:"terminal-buttons",children:[l.jsx("div",{className:"terminal-button red"}),l.jsx("div",{className:"terminal-button yellow"}),l.jsx("div",{className:"terminal-button green"})]})]}),l.jsx("div",{className:"logo-section",children:l.jsxs("div",{className:"pixel-logo",children:[l.jsxs("div",{className:"logo-text",children:[l.jsx("span",{className:"logo-main",children:"BUDDY"}),l.jsx("span",{className:"logo-accent",children:"RUNNER"})]}),l.jsxs("div",{className:"logo-powered",children:["POWERED BY ",l.jsx("strong",{children:"MEGA BUDDIES"})]})]})}),l.jsxs("div",{className:"connection-section",children:[l.jsx("div",{className:"connection-icon",children:"🔗"}),l.jsx("h2",{className:"connection-title",children:"AUTHENTICATION REQUIRED"}),l.jsxs("div",{className:"terminal-content",children:[l.jsxs("div",{className:"terminal-text",children:[l.jsx("span",{className:"terminal-prompt",children:">"})," CONNECT YOUR WALLET TO ACCESS THE GAME"]}),l.jsxs("div",{className:"terminal-text",children:[l.jsx("span",{className:"terminal-prompt",children:">"})," ALL SCORES WILL BE STORED ON-CHAIN"]}),l.jsxs("div",{className:"terminal-text",children:[l.jsx("span",{className:"terminal-prompt",children:">"})," SECURE BLOCKCHAIN AUTHENTICATION"]})]}),l.jsxs("button",{className:"connect-wallet-button",onClick:h,children:[l.jsx("span",{className:"button-icon",children:"🔐"}),"CONNECT WALLET",l.jsx("div",{className:"button-glow"})]}),l.jsxs("div",{className:"supported-options",children:[l.jsx("div",{className:"options-title",children:"SUPPORTED AUTHENTICATION METHODS:"}),l.jsxs("div",{className:"options-grid",children:[l.jsxs("div",{className:"option-item",children:[l.jsx("span",{className:"option-icon",children:"📧"}),l.jsx("span",{className:"option-text",children:"EMAIL"})]}),l.jsxs("div",{className:"option-item",children:[l.jsx("span",{className:"option-icon",children:"📱"}),l.jsx("span",{className:"option-text",children:"PHONE"})]}),l.jsxs("div",{className:"option-item",children:[l.jsx("span",{className:"option-icon",children:"🦊"}),l.jsx("span",{className:"option-text",children:"METAMASK"})]}),l.jsxs("div",{className:"option-item",children:[l.jsx("span",{className:"option-icon",children:"💼"}),l.jsx("span",{className:"option-text",children:"OTHER WALLETS"})]})]})]}),l.jsxs("div",{className:"security-info",children:[l.jsxs("div",{className:"terminal-text",children:[l.jsx("span",{className:"terminal-prompt",children:">"})," SECURITY: 256-BIT ENCRYPTION"]}),l.jsxs("div",{className:"terminal-text",children:[l.jsx("span",{className:"terminal-prompt",children:">"})," NETWORK: MEGAETH COMPATIBLE"]})]})]})]})})}):l.jsx("div",{className:"preloader-overlay",children:l.jsx("div",{className:"preloader-container",children:l.jsxs("div",{className:"preloader-content",children:[l.jsxs("div",{className:"terminal-header",children:[l.jsx("div",{className:"terminal-title",children:"BUDDY RUNNER SYSTEM"}),l.jsxs("div",{className:"terminal-buttons",children:[l.jsx("div",{className:"terminal-button red"}),l.jsx("div",{className:"terminal-button yellow"}),l.jsx("div",{className:"terminal-button green"})]})]}),l.jsx("div",{className:"logo-section",children:l.jsx("div",{className:"pixel-logo",children:l.jsxs("div",{className:"logo-text",children:[l.jsx("span",{className:"logo-main",children:"BUDDY"}),l.jsx("span",{className:"logo-accent",children:"RUNNER"})]})})}),l.jsx("div",{className:"loading-bar",children:l.jsx("div",{className:"progress",style:{width:"100%"}})}),l.jsxs("div",{className:"loading-text",children:[a,l.jsx("span",{className:"dots",children:c})]}),l.jsxs("div",{className:"terminal-text",children:[l.jsx("span",{className:"terminal-prompt",children:">"})," System initialization in progress..."]})]})})})},Jc=()=>{var N;const{user:e,authenticated:t,ready:n}=nt(),{wallets:r}=Ht(),{createWallet:s,isCreatingWallet:a,error:o}=Zs(),[c,u]=M.useState({}),[h,m]=M.useState(!1);M.useEffect(()=>{const b={ready:n,authenticated:t,userExists:!!e,userId:e==null?void 0:e.id,walletsCount:r.length,walletTypes:r.map(T=>({type:T.walletClientType,connectorType:T.connectorType,address:T.address})),hasEmbeddedWallet:r.some(T=>T.walletClientType==="privy"),createWalletError:(o==null?void 0:o.message)||null,isCreatingWallet:a};u(b),console.log("Privy Debug Info:",b)},[n,t,e,r,o,a]);const y=async()=>{m(!0);try{console.log("Manually creating embedded wallet...");const b=await s();console.log("Wallet created successfully:",b),setTimeout(()=>{console.log("Checking wallet registration...");const T=r.find(R=>R.walletClientType==="privy");T?console.log("✅ Embedded wallet properly registered:",T.address):console.log("⚠️ Embedded wallet not found in wallets list")},2e3)}catch(b){console.error("Error creating wallet:",b)}finally{m(!1)}},w=r.find(b=>b.walletClientType==="privy");return l.jsxs("div",{style:{position:"fixed",bottom:20,right:20,background:"rgba(0, 0, 0, 0.9)",color:"white",padding:"20px",borderRadius:"8px",fontSize:"12px",maxWidth:"400px",zIndex:1e4,fontFamily:"monospace"},children:[l.jsx("h3",{style:{margin:"0 0 10px 0"},children:"🔍 Privy Debug Info"}),l.jsxs("div",{style:{marginBottom:"10px"},children:[l.jsx("strong",{children:"Status:"}),l.jsxs("ul",{style:{margin:"5px 0",paddingLeft:"20px"},children:[l.jsxs("li",{children:["Ready: ",c.ready?"✅":"❌"]}),l.jsxs("li",{children:["Authenticated: ",c.authenticated?"✅":"❌"]}),l.jsxs("li",{children:["User ID: ",c.userId||"N/A"]})]})]}),l.jsxs("div",{style:{marginBottom:"10px"},children:[l.jsxs("strong",{children:["Wallets (",c.walletsCount||0,"):"]}),(N=c.walletTypes)==null?void 0:N.map((b,T)=>l.jsxs("div",{style:{marginLeft:"10px",marginTop:"5px"},children:["• ",b.type," (",b.connectorType,")",l.jsx("br",{}),"  ",b.address.slice(0,6),"...",b.address.slice(-4)]},T))]}),l.jsxs("div",{style:{marginBottom:"10px"},children:[l.jsx("strong",{children:"Embedded Wallet:"})," ",c.hasEmbeddedWallet?"✅ Exists":"❌ Not Found",!c.hasEmbeddedWallet&&t&&l.jsx("div",{style:{marginTop:"5px",fontSize:"10px",color:"#ffa500"},children:"⚠️ User authenticated but no embedded wallet found"}),c.hasEmbeddedWallet&&l.jsx("div",{style:{marginTop:"5px",fontSize:"10px",color:"#28a745"},children:"✅ Embedded wallet ready for gaming"})]}),o&&l.jsxs("div",{style:{marginBottom:"10px",color:"#ff6b6b"},children:[l.jsx("strong",{children:"Error:"})," ",o]}),t&&!w&&l.jsxs("div",{style:{marginTop:"10px"},children:[l.jsx("button",{onClick:y,disabled:a||h,style:{background:"#007bff",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:a||h?"not-allowed":"pointer",opacity:a||h?.5:1,marginBottom:"5px",width:"100%"},children:a||h?"Creating...":"Create Embedded Wallet (Privy)"}),l.jsx("button",{onClick:async()=>{var b;try{console.log("Using ensureEmbeddedWallet function...");const T=await((b=window.gameEnsureEmbeddedWallet)==null?void 0:b.call(window));T?console.log("✅ Embedded wallet ensured:",T.address):console.log("❌ Failed to ensure embedded wallet")}catch(T){console.error("Error ensuring embedded wallet:",T)}},style:{background:"#28a745",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",width:"100%"},children:"Ensure Embedded Wallet (Custom)"})]}),l.jsxs("div",{style:{marginTop:"10px",fontSize:"10px",opacity:.7},children:["App ID: cme84q0og02aalc0bh9blzwa9 (hardcoded)",l.jsx("br",{}),"Env: ","Not set",l.jsx("br",{}),l.jsx("button",{onClick:()=>{var b;console.log("=== WALLET DEBUG INFO ==="),console.log("Wallets:",r),console.log("User:",e),console.log("Authenticated:",t),console.log("Ready:",n),console.log("Embedded wallet check:",(b=window.gameGetEmbeddedWallet)==null?void 0:b.call(window)),console.log("=======================")},style:{background:"transparent",color:"#ccc",border:"1px solid #ccc",padding:"4px 8px",borderRadius:"2px",cursor:"pointer",fontSize:"10px",marginTop:"5px"},children:"Debug Wallets"})]})]})};var Yc={};const Vc=()=>{const e="cme84q0og02aalc0bh9blzwa9";console.log("Privy App ID:",e);const[t,n]=M.useState("network-selection"),[r,s]=M.useState(null),a={id:6342,name:"MegaETH Testnet",network:"megaeth-testnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://carrot.megaeth.com/rpc"],webSocket:["wss://carrot.megaeth.com/ws"]}},blockExplorers:{default:{name:"MegaETH Explorer",url:"https://carrot.megaeth.com"}}},h={config:{appearance:{theme:"dark",accentColor:"#1391ff",logo:"https://images.unsplash.com/photo-1614680376573-df3480f0c6ff?w=100&h=100&fit=crop&crop=center",walletChainType:"ethereum-and-solana",showWalletLoginFirst:!1,showWalletUiOnNotConnected:!1,showWalletUi:!1},embeddedWallets:{createOnLogin:"all-users",requireUserPasswordOnCreate:!1,noPromptOnSignature:!0,showWalletUiOnNotConnected:!1,showWalletUi:!1,prependWithWalletUi:!1},loginMethods:["email","wallet","google","discord","twitter"],externalWallets:{coinbaseWallet:{connectionOptions:"all"}},defaultChain:a,supportedChains:[a,{id:31337,name:"Foundry Local",network:"foundry",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["http://127.0.0.1:8545"]}}},{id:50311,name:"Somnia Testnet",network:"somnia-testnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://testnet.somnia.network"]}}},{id:1313161556,name:"RISE Testnet",network:"rise-testnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://testnet-rpc.rise.com"]}}},{id:84532,name:"Base Sepolia",network:"base-sepolia",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.base.org"]}},blockExplorers:{default:{name:"Base Sepolia Explorer",url:"https://sepolia.basescan.org"}}},{id:10143,name:"Monad Testnet",network:"monad-testnet",nativeCurrency:{name:"Monad",symbol:"MON",decimals:18},rpcUrls:{default:{http:["https://testnet-rpc.monad.xyz"]}},blockExplorers:{default:{name:"Monad Explorer",url:"https://testnet.monadexplorer.com"}}},{id:1,name:"Ethereum",network:"homestead",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://eth-mainnet.g.alchemy.com/v2/your-api-key"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io"}}},{id:11155111,name:"Sepolia",network:"sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.infura.io/v3/your-api-key"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.etherscan.io"}}}],walletConnectCloudProjectId:Yc.REACT_APP_WALLETCONNECT_PROJECT_ID||"default",legal:{termsAndConditionsUrl:"/terms",privacyPolicyUrl:"/privacy"},mfa:{noPromptOnMfaRequired:!1}}},m=T=>{s(T)},y=T=>{console.log("App handleStartGame called with network:",T),s(T),T.isWeb2?(console.log("Setting game state to game"),n("game")):(console.log("Setting game state to wallet-connection"),n("wallet-connection"))},w=()=>{n("game")},N=()=>{n("network-selection"),s(null)},b=()=>{n("network-selection"),s(null)};return l.jsxs(Qs,{appId:e,config:h.config,children:[l.jsx("div",{className:"app",children:t==="network-selection"?l.jsx(qc,{onNetworkSelect:m,onStartGame:y}):t==="wallet-connection"?l.jsxs("div",{children:[l.jsx("div",{className:"back-to-wallet",children:l.jsx("button",{className:"back-button-small",onClick:N,children:"← Back to Network Selection"})}),l.jsx(Kc,{onWalletConnected:w})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"back-to-network-button",children:l.jsx("button",{className:"back-button",onClick:N,children:"← Back to Network Selection"})}),r&&!r.isWeb2&&l.jsx(_c,{selectedNetwork:r,onDisconnect:b,disableNetworkControls:!0}),l.jsx("div",{className:"game-layout",children:l.jsx("div",{className:"game-header",children:l.jsx("div",{className:"header-center",children:l.jsxs("div",{className:"title",children:["Buddy Runner",r&&r.isWeb2&&l.jsx("span",{className:"web2-mode",children:" - Classic Mode"})]})})})}),l.jsx(Wc,{selectedNetwork:r}),l.jsxs("div",{className:"instructions",children:[l.jsx("p",{className:"main-instruction",children:"📱 Press SPACE or tap to make Buddy jump!"}),l.jsx("p",{className:"help-text",children:"Help our brave bunny Buddy hop over the giant carrots and achieve the highest score!"}),l.jsx("p",{className:"warning-text",children:"Watch out for those sneaky garden carrots!"})]})]})}),l.jsx(Jc,{})]})};Dn.createRoot(document.getElementById("root")).render(l.jsx(ta.StrictMode,{children:l.jsx(Vc,{})}));export{I as B,Et as H,Nt as I,Le as a,Oe as b,Tn as c,Ro as d,Wt as e,hn as g,_e as i,ve as s};
